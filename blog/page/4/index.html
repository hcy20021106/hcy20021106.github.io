<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hechenyi.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://hechenyi.github.io/blog/page/4/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://hechenyi.github.io/blog/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hechenyi.github.io/2025/04/24/MATLAB%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/24/MATLAB%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" class="post-title-link" itemprop="url">MATLABåŸºç¡€è¯­æ³•</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-24 14:50:46" itemprop="dateCreated datePublished" datetime="2025-04-24T14:50:46+08:00">2025-04-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-05 20:15:57" itemprop="dateModified" datetime="2025-08-05T20:15:57+08:00">2025-08-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MATLAB/" itemprop="url" rel="index"><span itemprop="name">MATLAB</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
          <h2 id="å‘é‡å¤„ç†"><a href="#å‘é‡å¤„ç†" class="headerlink" title="å‘é‡å¤„ç†"></a>å‘é‡å¤„ç†</h2><p>a &#x3D; [1:3:100]<br>å…¶ä¸­aæ˜¯åˆå§‹å€¼ï¼Œbæ˜¯æ­¥é•¿ï¼Œcæ˜¯ç»ˆç‚¹å€¼<br>è¿”å›ç»“æœæ˜¯[1,4,7,â€¦,100]<br>b(a) &#x3D; []<br>æŠŠå‘é‡bä¸­çš„aå¯¹åº”ç´¢å¼•ç»™åˆ æ‰</p>
<h2 id="åˆ—å‘é‡å’Œæ¨ªå‘é‡"><a href="#åˆ—å‘é‡å’Œæ¨ªå‘é‡" class="headerlink" title="åˆ—å‘é‡å’Œæ¨ªå‘é‡"></a>åˆ—å‘é‡å’Œæ¨ªå‘é‡</h2><p>åˆ—å‘é‡ä½¿ç”¨;<br>a &#x3D; [1;2;3]<br>b &#x3D; [4;5;6]<br>c &#x3D; [a;b]<br>å…¶ä¸­cå°†ä¸¤ä¸ªåˆ—å‘é‡è¿›è¡Œæ‹¼æ¥<br>æ¨ªå‘é‡ä½¿ç”¨é€—å·ï¼Œå…¶ä»–åŒç†<br>å¦‚æœæƒ³ä½¿ç”¨a&#x3D;(1:100)ç±»ä¼¼è¯­æ³•æ„å»ºåˆ—å‘é‡ï¼Œå¯ä»¥å…ˆæ„å»ºæ¨ªå‘é‡ï¼Œä¾‹å¦‚a&#x3D;(1:100),ç„¶åå†ä½¿ç”¨(:)è¿›è¡Œè½¬æ¢a&#x3D;a(:)</p>
<h2 id="table"><a href="#table" class="headerlink" title="table"></a>table</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">% æ„å»ºtable</span><br><span class="line">RNTI = [1;2;3];</span><br><span class="line">LogicalChannelID = [3;4;5];</span><br><span class="line">RLCEntityType = [<span class="string">&quot;AM&quot;</span>; <span class="string">&quot;AM&quot;</span>; <span class="string">&quot;UM&quot;</span>];</span><br><span class="line">RLCChannelConfig = table(</span><br><span class="line">    RNTI, LogicalChannelID,LogicalChannelGroup,RLCEntityType,...</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line">% æŸ¥è¯¢è¡¨çš„è¡Œæ•°</span><br><span class="line">nRows = size(RLCChannelConfig, 1);</span><br><span class="line">% æŸ¥è¯¢è¡¨çš„åˆ—æ•°</span><br><span class="line">nCols = size(RLCChannelConfig, 2);</span><br><span class="line">% æŠŠtableä¿å­˜æˆ.matæ–‡ä»¶</span><br><span class="line">save(<span class="string">&#x27;RLCChannelConfig.mat&#x27;</span>, <span class="string">&#x27;RLCChannelConfig&#x27;</span>)</span><br><span class="line">% å–å‡ºtableä¸­çš„æŸä¸ªå­—æ®µä¸­çš„æŸä¸€è¡Œçš„æ•°æ®</span><br><span class="line">data = RLCChannelConfig.RNTI(1);</span><br><span class="line">% æŠŠtableè½¬æˆstruct</span><br><span class="line">myStruct = table2struct(RLCChannelConfig)</span><br><span class="line">myStruct_1 = table2struct(RLCChannelConfig(1,2:end));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="å¯¹è§’çŸ©é˜µæ“ä½œ"><a href="#å¯¹è§’çŸ©é˜µæ“ä½œ" class="headerlink" title="å¯¹è§’çŸ©é˜µæ“ä½œ"></a>å¯¹è§’çŸ©é˜µæ“ä½œ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">% åˆ›å»ºå¯¹è§’çŸ©é˜µ</span><br><span class="line">A = diag([1 2 3]);   % ç”Ÿæˆå¯¹è§’çº¿ä¸º [1 2 3] çš„çŸ©é˜µ</span><br><span class="line"></span><br><span class="line">% æå–çŸ©é˜µçš„å¯¹è§’çº¿</span><br><span class="line">d = diag(A);         % è¿”å› A çš„ä¸»å¯¹è§’çº¿</span><br><span class="line"></span><br><span class="line">% ç”Ÿæˆåç§»å¯¹è§’çŸ©é˜µ</span><br><span class="line">B = diag([4 5 6], 1);  % å°† [4 5 6] æ”¾åœ¨ä¸»å¯¹è§’çº¿ä¸Šæ–¹ä¸€æ¡å¯¹è§’çº¿ä¸Š</span><br><span class="line">X = diag((<span class="number">1</span>+<span class="number">1</span>i)*ones(<span class="number">1</span>,Pilot_num));   % all pilots are 1+1i.</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Cell"><a href="#Cell" class="headerlink" title="Cell"></a>Cell</h2><p>Cell æ˜¯ MATLAB ä¸­ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥å­˜å‚¨ä¸åŒç±»å‹æˆ–å¤§å°çš„æ•°æ®é¡¹ã€‚ä¸å¸¸è§„æ•°ç»„åªèƒ½å­˜å‚¨åŒä¸€ç±»å‹ä¸åŒï¼ŒCell éå¸¸é€‚åˆç”¨æ¥ç»„ç»‡æ‚ç±»ä¿¡æ¯ï¼Œæ¯”å¦‚æ··åˆäº†å­—ç¬¦ä¸²ã€å‘é‡ã€çŸ©é˜µç­‰æ•°æ®çš„é›†åˆã€‚</p>
<h3 id="âœ…-åˆ›å»º-Cell-æ•°ç»„"><a href="#âœ…-åˆ›å»º-Cell-æ•°ç»„" class="headerlink" title="âœ… åˆ›å»º Cell æ•°ç»„"></a>âœ… åˆ›å»º Cell æ•°ç»„</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% åˆ›å»ºä¸€ä¸ªç©ºçš„ cell æ•°ç»„</span></span><br><span class="line">x = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">% åˆ†åˆ«å‘ä¸åŒä½ç½®æ·»åŠ ä¸åŒç±»å‹çš„æ•°æ®</span></span><br><span class="line">x&#123;<span class="number">1</span>&#125; = <span class="number">1</span>;                  <span class="comment">% æ•°å­—æ ‡é‡</span></span><br><span class="line">x&#123;<span class="number">2</span>&#125; = <span class="string">&#x27;hello&#x27;</span>;            <span class="comment">% å­—ç¬¦ä¸²</span></span><br><span class="line">x&#123;<span class="number">3</span>&#125; = [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>];            <span class="comment">% å‘é‡</span></span><br><span class="line">x&#123;<span class="number">4</span>&#125; = <span class="built_in">rand</span>(<span class="number">2</span>, <span class="number">2</span>);         <span class="comment">% çŸ©é˜µ</span></span><br><span class="line">x&#123;<span class="number">5</span>&#125; = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>&#125;;         <span class="comment">% åµŒå¥— cell æ•°ç»„</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="ğŸ”-è®¿é—®-Cell-ä¸­çš„å…ƒç´ "><a href="#ğŸ”-è®¿é—®-Cell-ä¸­çš„å…ƒç´ " class="headerlink" title="ğŸ” è®¿é—® Cell ä¸­çš„å…ƒç´ "></a>ğŸ” è®¿é—® Cell ä¸­çš„å…ƒç´ </h3><ul>
<li><p>ä½¿ç”¨ <code>&#123;&#125;</code> è·å–å†…å®¹æœ¬èº«ï¼ˆè§£åŒ…ï¼‰ï¼š</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val = x&#123;<span class="number">2</span>&#125;;    <span class="comment">% è¿”å› &#x27;hello&#x27;ï¼Œç±»å‹ä¸º char</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ <code>()</code> è·å–ä¸€ä¸ª cellï¼ˆæœªè§£åŒ…ï¼‰ï¼š</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val = x(<span class="number">2</span>);    <span class="comment">% è¿”å› &#123;&#x27;hello&#x27;&#125;ï¼Œç±»å‹ä¸º 1Ã—1 cell</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="ğŸ”„-éå†-Cell-æ•°ç»„"><a href="#ğŸ”„-éå†-Cell-æ•°ç»„" class="headerlink" title="ğŸ”„ éå† Cell æ•°ç»„"></a>ğŸ”„ éå† Cell æ•°ç»„</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(x)</span><br><span class="line">    <span class="built_in">disp</span>(x&#123;<span class="built_in">i</span>&#125;);   <span class="comment">% è§£åŒ…å¹¶æ˜¾ç¤ºæ¯ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>


<h2 id="class"><a href="#class" class="headerlink" title="class"></a>class</h2><p>å‡è®¾æœ‰ä¸€ä¸ªnrUEç±»<br>æ„å»ºnrUEsæ•°ç»„å¾ˆç®€å•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UEs = nrUE(Name=ueNames,Position=uePositions, Receive=11);</span><br></pre></td></tr></table></figure>
<p>åªéœ€è¦åœ¨ä¼ å‚æ—¶å°†æ•°ç»„ä¼ è¿›å»å³å¯ï¼Œè¿™æ ·è¾“å‡ºè‡ªåŠ¨æˆä¸ºæ•°ç»„</p>
<h2 id="sizeå‡½æ•°ï¼š-æŸ¥çœ‹æ•°ç»„å°ºå¯¸"><a href="#sizeå‡½æ•°ï¼š-æŸ¥çœ‹æ•°ç»„å°ºå¯¸" class="headerlink" title="sizeå‡½æ•°ï¼š æŸ¥çœ‹æ•°ç»„å°ºå¯¸"></a>sizeå‡½æ•°ï¼š æŸ¥çœ‹æ•°ç»„å°ºå¯¸</h2><p>MATLAB ä¸­çš„ <code>size</code> å‡½æ•°ç”¨äºæŸ¥çœ‹æ•°ç»„æˆ–çŸ©é˜µçš„æ¯ä¸ªç»´åº¦çš„å¤§å°ã€‚</p>
<h3 id="ğŸ“˜-åŸºæœ¬ç”¨æ³•"><a href="#ğŸ“˜-åŸºæœ¬ç”¨æ³•" class="headerlink" title="ğŸ“˜ åŸºæœ¬ç”¨æ³•"></a>ğŸ“˜ åŸºæœ¬ç”¨æ³•</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A = <span class="built_in">rand</span>(<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>);     <span class="comment">% åˆ›å»ºä¸€ä¸ª 4Ã—3Ã—2 çš„ä¸‰ç»´æ•°ç»„</span></span><br><span class="line">s = <span class="built_in">size</span>(A);           <span class="comment">% s = [4 3 2]</span></span><br></pre></td></tr></table></figure>

<h3 id="ğŸ“—-æŸ¥çœ‹æŸä¸€ç»´çš„å¤§å°"><a href="#ğŸ“—-æŸ¥çœ‹æŸä¸€ç»´çš„å¤§å°" class="headerlink" title="ğŸ“— æŸ¥çœ‹æŸä¸€ç»´çš„å¤§å°"></a>ğŸ“— æŸ¥çœ‹æŸä¸€ç»´çš„å¤§å°</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rows = <span class="built_in">size</span>(A, <span class="number">1</span>);     <span class="comment">% ç¬¬ 1 ç»´åº¦å¤§å°ï¼ˆè¡Œæ•°ï¼‰ =&gt; 4</span></span><br><span class="line">cols = <span class="built_in">size</span>(A, <span class="number">2</span>);     <span class="comment">% ç¬¬ 2 ç»´åº¦å¤§å°ï¼ˆåˆ—æ•°ï¼‰ =&gt; 3</span></span><br><span class="line">depth = <span class="built_in">size</span>(A, <span class="number">3</span>);    <span class="comment">% ç¬¬ 3 ç»´åº¦å¤§å° =&gt; 2</span></span><br></pre></td></tr></table></figure>

<h3 id="ğŸ“™-ç¤ºä¾‹ï¼šåˆ†æ-MIMO-ä¿¡å·æ•°ç»„"><a href="#ğŸ“™-ç¤ºä¾‹ï¼šåˆ†æ-MIMO-ä¿¡å·æ•°ç»„" class="headerlink" title="ğŸ“™ ç¤ºä¾‹ï¼šåˆ†æ MIMO ä¿¡å·æ•°ç»„"></a>ğŸ“™ ç¤ºä¾‹ï¼šåˆ†æ MIMO ä¿¡å·æ•°ç»„</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">inputRXSig = <span class="built_in">rand</span>(<span class="number">234</span>, <span class="number">32</span>, <span class="number">4</span>);   <span class="comment">% å­è½½æ³¢ Ã— å‘å°„å¤©çº¿ Ã— æ¥æ”¶å¤©çº¿</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">size</span>(inputRXSig)</span><br><span class="line"><span class="comment">% è¾“å‡ºï¼š[234  32  4]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">size</span>(inputRXSig, <span class="number">3</span>)</span><br><span class="line"><span class="comment">% è¾“å‡ºï¼š4ï¼ˆå³æ¥æ”¶å¤©çº¿æ•°ï¼‰</span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hechenyi.github.io/2025/04/24/NRTDDPerformanceEvaluation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/24/NRTDDPerformanceEvaluation/" class="post-title-link" itemprop="url">NRTDDPerformanceEvaluation</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-04-24 05:47:47 / Modified: 18:56:11" itemprop="dateCreated datePublished" datetime="2025-04-24T05:47:47+08:00">2025-04-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/5G/" itemprop="url" rel="index"><span itemprop="name">5G</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
          <h2 id="1-Basic-Concept"><a href="#1-Basic-Concept" class="headerlink" title="1. Basic Concept"></a>1. Basic Concept</h2><p>In TDD (Time division duplexing) mode, physical uplink shared channel (PUSCH) and physical downlink shared channel (PDSCH) transmissions are scheduled in the same frequency band with separation in time domain. The scheduling strategy can be customized and network performance can be evaluated accordingly. </p>
<h3 id="1-1-ä¸¾ä¾‹è¯´æ˜"><a href="#1-1-ä¸¾ä¾‹è¯´æ˜" class="headerlink" title="1.1 ä¸¾ä¾‹è¯´æ˜"></a>1.1 ä¸¾ä¾‹è¯´æ˜</h3><p>matlabé‡Œé¢å‚æ•°è®¾ç½®å¦‚ä¸‹<br>reference_scs &#x3D; 15kHz(i.e. 1 ms slot), DLULPeriodicity &#x3D; 5 ms, numDLSlots &#x3D; 3, numDLSyms &#x3D; 7, numULSlots &#x3D; 1, numULSyms &#x3D; 5<br>æ‰€ä»¥Number of slots in DL-UL periodicity with respect to reference SCS of 15 kHzå¯¹åº”çš„NumSlotsDLULPeriodicity &#x3D; 5<br>æœ€åSlotåˆ†å¸ƒå›¾å¦‚ä¸‹<br>Slot Index:     0   1   2    3    4<br>            +â€”â€“+â€”+â€”-+â€”-+â€”â€“+<br>Slot Type:  DL     Dl   Dl    Up   UL<br>Symbol Use: full   full  7sym  full 5sym</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hechenyi.github.io/2025/04/23/JavaSwing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/23/JavaSwing/" class="post-title-link" itemprop="url">JavaSwing</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-23 05:20:59" itemprop="dateCreated datePublished" datetime="2025-04-23T05:20:59+08:00">2025-04-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-04-25 19:48:01" itemprop="dateModified" datetime="2025-04-25T19:48:01+08:00">2025-04-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
          <h2 id="Basic-Concept"><a href="#Basic-Concept" class="headerlink" title="Basic Concept"></a>Basic Concept</h2><p>Swing is part of API for providing native look and feel GUI for Java, which has more components than AWT(Abstract Window Toolkit), and these components are more lightweight.  </p>
<p>Documents:<br><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/java/javase/20/docs/api/java.desktop/javax/swing/package-summary.html">https://docs.oracle.com/en/java/javase/20/docs/api/java.desktop/javax/swing/package-summary.html</a>  </p>
<p>These components are as below:</p>
<ul>
<li>Windows and dialogs<ul>
<li>JFrame<br>  <strong>JFrame</strong>æ˜¯ä¸€ä¸ª<strong>é¡¶å±‚å®¹å™¨</strong>ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªçª—å£ï¼Œçª—å£ä¸­å¯ä»¥åŒ…å«æŒ‰é’®ã€æ–‡æœ¬æ¡†ã€æ ‡ç­¾ç­‰å„ç§ç»„ä»¶ï¼Œå¹¶ä¸”JFrameä¹Ÿå¯ä»¥å¸ƒå±€ï¼Œä¾‹å¦‚æ·»åŠ BorderLayout</li>
<li>JDialog</li>
<li>JColorChooser</li>
<li>JFileChooser</li>
<li>JOptionPane</li>
</ul>
</li>
<li>Menus<ul>
<li>JMenuItem</li>
<li>JMenu</li>
<li>JMenuBar</li>
<li>JCheckBoxMenuItem</li>
<li>JRadioButtonMenuItem</li>
<li>JPopupMenu</li>
<li>JSeparator</li>
</ul>
</li>
<li>Container<ul>
<li>JPanel<br>  JPanelæ˜¯é¢æ¿ç»„ä»¶ï¼Œé€šå¸¸ä¸å•ç‹¬æ˜¾ç¤ºï¼Œè€Œæ˜¯ä½œä¸ºå…¶ä»–å®¹å™¨ï¼ˆæ¯”å¦‚JFrameï¼‰ä¸­çš„å­å®¹å™¨ï¼Œä¸»è¦ç”¨æ¥ï¼šç»„ç»‡ç»„ä»¶ï¼ˆæ¯”å¦‚æŠŠæŒ‰é’®ã€æ–‡æœ¬æ¡†æ”¾åœ¨ä¸€ä¸ªé¢æ¿é‡Œï¼‰ï¼Œé…åˆä¸åŒçš„å¸ƒå±€ç®¡ç†å™¨ä½¿ç”¨ï¼ˆFlowLayoutã€ BorderLayoutã€ GridLayoutï¼‰</li>
<li>JTappedPane</li>
<li>JSplitPane</li>
<li>JScrollPane</li>
<li>JToolBar</li>
<li>JDesktopPane</li>
<li>JInternalFrame</li>
<li>JLayeredPane</li>
</ul>
</li>
<li>Control elements<ul>
<li>JLabel</li>
<li>JButton</li>
<li>JToggleButton</li>
<li>JCheckBox<br>  å¤é€‰æ¡†ç»„ä»¶ï¼Œç”¨æ¥è®©ç”¨æˆ·åœ¨å¤šä¸ªé€‰é¡¹ä¸­è¿›è¡Œå•é€‰æˆ–å¤šé€‰</li>
<li>JRadioButton</li>
<li>ButtonGroup</li>
<li>JComboBox</li>
<li>JList</li>
<li>JTextField</li>
<li>JTextArea</li>
<li>JSeperator</li>
</ul>
</li>
<li>Event handling<ul>
<li>ActionEvent</li>
<li>AdjustmentEvent</li>
<li>FocusEvent</li>
<li>ItemEvent</li>
<li>MouseEvent</li>
<li>TextEvent</li>
<li>WindowEvent</li>
<li>Menuvent</li>
<li>ListSelectionEvent</li>
<li>TableModelEvent<br>ä»¥WindowEventä¸ºä¾‹</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">JFrame testFrame = new JFrame(<span class="string">&quot;Listener Test&quot;</span>);</span><br><span class="line">testFrame.setSize(300,200);</span><br><span class="line">testFrame.addWindowListener(new <span class="function"><span class="title">WindowAdpater</span></span>()&#123;</span><br><span class="line">    public void windowClosing(WindowEvent e)&#123;</span><br><span class="line">        JOptionPane testOpt = new JOptionPane();</span><br><span class="line">        testOpt.showMessageDialog(new JFrame(), <span class="string">&quot;closing Window!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä½¿ç”¨äº†åŒ¿åå‡½æ•°ï¼Œç­‰åŒäºä»¥ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">JFrame testFrame = new JFrame(<span class="string">&quot;Listener Test&quot;</span>);</span><br><span class="line">class MyWindowListener extends WindowAdpater&#123;</span><br><span class="line">    public void windowClosing(WindowEvent e)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;çª—å£å…³é—­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">testFrame.addWindowListener(new MyWindowListener());</span><br></pre></td></tr></table></figure>
<ul>
<li>Layout manager<ul>
<li>FlowLayout</li>
<li>GridLayout</li>
<li>BorderLayout</li>
<li>BoxLayout</li>
<li>CardLayout</li>
<li>GridBagLayout</li>
<li>GroupLayout</li>
<li>SpringLayout</li>
</ul>
</li>
</ul>
<h2 id="Javaçš„æŠ½è±¡ç±»å’Œæ¥å£"><a href="#Javaçš„æŠ½è±¡ç±»å’Œæ¥å£" class="headerlink" title="Javaçš„æŠ½è±¡ç±»å’Œæ¥å£"></a>Javaçš„æŠ½è±¡ç±»å’Œæ¥å£</h2><p>ä»¥æŠ½è±¡ç±»WindowAdapterå’Œæ¥å£WindowListenerä¸ºä¾‹ã€‚<br>é€šå¸¸æ¥è¯´ï¼ŒæŠ½è±¡ç±»ç»§æ‰¿äº†æ¥å£çš„æ–¹æ³•ï¼Œä½†æ˜¯æ¯ä¸ªæ–¹æ³•éƒ½ç•™äº†ä¸ªç©ºå£³å®ç°ï¼Œæ­£å› ä¸ºè¿™äº›ç©ºå£³ï¼Œç»§æ‰¿äº†æ¥å£çš„æŠ½è±¡ç±»åªéœ€è¦å†™åƒè¦†ç›–çš„é‚£å‡ ç§æ–¹æ³•ï¼Œè€Œä¸æ˜¯è¢«è¿«å†™å®Œå…¨éƒ¨ã€‚<br>ä¾‹å¦‚WindowAdapterç»§æ‰¿WindowListener</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public abstract class WindowAdapter implements WindowListener&#123;</span><br><span class="line">    public void windowOpened(WindowEvent e)&#123;&#125;</span><br><span class="line">    ...</span><br><span class="line">    public void windowDeactivated(WindowEvent e)&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨ç»§æ‰¿çš„æ–¹æ³•æ„å»ºMainFrameç±»"><a href="#ä½¿ç”¨ç»§æ‰¿çš„æ–¹æ³•æ„å»ºMainFrameç±»" class="headerlink" title="ä½¿ç”¨ç»§æ‰¿çš„æ–¹æ³•æ„å»ºMainFrameç±»"></a>ä½¿ç”¨ç»§æ‰¿çš„æ–¹æ³•æ„å»ºMainFrameç±»</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class MainFrame extends JFrame&#123;</span><br><span class="line">    public <span class="function"><span class="title">MainFrame</span></span>()&#123;</span><br><span class="line">        setTitle(<span class="string">&quot;Choose Your Favorite Items&quot;</span>);</span><br><span class="line">        setSize(400, 300);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥è¿™ä¹ˆç†è§£,ä»¥ä¸‹çš„JFrameçˆ¶ç±»çš„æ„é€ å‡½æ•°ä¼šåœ¨å­ç±»MainFrameè°ƒç”¨æ„é€ å‡½æ•°æ—¶è¢«è°ƒç”¨ï¼Œå› ä¸ºå¦‚æœçˆ¶ç±»æ„é€ å‡½æ•°å¦‚æœæ˜¯æ— å‚çš„è¯é‚£ä¹ˆå°±ä¼šè¢«éšå‹è°ƒç”¨ï¼Œå¦‚æœæ˜¯æœ‰å‚çš„è¯éœ€è¦é€šè¿‡superå‡½æ•°æ¥è°ƒç”¨ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class JFrame&#123;</span><br><span class="line">    public <span class="function"><span class="title">JFrame</span></span>()&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ç»§æ‰¿äº†è¿™ä¸ªçˆ¶ç±»çš„MyFrameå­ç±»ç›¸å½“äºåœ¨æ„é€ å‡½æ•°é‡Œé¢æ‰§è¡Œäº†ä¸€ésuper()</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public <span class="function"><span class="title">MainFrame</span></span>()&#123;</span><br><span class="line">    super();</span><br><span class="line">    setTitle(<span class="string">&quot;Choose your favourite items&quot;</span>);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<img src="/images/ä½ .jpg">
ä½ å¥½å¯çˆ±ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬æ€§æ ¼ä¼šå¦‚ä½•ç›¸åƒ

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hechenyi.github.io/2025/04/22/openairinterface/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/22/openairinterface/" class="post-title-link" itemprop="url">openairinterface</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-22 17:45:43" itemprop="dateCreated datePublished" datetime="2025-04-22T17:45:43+08:00">2025-04-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-05-31 21:42:00" itemprop="dateModified" datetime="2025-05-31T21:42:00+08:00">2025-05-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/5G/" itemprop="url" rel="index"><span itemprop="name">5G</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
          <h2 id="openairinterface"><a href="#openairinterface" class="headerlink" title="openairinterface"></a>openairinterface</h2><h3 id="PHY-MODULATION"><a href="#PHY-MODULATION" class="headerlink" title="PHY&#x2F;MODULATION&#x2F;"></a>PHY&#x2F;MODULATION&#x2F;</h3><h4 id="slot-fep-nr-c"><a href="#slot-fep-nr-c" class="headerlink" title="slot_fep_nr.c"></a>slot_fep_nr.c</h4><p><strong>nr_slot_fep_init_sync</strong> function æ˜¯5G NR UE PHYå±‚çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯é’ˆå¯¹æŸä¸ªæŒ‡å®šçš„slotå’ŒOFDMç¬¦å·<br>åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†:</p>
<ul>
<li>ä»æ—¶åŸŸé‡‡æ ·ä¸­æå–è¯¥ç¬¦å·çš„æ ·æœ¬</li>
<li>åšDFTè½¬æ¢ ï¼ˆæ—¶åŸŸ-&gt;é¢‘åŸŸï¼‰</li>
<li>å¯¹é¢‘åŸŸç¬¦å·è¿›è¡Œæ—‹è½¬è¡¥å¿(symbol rotation)</li>
<li>å°†é¢‘åŸŸç»“æœå­˜å…¥ç¼“å†²åŒºï¼Œä¸ºåç»­å¤„ç†ï¼ˆè§£è°ƒï¼Œæµ‹é‡ç­‰ï¼‰åšå‡†å¤‡</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/// è·å–å½“å‰ofdmç¬¦å·åœ¨æ—¶åŸŸä¸­çš„rx_offset</span><br><span class="line">/// å…¶ä¸­is * fp-&gt;samples_per_frameå‰é¢æ‰€æœ‰frameçš„é‡‡æ ·ç‚¹æ•°ç›®</span><br><span class="line">nr_slot_fep_init_sync(ue, proc, i, j, is * fp-&gt;samples_per_frame + ue-&gt;ssb_offset);</span><br><span class="line">/// nr_slot_fep_init_syncå‡½æ•°å†…éƒ¨</span><br><span class="line">/// å…¶ä¸­Nsè¡¨ç¤ºSlotæ•°ï¼Œsymbolè¡¨ç¤ºç¬¦å·æ•°ï¼Œä»è€Œå¯ä»¥ä½¿å¾—å¯¹æ¯ä¸ªç¬¦å·éƒ½èƒ½åšå¤„ç†</span><br><span class="line">unsigned int slot_offset = frame_parms-&gt;get_samples_slot_timestamp(Ns,frame_parms,0);</span><br><span class="line">unsigned int rx_offset   = sample_offset + slot_offset;</span><br><span class="line">unsigned int abs_symbol  = Ns * frame_parms-&gt;symbols_per_slot + symbol;</span><br><span class="line"><span class="keyword">for</span> (int idx_symb = Ns*frame_parms-&gt;symbols_per_slot; idx_symb &lt;= abs_symbol; idx_symb++)</span><br><span class="line"></span><br><span class="line">    rx_offset += (abs_symbol%(0x7&lt;&lt;<span class="string">frame_parms-&gt;numerology_index)) ? nb_prefix_samples : nb_prefix_samples0;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/// æœ€åï¼Œå†åŠ ä¸Šå½“å‰ slot å†…çš„ symbol ä¸ªæ•° * æ¯ä¸ªç¬¦å·çš„æ•°æ®é•¿åº¦ï¼ˆä¸å« CPï¼‰  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">rx_offset += frame_parms</span>-&gt;ofdm_symbol_size * symbol;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç”±ä»£ç å¯çŸ¥rx_offsetè®¡ç®—äº†åˆ°å½“å‰å¸§ä¸­æŸä¸ª slot å†…æŸä¸ª OFDM ç¬¦å·åœ¨æ—¶åŸŸï¼ˆé‡‡æ ·ï¼‰æ•°æ®ä¸­çš„ç²¾ç¡®ä½ç½®ï¼ˆé‡‡æ ·ç‚¹æ•°ï¼‰â€ã€‚<br>å®ƒè€ƒè™‘äº†æ‰€æœ‰é‡‡æ ·æ•°æ®åç§»ï¼ˆåŒ…å«cpï¼‰</p>
<p>è¿™ä¸ªè®¡ç®—è€Œæ¥çš„rx_offsetåé¢ä¼šè¢«ç”¨äºæ›´æ–°æ—¶é—´æˆ³ï¼Œä¼šå°†RFæ¥æ”¶é“¾ä¸­çš„é‡‡æ ·æ—¶é—´æˆ³å‘å‰æ¨è¿›<strong>rx_offset_sl</strong>ä¸ªé‡‡æ ·ç‚¹ï¼Œç¡®ä¿åç»­çš„è§£è°ƒ&#x2F;è§£ç ä»æ­£ç¡®ä½ç½®å¼€å§‹,å…·ä½“å¯è§ä¸‹é¢<strong>syncInFrame</strong>å‡½æ•°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">void syncInFrame(PHY_VARS_NR_UE *UE, openair0_timestamp *timestamp) &#123;</span><br><span class="line">    int rx_offset = (get_softmodem_params()-&gt;sl_mode == 2) ? UE-&gt;rx_offset_sl : UE-&gt;rx_offset;</span><br><span class="line">    LOG_I(NR_PHY, <span class="string">&quot;Resynchronizing RX by %d samples (mode = %d)\n&quot;</span>, rx_offset, UE-&gt;mode);</span><br><span class="line">    *timestamp += UE-&gt;frame_parms.get_samples_per_slot(1,&amp;UE-&gt;frame_parms);</span><br><span class="line">    <span class="keyword">for</span> (int size = rx_offset; size &gt; 0; size -= UE-&gt;frame_parms.samples_per_subframe) &#123;</span><br><span class="line">      int unitTransfer=size&gt;UE-&gt;frame_parms.samples_per_subframe ? UE-&gt;frame_parms.samples_per_subframe : size ;</span><br><span class="line">      // we write before <span class="built_in">read</span> because gNB waits <span class="keyword">for</span> UE to write and both executions halt</span><br><span class="line">      // this happens here as the <span class="built_in">read</span> size is samples_per_subframe <span class="built_in">which</span> is very much larger than samp_per_slot</span><br><span class="line">      <span class="keyword">if</span> (IS_SOFTMODEM_RFSIM &amp;&amp; !get_softmodem_params()-&gt;sync_ref) dummyWrite(UE,*timestamp, unitTransfer);</span><br><span class="line">      AssertFatal(unitTransfer ==</span><br><span class="line">                  UE-&gt;rfdevice.trx_read_func(&amp;UE-&gt;rfdevice,</span><br><span class="line">                                             timestamp,</span><br><span class="line">                                             (void **)UE-&gt;common_vars.rxdata,</span><br><span class="line">                                             unitTransfer,</span><br><span class="line">                                             UE-&gt;frame_parms.nb_antennas_rx),<span class="string">&quot;&quot;</span>);</span><br><span class="line">      *timestamp += unitTransfer; // this does not affect the <span class="built_in">read</span> but needed <span class="keyword">for</span> RFSIM write</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»ä»£ç å¯è§ï¼Œæ¯æ¬¡å¤„ç†sample_per_subframe æ•°ç›®çš„æ•°æ®ï¼Œç„¶åæ›´æ–°timestampæ—¶é—´æˆ³ï¼Œæœ€åå°†timestampåŠ ä¸Šäº†rx_offset,éœ€è¦æ³¨æ„çš„çš„æ˜¯å¯¹äºéœ€è¦è·³è¿‡çš„æ•°æ®ä¹Ÿéœ€è¦è¿›è¡Œ<strong>rfdevice.trx_read_func</strong>å¤„ç†ï¼Œå› ä¸ºRFé‡‡é›†çš„æ•°æ®æ˜¯æµå¼çš„ï¼Œæ•°æ®æ˜¯è¿ç»­äº§ç”Ÿå¹¶å­˜æ”¾åˆ°ç¡¬ä»¶ç¼“å†²åŒºé‡Œçš„ã€‚</p>
<hr>
<blockquote>
<p><strong>Notice</strong><br><br>ä¸€ä¸ªOFDMç¬¦å·çš„é‡‡æ ·ç‚¹æ•°é‡ï¼ˆä¸åŒ…å«cpï¼‰ç­‰äºFFT sizeï¼Œ<br>ä¹Ÿå°±è¯´FFT sizeä¸åŒ…å«cpï¼Œä½†æ˜¯åœ¨è®¡ç®—æ—¶åŸŸä¸Šçš„offsetæ—¶éœ€è¦è€ƒè™‘cpï¼Œæ­£å¦‚ä¸Šè¿°ä»£ç æ‰€ç¤º</p>
</blockquote>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">/// æ ¹æ®rx_offsetå–å‡ºrxdata</span><br><span class="line">  <span class="keyword">for</span> (unsigned char aa=0; aa&lt;frame_parms-&gt;nb_antennas_rx; aa++) &#123;</span><br><span class="line">    memset(&amp;common_vars-&gt;common_vars_rx_data_per_thread[proc-&gt;thread_id].rxdataF[aa][frame_parms-&gt;ofdm_symbol_size*symbol],0,frame_parms-&gt;ofdm_symbol_size*sizeof(int32_t));</span><br><span class="line"></span><br><span class="line">    int16_t *rxdata_ptr;</span><br><span class="line">    rx_offset%=frame_length_samples*2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (rx_offset+frame_parms-&gt;ofdm_symbol_size &gt; frame_length_samples*2 ) &#123;</span><br><span class="line">      // rxdata is 2 frames len</span><br><span class="line">      // we have to wrap on the end</span><br><span class="line"></span><br><span class="line">      memcpy((void *)&amp;tmp_dft_in[<span class="number">0</span>],</span><br><span class="line">             (void *)&amp;common_vars-&gt;rxdata[aa][rx_offset],</span><br><span class="line">             (frame_length_samples*<span class="number">2</span> - rx_offset) * sizeof(int32_t));</span><br><span class="line">      memcpy((void *)&amp;tmp_dft_in[frame_length_samples*<span class="number">2</span> - rx_offset],</span><br><span class="line">             (void *)&amp;common_vars-&gt;rxdata[aa][<span class="number">0</span>],</span><br><span class="line">             (frame_parms-&gt;ofdm_symbol_size - (frame_length_samples*<span class="number">2</span> - rx_offset)) * sizeof(int32_t));</span><br><span class="line">      rxdata_ptr = (int16_t *)tmp_dft_in;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((rx_offset &amp; <span class="number">7</span>) != <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">      // if input to dft is not <span class="number">256</span>-bit aligned</span><br><span class="line">      memcpy((void *)&amp;tmp_dft_in[<span class="number">0</span>],</span><br><span class="line">             (void *)&amp;common_vars-&gt;rxdata[aa][rx_offset],</span><br><span class="line">             frame_parms-&gt;ofdm_symbol_size * sizeof(int32_t));</span><br><span class="line">      rxdata_ptr = (int16_t *)tmp_dft_in;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">      // use dft input from RX buffer directly</span><br><span class="line">      rxdata_ptr = (int16_t *)&amp;common_vars-&gt;rxdata[aa][rx_offset];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">/// è°ƒç”¨dft()å‡½æ•°åšæ—¶åŸŸåˆ°é¢‘åŸŸè½¬æ¢ï¼Œè¾“å‡ºå­˜åˆ°rxdataFç¼“å†²åŒº</span><br><span class="line">dft(dftsize,</span><br><span class="line">    rxdata_ptr,</span><br><span class="line">    (int16_t *)&amp;common_vars-&gt;common_vars_rx_data_per_thread[proc-&gt;thread_id].rxdataF[aa][frame_parms-&gt;ofdm_symbol_size*symbol],</span><br><span class="line">    1);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="rxdata-æ—¶åŸŸé‡‡æ ·æ•°æ®-å’Œ-rxdataF-ï¼ˆé¢‘åŸŸç¬¦å·æ•°æ®ï¼‰"><a href="#rxdata-æ—¶åŸŸé‡‡æ ·æ•°æ®-å’Œ-rxdataF-ï¼ˆé¢‘åŸŸç¬¦å·æ•°æ®ï¼‰" class="headerlink" title="rxdata (æ—¶åŸŸé‡‡æ ·æ•°æ®) å’Œ rxdataF ï¼ˆé¢‘åŸŸç¬¦å·æ•°æ®ï¼‰"></a>rxdata (æ—¶åŸŸé‡‡æ ·æ•°æ®) å’Œ rxdataF ï¼ˆé¢‘åŸŸç¬¦å·æ•°æ®ï¼‰</h5><p>rxdata<br>æ¯ä¸¤ä¸ªint16_tæ˜¯ä¸€ä¸ªå¤æ•°é‡‡æ ·(I + jQ)</p>
<p>| I1 | Q1 | I2 | Q2 | I3 | Q3 | I4 | Q4 | â€¦  (æ—¶åŸŸé‡‡æ ·åºåˆ—)<br>|â€”-|â€”-|â€”-|â€”-|â€”-|â€”-|â€”-|â€”-|<br>  t0   t0  t1   t1  t2   t2  t3   t3     æ—¶é—´é¡ºåºé‡‡æ ·ç‚¹</p>
<p>rxdataF<br>æ¯ä¸¤ä¸ªint16_tæ˜¯ä¸€ä¸ªå­è½½æ³¢çš„é¢‘åŸŸå¤æ•°ç³»æ•°  </p>
<p>| Re(k&#x3D;0) | Im(k&#x3D;0) | Re(k&#x3D;1) | Im(k&#x3D;1) | Re(k&#x3D;2) | Im(k&#x3D;2) | â€¦ (é¢‘åŸŸå­è½½æ³¢åºåˆ—)<br>|â€”â€”â€”|â€”â€”â€”|â€”â€”â€”|â€”â€”â€”|â€”â€”â€”|â€”â€”â€”|<br>  å­è½½æ³¢0    å­è½½æ³¢0    å­è½½æ³¢1    å­è½½æ³¢1    å­è½½æ³¢2    å­è½½æ³¢2</p>
<h3 id="executable"><a href="#executable" class="headerlink" title="executable"></a>executable</h3><p>é‡Œé¢æœ‰å¤šä¸ªä¸buildåç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶åŒåçš„.hå’Œ.cæ–‡ä»¶ï¼Œä¾‹å¦‚nr-uesoftmodem.cï¼Œç›¸å½“äºåœ¨æ‰§è¡Œnr-uesoftmodemåå°±ä¼šå»è¿™ä¸ªcæ–‡ä»¶é‡Œæ‰¾ä¸»å‡½æ•°ï¼Œç„¶åä¾æ¬¡è¿è¡Œã€‚</p>
<h4 id="softmodem-common-h"><a href="#softmodem-common-h" class="headerlink" title="softmodem-common.h"></a>softmodem-common.h</h4><ul>
<li>ç¬¬ä¸€æ­¥ï¼Œå…ˆ#define CMDLINE_PARAMS_DESC,ç”¨äºå°†ç»ˆç«¯ä¼ å…¥çš„å‚æ•°æ”¾å…¥ä¸€ä¸ªä¸´æ—¶å˜é‡ä¸­</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#define CMDLINE_PARAMS_DESC &#123;  \</span></span><br><span class="line">    &#123;<span class="string">&quot;rf-config-file&quot;</span>,       CONFIG_HLP_RFCFGF,       0,              strptr:&amp;RF_CONFIG_FILE,             defstrval:NULL,        TYPE_STRING, 0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;split73&quot;</span>,              CONFIG_HLP_SPLIT73,      0,              strptr:&amp;SPLIT73,                    defstrval:NULL,        TYPE_STRING, 0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;thread-pool&quot;</span>,          CONFIG_HLP_TPOOL,        0,              strptr:&amp;TP_CONFIG,                  defstrval:<span class="string">&quot;-1,-1,-1,-1,-1,-1,-1,-1&quot;</span>, TYPE_STRING, 0&#125;,       \</span><br><span class="line">    &#123;<span class="string">&quot;phy-test&quot;</span>,             CONFIG_HLP_PHYTST,       PARAMFLAG_BOOL, iptr:&amp;PHY_TEST,                     defintval:0,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;sl-phy-test&quot;</span>,          CONFIG_HLP_SL_PHYTST,    PARAMFLAG_BOOL, iptr:&amp; </span><br><span class="line">    ....</span><br><span class="line">    TUNE_OFFSET,                defintval:0,           TYPE_DOUBLE, 0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;wait-for-sync&quot;</span>,        NULL,                    PARAMFLAG_BOOL, iptr:&amp;WAIT_FOR_SYNC,                defintval:0,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;single-thread-enable&quot;</span>, CONFIG_HLP_NOSNGLT,      PARAMFLAG_BOOL, iptr:&amp;SINGLE_THREAD_FLAG,           defintval:0,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;C&quot;</span> ,                   CONFIG_HLP_DLF,          0,              u64ptr:&amp;(downlink_frequency[0][0]), defuintval:3600000000, TYPE_UINT64, 0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;CO&quot;</span> ,                  CONFIG_HLP_ULF,          0,              iptr:&amp;(uplink_frequency_offset[0][0]), defintval:0,        TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;a&quot;</span> ,                   CONFIG_HLP_CHOFF,        0,              iptr:&amp;CHAIN_OFFSET,                 defintval:0,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;d&quot;</span> ,                   CONFIG_HLP_SOFTS,        PARAMFLAG_BOOL, uptr:(uint32_t *)&amp;do_forms,         defintval:0,           TYPE_INT8,   0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;q&quot;</span> ,                   CONFIG_HLP_STMON,        PARAMFLAG_BOOL, iptr:&amp;opp_enabled,                  defintval:0,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;numerology&quot;</span> ,          CONFIG_HLP_NUMEROLOGY,   PARAMFLAG_BOOL, iptr:&amp;NUMEROLOGY,                   defintval:1,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;band&quot;</span> ,                CONFIG_HLP_BAND,         0,              iptr:&amp;BAND,                         defintval:78,          TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;emulate-rf&quot;</span> ,          CONFIG_HLP_EMULATE_RF,   PARAMFLAG_BOOL, iptr:&amp;EMULATE_RF,                   defintval:0,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;parallel-config&quot;</span>,      CONFIG_HLP_PARALLEL_CMD, 0,              strptr:&amp;parallel_config,            defstrval:NULL,        TYPE_STRING, 0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;worker-config&quot;</span>,        CONFIG_HLP_WORKER_CMD,   0,              strptr:&amp;worker_config,              defstrval:NULL,        TYPE_STRING, 0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;noS1&quot;</span>,                 CONFIG_HLP_NOS1,         PARAMFLAG_BOOL, uptr:&amp;noS1,                         defintval:0,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;rfsim&quot;</span>,                CONFIG_HLP_RFSIM,        PARAMFLAG_BOOL, uptr:&amp;rfsim,                        defintval:0,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;nokrnmod&quot;</span>,             CONFIG_HLP_NOKRNMOD,     PARAMFLAG_BOOL, uptr:&amp;nokrnmod,                     defintval:0,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;nbiot-disable&quot;</span>,        CONFIG_HLP_DISABLNBIOT,  PARAMFLAG_BOOL, uptr:&amp;nonbiot,                      defuintval:0,          TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;chest-freq&quot;</span>,           CONFIG_HLP_CHESTFREQ,    0,              iptr:&amp;SYNC_REF,                     defintval:0,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;nid1&quot;</span>,                 CONFIG_HLP_NID1,         0,              iptr:&amp;NID1,                         defintval:10,          TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;nid2&quot;</span>,                 CONFIG_HLP_NID2,         0,              iptr:&amp;NID2,                         defintval:1,           TYPE_INT,    0&#125;,                     \</span><br><span class="line">    &#123;<span class="string">&quot;message&quot;</span>,              CONFIG_HLP_MSG,          0,              strptr:&amp;SL_USER_MSG,                defstrval:NULL,        TYPE_STRING, 0&#125;,                     \</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç¬¬äºŒæ­¥ï¼Œå°†ä¸´æ—¶å˜é‡æ”¾å…¥ç»“æ„ä½“å˜é‡ä¸­ï¼Œç”¨äºåç»­è°ƒç”¨</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#define NODE_NUMBER         softmodem_params.node_number</span></span><br><span class="line"><span class="comment">#define SL_DEST_ID          softmodem_params.dest_id</span></span><br><span class="line"><span class="comment">#define NON_STOP            softmodem_params.non_stop</span></span><br><span class="line"><span class="comment">#define EMULATE_L1          softmodem_params.emulate_l1</span></span><br><span class="line"><span class="comment">#define CONTINUOUS_TX       softmodem_params.continuous_tx</span></span><br><span class="line"><span class="comment">#define SYNC_REF            softmodem_params.sync_ref</span></span><br><span class="line"><span class="comment">#define NID1                softmodem_params.nid1</span></span><br><span class="line"><span class="comment">#define NID2                softmodem_params.nid2</span></span><br><span class="line"><span class="comment">#define SL_USER_MSG         softmodem_params.sl_user_msg</span></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="è°ƒç”¨nr-uesoftmodem-c"><a href="#è°ƒç”¨nr-uesoftmodem-c" class="headerlink" title="è°ƒç”¨nr-uesoftmodem.c"></a>è°ƒç”¨nr-uesoftmodem.c</h4><h5 id="è°ƒç”¨UE-thread-SL"><a href="#è°ƒç”¨UE-thread-SL" class="headerlink" title="è°ƒç”¨UE_thread_SL"></a>è°ƒç”¨UE_thread_SL</h5><ul>
<li><p>Initialization</p>
<ul>
<li>åˆå§‹åŒ–UE</li>
<li>æ”¶å‘ç¼“å†²åŒºæŒ‡é’ˆ</li>
<li>å°„é¢‘è®¾å¤‡è®¾ç½®</li>
<li>FIFOåˆå§‹åŒ–<br>  åˆå§‹åŒ–ä¸€ä¸ªå‘½åä¸ºnfçš„<strong>notifiedFIFO</strong>,è¿™æ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰é˜Ÿåˆ—ï¼Œç”¨äºç®¡ç†ä»å·¥ä½œçº¿ç¨‹ï¼ˆçº¿ç¨‹æ± Tpoolä¸­ï¼‰è¿”å›çš„ç»“æœã€‚å·¥ä½œçº¿ç¨‹åœ¨å®Œæˆæ—¶éš™å¤„ç†ä»»åŠ¡åä¼šé€šçŸ¥è¿™ä¸ªFIFI<br>  åˆå§‹åŒ–ä¸€ä¸ªå‘½åä¸ºfreeBlocksçš„notifiedFIFOï¼Œè¿™ä¸ªé˜Ÿåˆ—å°†æŒæœ‰é¢„å…ˆåˆ†é…å¥½çš„æ•°æ®ç»“æ„<strong>nr_rxtx_thread_data_t</strong>,å‡†å¤‡ç”¨äºå¤„ç†å³å°†åˆ°æ¥çš„æ—¶éš™ã€‚ä½¿ç”¨é¢„å…ˆåˆ†é…å—å¯ä»¥é¿å…åœ¨ä¸»å¾ªç¯ä¸­é¢‘ç¹è¿›è¡Œå†…å­˜åˆ†é…å’Œé‡Šæ”¾</li>
<li>åˆå§‹åŒ–å˜é‡ï¼ŒåŒ…æ‹¬sync_running_slç­‰æ ‡è¯†ä½</li>
</ul>
</li>
<li><p>é¢„åˆ†é…å¤„ç†å—ï¼ˆpre-allocate processing blocksï¼‰<br>è¿™é‡Œä½¿ç”¨äº†FIFOä»»åŠ¡é˜Ÿåˆ—ï¼Œå…·ä½“æ¥è¯´æ„å»ºäº†TPoolçº¿ç¨‹æ± ï¼Œç„¶åè¿˜æ„å»ºäº†ä¸€ä¸ªFIFOä»»åŠ¡é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­æ¯ä¸ªæˆå‘˜æ˜¯ä¸€ä¸ªä»»åŠ¡ç»“æ„ä½“ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªä»»åŠ¡å‡½æ•° + msgdata</p>
<ul>
<li>notifiedFIFO<br>  è¿™ä¸ªé˜Ÿåˆ—æ˜¯ç”¨æ¥ç®¡ç†ä»»åŠ¡é˜Ÿåˆ—</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">typedef struct notifiedFIFO&#123;</span><br><span class="line">    /// é˜Ÿåˆ—çš„å°¾éƒ¨ï¼ˆç”¨äºå…¥åˆ—ï¼‰</span><br><span class="line">    notifiedFIFO_elt_t *inF;</span><br><span class="line">    /// é˜Ÿåˆ—çš„å¤´éƒ¨ï¼ˆç”¨äºå‡ºåˆ—ï¼‰</span><br><span class="line">    notifiedFIFO_elt_t *outF;</span><br><span class="line"></span><br><span class="line">&#125; notifiedFIFO_t;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>newNotifiedFIFO_elt, notifiedFIFO_eltç»“æ„ä½“æ˜¯notifiedFIFOé˜Ÿåˆ—çš„æˆå‘˜ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€ä¸ªä»»åŠ¡å…ƒç´ ï¼Œé‡Œé¢åŒ…å«ä»»åŠ¡å‡½æ•°è¿˜æœ‰æ•°æ®ã€‚ä¸ºäº†é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªå…ƒç´ åˆ†é…å†…å­˜ï¼Œå¹¶ä¸ºå…¶æä¾›ä¸€äº›é¢å¤–çš„åŠŸèƒ½ï¼ˆæ¯”å¦‚å­˜å‚¨msgDataï¼Œå¹¶ç¡®ä¿æ•°æ®å¯¹é½ä»¥ä¾¿SIMDå¤„ç†ï¼‰</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">typedef struct notifiedFIFO_elt_s&#123;</span><br><span class="line"></span><br><span class="line">    struct notifiedFIFO_elt_s *next;</span><br><span class="line">    void (*processingFunc) (void *);</span><br><span class="line">    void *msgData;</span><br><span class="line">    ...</span><br><span class="line">&#125; notifiedFIFO_elt_t;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>pushNotifiedFIFO_nothreadSafe<br>  è¿™æ®µä»£ç å®ç°çš„æ˜¯ä¸€ä¸ªéçº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—æ“ä½œï¼Œå…·ä½“æ˜¯å°†ä¸€ä¸ªæ–°çš„å…ƒç´ ï¼ˆnotifiedFIFO_elt_t *msgï¼‰æ¨å…¥é˜Ÿåˆ—(notifiedFIFO_t *nf)çš„æœ«å°¾ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å°†<strong>msg</strong>æ·»åŠ åˆ°ä¸€ä¸ªåä¸º<strong>notifiedFIFO_t</strong>çš„é˜Ÿåˆ—ä¸­ï¼Œ å¹¶ç»´æŠ¤é˜Ÿåˆ—çš„å…¥å£å’Œå‡ºå£æŒ‡é’ˆ</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pushNotifiedFIFO_nothreadSafe(notifiedFIFO_t *nf, notifiedFIFO_elt_t *msg)&#123;</span><br><span class="line">    msg-&gt;next = NULL;</span><br><span class="line">    <span class="keyword">if</span>(nf-&gt;outF == NULL)</span><br><span class="line">    nf-&gt;outF = msg;</span><br><span class="line">    <span class="keyword">if</span>(nf-&gt;inF != NULL)</span><br><span class="line">    nf-&gt;inF-&gt;next = msg;</span><br><span class="line">    </span><br><span class="line">    nf-&gt;inF = msg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>pushTpool<br>  è¿™ä¸ªå‡½æ•°çš„ç›®çš„æ˜¯å°†ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ï¼Œå¹¶æ ¹æ®çº¿ç¨‹æ± çš„çŠ¶æ€å†³å®šä»»åŠ¡çš„å¤„ç†æ–¹å¼ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒæœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼š1. çº¿ç¨‹æ± å·²æ¿€æ´»æ—¶ï¼Œä»»åŠ¡ä¼šè¢«æ”¾å…¥é˜Ÿåˆ—ï¼Œç­‰å¾…å·¥ä½œçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­å–å‡ºå¹¶æ‰§è¡Œã€‚2. çº¿ç¨‹æ± æœªæ¿€æ´»æ—¶ï¼Œä»»åŠ¡ä¼šåœ¨å½“å‰çº¿ç¨‹ä¸­ç†è§£æ‰§è¡Œã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">static inline void pushTpool(tpool_t *t, notifiedFIFO_elt_t *msg)&#123;</span><br><span class="line">  <span class="keyword">if</span> (t-&gt;measurePerf) msg-&gt;creationTime=rdtsc_oai();</span><br><span class="line">    <span class="keyword">if</span> ( t-&gt;activated)</span><br><span class="line">        pushNotifiedFIFO(&amp;t-&gt;incomingFifo, msg);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (t-&gt;measurePerf)</span><br><span class="line">         msg-&gt;startProcessingTime=rdtsc_oai();</span><br><span class="line"></span><br><span class="line">            msg-&gt;processingFunc(NotifiedFifoData(msg));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (t-&gt;measurePerf)</span><br><span class="line">        msg-&gt;endProcessingTime=rdtsc_oai();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (msg-&gt;reponseFifo)</span><br><span class="line">            pushNotifiedFIFO(msg-&gt;reponseFifo, msg);</span><br><span class="line">        &#125;         </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>pullTpool<br>  è¿™ä¸ªå‡½æ•°æ˜¯å°†çº¿ç¨‹æ± å“åº”é˜Ÿåˆ—ä¸­æ‹‰å–ä»»åŠ¡.</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  static inline notifiedFIFO_elt_t *pullTpool(notifiedFIFO_t *responseFifo, tpool_t *t) &#123;</span><br><span class="line">notifiedFIFO_elt_t *msg= pullNotifiedFIFO(responseFifo);</span><br><span class="line"><span class="keyword">if</span> (msg == NULL)</span><br><span class="line">  <span class="built_in">return</span> NULL;</span><br><span class="line">AssertFatal(t-&gt;traceFd, <span class="string">&quot;Thread pool used while not initialized&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (t-&gt;measurePerf)</span><br><span class="line">  msg-&gt;returnTime=rdtsc_oai();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (t-&gt;traceFd &gt; 0)</span><br><span class="line">  <span class="keyword">if</span>(write(t-&gt;traceFd, msg, sizeof(*msg)));</span><br><span class="line"></span><br><span class="line"><span class="built_in">return</span> msg;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="Tx-Sync-UE"><a href="#Tx-Sync-UE" class="headerlink" title="Tx(Sync UE)"></a>Tx(Sync UE)</h5><ul>
<li>processSlotTx<br>å¦‚æœsl_mode &#x3D;&#x3D; 2,ä¼šè°ƒç”¨phy_procedures_nrUE_SL_TX</li>
<li>phy_procedures_nrUE_SL_TX(æ—¶éš™æ§åˆ¶æ¥å‘å°„S-SSBå’ŒSCHï¼Œå…·ä½“å¯è§<strong>5gNRSidelink</strong>)<ul>
<li>phy_ssb_slot_allocation_slï¼ˆå‰ææ˜¯sync_ref&#x3D;&#x3D;1ï¼‰<br>  å‘å°„S-SSB</li>
<li>nr-ue-set-slsch(å‰ææ˜¯sync_ref&#x3D;&#x3D;1)<br>  é…ç½®slsch</li>
<li>nr-ue_slsch_tx_procedures(å‰ææ˜¯sync_ref&#x3D;&#x3D;1)<br>  uint32_t sl_bitmap_tx &#x3D; 0x00000;<br>  if(ue-&gt;sync_ref){<br>  sl_bitmap_tx &#x3D; (ue-&gt;is_synchronized_sl &#x3D;&#x3D; 0) ? 0x00001:0x00002;<br>  }<br>  å‘å°„slsch</li>
</ul>
</li>
</ul>
<h5 id="Rx-Nearby-UE"><a href="#Rx-Nearby-UE" class="headerlink" title="Rx(Nearby UE)"></a>Rx(Nearby UE)</h5><ul>
<li>ç¬¬ä¸€æ­¥ï¼Œå…ˆinclude &lt;nr-uesoftmode.h&gt;(é‡Œé¢externäº†nr-ue.cé‡Œçš„å‡½æ•°)</li>
<li>ç¬¬äºŒæ­¥ï¼Œget_optins</li>
<li>init_NR_UE</li>
<li>set_options(åŒ…æ‹¬max_ldpc_iterations, tx_total_gain_dBç­‰ç­‰)</li>
<li>nr_phy_config_request_sl(ä¼ å‚æ¥é…ç½®PHYå±‚çš„UE)<br>é…ç½®nrUE_configï¼ˆç”¨äºå­˜å‚¨é€šè¿‡ FAPI æ¥å£ä¼ é€’ç»™ PHY å±‚çš„é…ç½®ä¿¡æ¯ï¼ˆå¦‚é¢‘ç‡ã€å¸¦å®½ã€SSB é…ç½®ç­‰ï¼‰ã€‚ï¼‰å’Œueï¼Œä¾‹å¦‚é…ç½®nrUE_config-&gt;ssb,<br>  nrUE_config-&gt;carrier_config.sl_frequency<br>  UE-&gt;sync_ref,<br>  UE-&gt;configured<br>  UE-&gt;synchronized</li>
<li>init_nr_ue_varsï¼ˆå…³æ‰MACï¼Œæ— éœ€ç»è¿‡gNBï¼Œå› æ­¤ä¸éœ€è¦ä¼ ç»Ÿçš„MACå±‚å¤„ç†ï¼Œæ¯”å¦‚è°ƒåº¦ã€DCIã€HARQï¼Œåè€Œé€šå¸¸æ˜¯ç›´æ¥ä½¿ç”¨ç‰©ç†å±‚è¿›è¡Œå¹¿æ’­æˆ–ç‚¹å¯¹å¯¹é€šä¿¡ï¼‰</li>
<li>init_openair0</li>
<li>init_NR_UE_threads(nrUE)  <ul>
<li><p>threadCreate</p>
</li>
<li><p>UE_thread_SL(é‡Œé¢æœ‰UE_synchå’ŒprocessSlotRXä¸¤ä¸ªå­çº¿ç¨‹ï¼Œç”±çº¿ç¨‹æ± Tpoolè¿›è¡Œç»´æŠ¤)</p>
</li>
<li><p>processSlotRX</p>
</li>
<li><p>phy_procedures_nrUE_SL_RX<br>è¿™ä¸ªå‡½æ•°ä¸»è¦åˆ¤æ–­ueæ˜¯å¦éœ€è¦æ‰§è¡Œå¯¹rx slotçš„å¤„ç†ï¼Œå…·ä½“å¯è§å¦‚ä¸‹ä»£ç </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œå¯ä»¥é˜²æ­¢<span class="built_in">sync</span> ueæ¥æ‰§è¡Œè¿™ä¸ªæ¥å—å‡½æ•°ï¼Œå¹¶ä¸”ä½¿å¾—nearbyueåªèƒ½åœ¨åŒæ­¥ä¹‹åå°†is_synchronized_sl=1åæ‰ä¼šæ‰§è¡Œ.</span><br><span class="line"><span class="keyword">if</span>(ue-&gt;is_synchronized_sl == 0)</span><br><span class="line">  <span class="built_in">return</span> (0);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>ï¼ˆue-&gt;sync_ref == 0ï¼‰  </span><br><span class="line">uint32_t sl_bitmap_rx = ue-&gt;sync_ref  ? 0x00001 : 0x00002;</span><br><span class="line"><span class="keyword">if</span>(((sl_bitmap_rx = ue-&gt;sync_ref?) &amp; <span class="number">1</span> ) == <span class="number">0</span> )</span><br><span class="line">return(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰¾åˆ°æ­£ç¡®çš„frameå’Œslotåï¼Œä¼šæ‰§è¡Œnr_ue_slsch_rx_procedureså‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä½“å†…ä¼šå…·ä½“å¯¹PSSCHè¿›è¡Œå¤„ç†ï¼ŒåŒ…æ‹¬demappingå’Œdescramblingä»¥åŠdecoding(nr_slsch_decoding)ï¼Œè¿™ä¸ªdocodingåŒ…æ‹¬å¯¹SLSCHå’ŒSCI2çš„è§£ç <br>ä¸ºäº†è¡¨ç¤ºæ¯ä¸€ä¸ªæ”¶åˆ°çš„çš„frameï¼Œæˆ‘ä»¬åœ¨nr_slsch_decodingå‡½æ•°é‡Œé¢LOG_I(frame,slot), beacuse each frame received will go through the process in nr_slsch_decoding, be careful that not each frame received will go through the <strong>validate_rx_str</strong> function, beacuse it should satisfy a prerequirement (destination is matched). </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/// æ­£å¸¸æƒ…å†µä¸‹çš„LOG_I</span><br><span class="line">[NR_PHY]In nr_ue_sl_pssch_rsrp_measurements: </span><br><span class="line">[NR_PHY]SLSCH received ok</span><br><span class="line">[PHY] Frame:..., Slot:...</span><br><span class="line">[NR_PHY] Received your text!...</span><br><span class="line">[PHY] PSSCH <span class="built_in">test</span> ...f</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­SLSCH received okä¸ä¸€å®šæ‰§è¡Œ(it is in nr_ue_sl_postDocode function after polar_decoded_int16 and it has a prerequisited that all segments are done), and these two funcations are all in the <strong>nr_slsch_decoding</strong> function.<br>Received your text is in the <strong>valdiate_rx_str</strong> function, and has a prerequisit that the dest is matched.</p>
<p>openair1&#x2F;SCHED_NR_UE&#x2F;phy_procedures_nr_ue.cä¸­,è°ƒç”¨nr_ue_slsch_rx_proceduresæ¥return ret</p>
<ul>
<li>nr_ue_slsch_rx_procedures(åœ¨openair1&#x2F;PHY&#x2F;NR_UE_TRANSPORT&#x2F;nl_slsch_ue.c)<ul>
<li>nr_slsch_decoding(åœ¨nr_ue_slsch_rx_proceduresä¸­ï¼Œdecodingçš„éƒ¨åˆ†æ˜¯sci2éƒ¨åˆ† <strong>return ret</strong>)<ul>
<li>polar_decoder_int16(åœ¨nr_slsch_decodingå‡½æ•°ä¸­)</li>
<li>LOG_E(NR_PHY, â€œpolar_decoder_int16 failed with ret %d for slot %d\nâ€, decoder_state, nr_slot_rx);</li>
<li>return ret</li>
</ul>
</li>
</ul>
</li>
<li>validate_rx_payload(log(â€œPSSCH testâ€))</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ci-scriptéƒ¨åˆ†"><a href="#ci-scriptéƒ¨åˆ†" class="headerlink" title="ci-scriptéƒ¨åˆ†"></a>ci-scriptéƒ¨åˆ†</h2><h3 id="sl-check-log-py"><a href="#sl-check-log-py" class="headerlink" title="sl_check_log.py"></a>sl_check_log.py</h3><p>æ ¹æ®nearby.logä¸­â€PSSCH testâ€å­—æ®µè¿›è¡Œæ£€æŸ¥ï¼Œå°†â€PSSCH test OK with 1 &#x2F; 2 &#x3D; 0.50â€ä¸­çš„1æ”¾å…¥nb_decoded,å°†2æ”¾å…¥total_rx, ç”±äºæ˜¯forå¾ªç¯ä¸€ç›´æ£€æŸ¥nearby.logï¼Œè€Œä¸”æ¯ä¸ªå¾ªç¯å†…ä¼šç›´æ¥æŠŠintå‹æ•°æ®è¦†ç›–ç»™nb_decoded,â€nb_decoded &#x3D; int(field[-5])â€,å› æ­¤ä¼šæŠŠlogé‡Œçš„æœ€åä¸€æ¡æ•°æ®ä¼ ç»™nb_decodedã€‚åŒæ—¶nb_decoded_listä¹Ÿæ˜¯åªæœ€åä¸€æ¡æ•°æ®çš„listï¼Œä¾‹å¦‚nb_decoded_list&#x3D;[1]ï¼ŒåŒç†total_rx_list&#x3D;[103]</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hechenyi.github.io/2025/04/22/MATLAB%E6%B3%A2%E5%BD%A2%E7%94%9F%E6%88%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/22/MATLAB%E6%B3%A2%E5%BD%A2%E7%94%9F%E6%88%90/" class="post-title-link" itemprop="url">MATLABæ³¢å½¢ç”Ÿæˆ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-22 03:14:52" itemprop="dateCreated datePublished" datetime="2025-04-22T03:14:52+08:00">2025-04-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-04-24 18:56:12" itemprop="dateModified" datetime="2025-04-24T18:56:12+08:00">2025-04-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MATLAB/" itemprop="url" rel="index"><span itemprop="name">MATLAB</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
          <h2 id="Wireless-Waveform-Generator"><a href="#Wireless-Waveform-Generator" class="headerlink" title="Wireless Waveform Generator"></a>Wireless Waveform Generator</h2><h3 id="OFDM-Waveform-Configuration"><a href="#OFDM-Waveform-Configuration" class="headerlink" title="OFDM Waveform Configuration"></a>OFDM Waveform Configuration</h3><p>éœ€è¦é…ç½®FFT Lengthï¼ŒGuard band subcarrierï¼ŒCyclic prefix lengthsï¼ŒOFDM symbolsï¼ŒTransmit antennasï¼Œå­è½½æ³¢é—´è·ç­‰å‚æ•°ï¼Œå¦å¤–å¯ä»¥é…ç½®Pilotï¼Œå¹¶å¯ä»¥é€‰å®šPilotåœ¨å­è½½æ³¢ä¸­çš„ä½ç½®å·²ç»å®ƒçš„è¾“å…¥çŸ©é˜µã€‚å¦å¤–OFDMéƒ½æ˜¯å’ŒQAMé…åˆä½¿ç”¨ï¼Œå¯¹äºQAMçš„é…ç½®ï¼Œå¯ä»¥è°ƒæ•´å®ƒçš„Modulation orderï¼ŒSymbol mappingï¼Œbit sourceç­‰å‚æ•°</p>
<img src="/images/OFDMGenerator.png">
ä¸‹é¢æ˜¯å¯¼å‡ºçš„matlabä»£ç 

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">% Generated by MATLAB(R) 24.2 (R2024b) and Communications Toolbox 24.2 (R2024b).</span><br><span class="line">% Generated on: 21-Apr-2025 20:59:07</span><br><span class="line"></span><br><span class="line">%% Generating OFDM waveform</span><br><span class="line">% OFDM configuration</span><br><span class="line">ofdmMod = comm.OFDMModulator(<span class="string">&#x27;FFTLength&#x27;</span>, 128, ...</span><br><span class="line">    <span class="string">&#x27;NumGuardBandCarriers&#x27;</span>, [6;5], ...</span><br><span class="line">    <span class="string">&#x27;InsertDCNull&#x27;</span>, <span class="literal">false</span>, ...</span><br><span class="line">    <span class="string">&#x27;CyclicPrefixLength&#x27;</span>, 16, ...</span><br><span class="line">    <span class="string">&#x27;Windowing&#x27;</span>, <span class="literal">false</span>, ...</span><br><span class="line">    <span class="string">&#x27;OversamplingFactor&#x27;</span>, 1, ...</span><br><span class="line">    <span class="string">&#x27;NumSymbols&#x27;</span>, 19, ...</span><br><span class="line">    <span class="string">&#x27;NumTransmitAntennas&#x27;</span>, 1, ...</span><br><span class="line">    <span class="string">&#x27;PilotInputPort&#x27;</span>, <span class="literal">true</span>, ...</span><br><span class="line">    <span class="string">&#x27;PilotCarrierIndices&#x27;</span>, [12;26;40;54]);</span><br><span class="line"></span><br><span class="line">scs = 1000000;</span><br><span class="line">M = 16; 	 % Modulation order</span><br><span class="line">% input bit <span class="built_in">source</span>:</span><br><span class="line">pn = comm.PNSequence(<span class="string">&#x27;Polynomial&#x27;</span>, <span class="string">&#x27;x9+x5+1&#x27;</span>, <span class="string">&#x27;InitialConditions&#x27;</span>, [zeros(1, 8) 1]);</span><br><span class="line">pn.SamplesPerFrame = 8588;</span><br><span class="line"><span class="keyword">in</span> = [pn()];</span><br><span class="line"></span><br><span class="line">dataInput = qammod(<span class="keyword">in</span>, M, <span class="string">&#x27;bin&#x27;</span>, <span class="string">&#x27;InputType&#x27;</span>, <span class="string">&#x27;bit&#x27;</span>, <span class="string">&#x27;UnitAveragePower&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">ofdmInfo = info(ofdmMod);</span><br><span class="line">ofdmSize = ofdmInfo.DataInputSize;</span><br><span class="line">dataInput = reshape(dataInput, ofdmSize);</span><br><span class="line"></span><br><span class="line">% Generation</span><br><span class="line">pilotInput = ones(4, 19, 1);</span><br><span class="line">waveform = ofdmMod(dataInput, pilotInput);</span><br><span class="line"></span><br><span class="line">Fs = ofdmMod.FFTLength * scs * ofdmMod.OversamplingFactor; 								 % Specify the sample rate of the waveform <span class="keyword">in</span> Hz</span><br><span class="line"></span><br><span class="line">%% Visualize</span><br><span class="line">% Spectrum Analyzer</span><br><span class="line">spectrum = spectrumAnalyzer(<span class="string">&#x27;SampleRate&#x27;</span>, Fs);</span><br><span class="line">spectrum(waveform);</span><br><span class="line">release(spectrum);</span><br><span class="line"></span><br><span class="line">% Constellation Diagram</span><br><span class="line">constel = comm.ConstellationDiagram(<span class="string">&#x27;ColorFading&#x27;</span>, <span class="literal">true</span>, ...</span><br><span class="line">    <span class="string">&#x27;ShowTrajectory&#x27;</span>, 0, ...</span><br><span class="line">    <span class="string">&#x27;ShowReferenceConstellation&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line">constel(dataInput(:));</span><br><span class="line">release(constel);</span><br><span class="line"></span><br><span class="line">% OFDM Subcarrier Mapping</span><br><span class="line">showResourceMapping(ofdmMod);</span><br></pre></td></tr></table></figure>

<h3 id="5gNRUplink"><a href="#5gNRUplink" class="headerlink" title="5gNRUplink"></a>5gNRUplink</h3><p>éœ€è¦é…ç½®Mainï¼ˆSCS Carriersï¼Œ Bandwdith Partsï¼Œ Channel Bandwidthï¼ŒSubFramesç­‰ç­‰ï¼‰ï¼ŒPUSCHï¼ŒPUCCHå’ŒSRS<br><img src="/images/5gNRUplinkGenerator.png"></p>
<p>è¿™é‡Œä¸éœ€è¦åƒOFDM Generatorä¸€æ ·é…ç½®FFTï¼Œå› ä¸ºå­è½½æ³¢æ•°ç›®å¯ä»¥æ¨ç®—å‡ºæ¥ã€‚<br>PUSCHåœ¨é…ç½®æ—¶éœ€è¦æ³¨æ„symbol lengthï¼Œç”¨æ¥è¡¨ç¤ºåœ¨ä¸€ä¸ªslotå æ®çš„å¤§å°ï¼Œå¦‚æœsymbol lengthæ˜¯7ï¼Œé‚£ä¹ˆåªæœ‰ä¸€ä¸ªslotçš„ä¸€åŠï¼Œå› æ­¤Resource Gridå¦‚ä¸‹<br><img src="/images/ResourceGrid_1.png"><br>è¿˜å¯ä»¥æ”¹å˜SlotAllocationå’ŒPeriodï¼Œç”¨æ¥æ”¹å˜å æ®çš„slotåœ¨æ‰€æœ‰slotä¸­çš„ä½ç½®<br><img src="/images/ResourceGrid_2.png"><br>å¯¹äºPUCCHï¼Œå…¶å¯ä»¥å’ŒPUSCHåœ¨æ—¶åŸŸï¼ˆä¹Ÿå°±æ˜¯slotï¼‰æœ‰é‡åˆï¼Œä½†æ˜¯ä¸èƒ½åœ¨RBä¸Šæœ‰é‡åˆï¼Œè¿™é‡Œä¹Ÿå¯ä»¥ä½“ç°OFDMçš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯è¯´é¢‘ç‡æ˜¯å¤ç”¨çš„</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line">% Generated by MATLAB(R) 24.2 (R2024b) and 5G Toolbox 24.2 (R2024b).</span><br><span class="line">% Generated on: 21-Apr-2025 22:26:35</span><br><span class="line"></span><br><span class="line">%% Generating Uplink waveform</span><br><span class="line">% Uplink configuration</span><br><span class="line">cfgUL = nrULCarrierConfig;</span><br><span class="line">cfgUL.Label = <span class="string">&#x27;Carrier1&#x27;</span>;</span><br><span class="line">cfgUL.FrequencyRange = <span class="string">&#x27;FR1&#x27;</span>;</span><br><span class="line">cfgUL.ChannelBandwidth = 60;</span><br><span class="line">cfgUL.NCellID = 1;</span><br><span class="line">cfgUL.NumSubframes = 1;</span><br><span class="line">cfgUL.InitialNSubframe = 0;</span><br><span class="line">cfgUL.WindowingPercent = 0;</span><br><span class="line">cfgUL.SampleRate = [];</span><br><span class="line">cfgUL.CarrierFrequency = 0;</span><br><span class="line"></span><br><span class="line">%% SCS specific carriers</span><br><span class="line">scscarrier = nrSCSCarrierConfig;</span><br><span class="line">scscarrier.SubcarrierSpacing = 15;</span><br><span class="line">scscarrier.NSizeGrid = 270;</span><br><span class="line">scscarrier.NStartGrid = 3;</span><br><span class="line"></span><br><span class="line">cfgUL.SCSCarriers = &#123;scscarrier&#125;;</span><br><span class="line"></span><br><span class="line">%% Bandwidth Parts</span><br><span class="line">bwp = nrWavegenBWPConfig;</span><br><span class="line">bwp.BandwidthPartID = 1;</span><br><span class="line">bwp.Label = <span class="string">&#x27;BWP1&#x27;</span>;</span><br><span class="line">bwp.SubcarrierSpacing = 15;</span><br><span class="line">bwp.CyclicPrefix = <span class="string">&#x27;normal&#x27;</span>;</span><br><span class="line">bwp.NSizeBWP = 270;</span><br><span class="line">bwp.NStartBWP = 3;</span><br><span class="line"></span><br><span class="line">cfgUL.BandwidthParts = &#123;bwp&#125;;</span><br><span class="line"></span><br><span class="line">%% Intracell Guard Bands Configuration</span><br><span class="line">gb = nrIntraCellGuardBandsConfig;</span><br><span class="line">gb.GuardBandSize = zeros(0,2);</span><br><span class="line">gb.SubcarrierSpacing = 15;</span><br><span class="line"></span><br><span class="line">cfgUL.IntraCellGuardBands = &#123;gb&#125;;</span><br><span class="line"></span><br><span class="line">%% PUSCH Instances Configuration</span><br><span class="line">pusch = nrWavegenPUSCHConfig;</span><br><span class="line">pusch.Enable = <span class="literal">true</span>;</span><br><span class="line">pusch.Label = <span class="string">&#x27;PUSCH1&#x27;</span>;</span><br><span class="line">pusch.Power = 0;</span><br><span class="line">pusch.BandwidthPartID = 1;</span><br><span class="line">pusch.Modulation = <span class="string">&#x27;64QAM&#x27;</span>;</span><br><span class="line">pusch.NumLayers = 1;</span><br><span class="line">pusch.MappingType = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">pusch.SymbolAllocation = [0 4];</span><br><span class="line">pusch.SlotAllocation = 0:8;</span><br><span class="line">pusch.Period = 10;</span><br><span class="line">pusch.PRBSet = 0:269;</span><br><span class="line">pusch.TransformPrecoding = <span class="literal">false</span>;</span><br><span class="line">pusch.TransmissionScheme = <span class="string">&#x27;nonCodebook&#x27;</span>;</span><br><span class="line">pusch.NumAntennaPorts = 1;</span><br><span class="line">pusch.TPMI = 0;</span><br><span class="line">pusch.CodebookType = <span class="string">&#x27;codebook1_ng1n4n1&#x27;</span>;</span><br><span class="line">pusch.FrequencyHopping = <span class="string">&#x27;neither&#x27;</span>;</span><br><span class="line">pusch.SecondHopStartPRB = 1;</span><br><span class="line">pusch.Interlacing = <span class="literal">false</span>;</span><br><span class="line">pusch.RBSetIndex = 0;</span><br><span class="line">pusch.InterlaceIndex = 0;</span><br><span class="line">pusch.NID = [];</span><br><span class="line">pusch.RNTI = 1;</span><br><span class="line">pusch.NRAPID = [];</span><br><span class="line">pusch.Coding = <span class="literal">true</span>;</span><br><span class="line">pusch.TargetCodeRate = 0.513671875;</span><br><span class="line">pusch.XOverhead = 0;</span><br><span class="line">pusch.LimitedBufferRateMatching = <span class="literal">false</span>;</span><br><span class="line">pusch.MaxNumLayers = 8;</span><br><span class="line">pusch.MCSTable = <span class="string">&#x27;qam256&#x27;</span>;</span><br><span class="line">pusch.RVSequence = [0 2 3 1];</span><br><span class="line">pusch.DataSource = <span class="string">&#x27;PN9-ITU&#x27;</span>;</span><br><span class="line">pusch.EnableACK = <span class="literal">false</span>;</span><br><span class="line">pusch.NumACKBits = 10;</span><br><span class="line">pusch.BetaOffsetACK = 20;</span><br><span class="line">pusch.DataSourceACK = <span class="string">&#x27;PN9-ITU&#x27;</span>;</span><br><span class="line">pusch.EnableCSI1 = <span class="literal">false</span>;</span><br><span class="line">pusch.NumCSI1Bits = 10;</span><br><span class="line">pusch.BetaOffsetCSI1 = 6.25;</span><br><span class="line">pusch.DataSourceCSI1 = <span class="string">&#x27;PN9-ITU&#x27;</span>;</span><br><span class="line">pusch.EnableCSI2 = <span class="literal">false</span>;</span><br><span class="line">pusch.NumCSI2Bits = 10;</span><br><span class="line">pusch.BetaOffsetCSI2 = 6.25;</span><br><span class="line">pusch.DataSourceCSI2 = <span class="string">&#x27;PN9-ITU&#x27;</span>;</span><br><span class="line">pusch.EnableCGUCI = <span class="literal">false</span>;</span><br><span class="line">pusch.NumCGUCIBits = 7;</span><br><span class="line">pusch.BetaOffsetCGUCI = 20;</span><br><span class="line">pusch.DataSourceCGUCI = <span class="string">&#x27;PN9-ITU&#x27;</span>;</span><br><span class="line">pusch.EnableULSCH = <span class="literal">true</span>;</span><br><span class="line">pusch.UCIScaling = 1;</span><br><span class="line">pusch.DMRSPower = 0;</span><br><span class="line">pusch.EnablePTRS = <span class="literal">false</span>;</span><br><span class="line">pusch.PTRSPower = 0;</span><br><span class="line"></span><br><span class="line">% PUSCH DM-RS</span><br><span class="line">puschDMRS = nrPUSCHDMRSConfig;</span><br><span class="line">puschDMRS.DMRSConfigurationType = 1;</span><br><span class="line">puschDMRS.DMRSTypeAPosition = 2;</span><br><span class="line">puschDMRS.DMRSAdditionalPosition = 0;</span><br><span class="line">puschDMRS.DMRSLength = 1;</span><br><span class="line">puschDMRS.CustomSymbolSet = [];</span><br><span class="line">puschDMRS.DMRSPortSet = [];</span><br><span class="line">puschDMRS.NIDNSCID = [];</span><br><span class="line">puschDMRS.NSCID = 0;</span><br><span class="line">puschDMRS.GroupHopping = <span class="literal">false</span>;</span><br><span class="line">puschDMRS.SequenceHopping = <span class="literal">false</span>;</span><br><span class="line">puschDMRS.NRSID = [];</span><br><span class="line">puschDMRS.NumCDMGroupsWithoutData = 2;</span><br><span class="line">puschDMRS.DMRSUplinkR16 = <span class="literal">false</span>;</span><br><span class="line">puschDMRS.DMRSUplinkTransformPrecodingR16 = <span class="literal">false</span>;</span><br><span class="line">puschDMRS.DMRSEnhancedR18 = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">pusch.DMRS = puschDMRS;</span><br><span class="line"></span><br><span class="line">% PUSCH PT-RS</span><br><span class="line">puschPTRS = nrPUSCHPTRSConfig;</span><br><span class="line">puschPTRS.TimeDensity = 1;</span><br><span class="line">puschPTRS.FrequencyDensity = 2;</span><br><span class="line">puschPTRS.NumPTRSSamples = 2;</span><br><span class="line">puschPTRS.NumPTRSGroups = 2;</span><br><span class="line">puschPTRS.REOffset = <span class="string">&#x27;00&#x27;</span>;</span><br><span class="line">puschPTRS.PTRSPortSet = [];</span><br><span class="line">puschPTRS.NID = [];</span><br><span class="line"></span><br><span class="line">pusch.PTRS = puschPTRS;</span><br><span class="line"></span><br><span class="line">cfgUL.PUSCH = &#123;pusch&#125;;</span><br><span class="line"></span><br><span class="line">%% PUCCH Instances Configuration</span><br><span class="line">pucch = nrWavegenPUCCH0Config;</span><br><span class="line">pucch.Enable = <span class="literal">false</span>;</span><br><span class="line">pucch.Label = <span class="string">&#x27;PUCCH1&#x27;</span>;</span><br><span class="line">pucch.Power = 0;</span><br><span class="line">pucch.BandwidthPartID = 1;</span><br><span class="line">pucch.SymbolAllocation = [0 2];</span><br><span class="line">pucch.SlotAllocation = 0:7;</span><br><span class="line">pucch.Period = 10;</span><br><span class="line">pucch.PRBSet = 12:30;</span><br><span class="line">pucch.FrequencyHopping = <span class="string">&#x27;neither&#x27;</span>;</span><br><span class="line">pucch.SecondHopStartPRB = 1;</span><br><span class="line">pucch.Interlacing = <span class="literal">false</span>;</span><br><span class="line">pucch.RBSetIndex = 0;</span><br><span class="line">pucch.InterlaceIndex = 0;</span><br><span class="line">pucch.GroupHopping = <span class="string">&#x27;neither&#x27;</span>;</span><br><span class="line">pucch.HoppingID = [];</span><br><span class="line">pucch.InitialCyclicShift = 0;</span><br><span class="line">pucch.NumUCIBits = 1;</span><br><span class="line">pucch.DataSourceUCI = <span class="string">&#x27;PN9-ITU&#x27;</span>;</span><br><span class="line">pucch.DataSourceSR = 0;</span><br><span class="line"></span><br><span class="line">cfgUL.PUCCH = &#123;pucch&#125;;</span><br><span class="line"></span><br><span class="line">%% SRS Instances Configuration</span><br><span class="line">srs = nrWavegenSRSConfig;</span><br><span class="line">srs.Enable = <span class="literal">false</span>;</span><br><span class="line">srs.Label = <span class="string">&#x27;SRS1&#x27;</span>;</span><br><span class="line">srs.Power = 0;</span><br><span class="line">srs.BandwidthPartID = 1;</span><br><span class="line">srs.NumSRSPorts = 1;</span><br><span class="line">srs.SymbolStart = 13;</span><br><span class="line">srs.NumSRSSymbols = 1;</span><br><span class="line">srs.SlotAllocation = 0:9;</span><br><span class="line">srs.Period = 10;</span><br><span class="line">srs.FrequencyStart = 0;</span><br><span class="line">srs.NRRC = 0;</span><br><span class="line">srs.CSRS = 0;</span><br><span class="line">srs.BSRS = 0;</span><br><span class="line">srs.BHop = 0;</span><br><span class="line">srs.Repetition = 1;</span><br><span class="line">srs.KTC = 2;</span><br><span class="line">srs.KBarTC = 0;</span><br><span class="line">srs.FrequencyScalingFactor = 1;</span><br><span class="line">srs.StartRBIndex = 0;</span><br><span class="line">srs.EnableStartRBHopping = <span class="literal">false</span>;</span><br><span class="line">srs.CyclicShift = 0;</span><br><span class="line">srs.GroupSeqHopping = <span class="string">&#x27;neither&#x27;</span>;</span><br><span class="line">srs.NSRSID = 0;</span><br><span class="line">srs.SRSPositioning = <span class="literal">false</span>;</span><br><span class="line">srs.EnableEightPortTDM = <span class="literal">false</span>;</span><br><span class="line">srs.CyclicShiftHopping = <span class="literal">false</span>;</span><br><span class="line">srs.CyclicShiftHoppingID = 0;</span><br><span class="line">srs.CyclicShiftHoppingSubset = [];</span><br><span class="line">srs.HoppingFinerGranularity = <span class="literal">false</span>;</span><br><span class="line">srs.CombOffsetHopping = <span class="literal">false</span>;</span><br><span class="line">srs.CombOffsetHoppingID = 0;</span><br><span class="line">srs.CombOffsetHoppingSubset = [];</span><br><span class="line">srs.HoppingWithRepetition = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">cfgUL.SRS = &#123;srs&#125;;</span><br><span class="line"></span><br><span class="line">% Generation</span><br><span class="line">[waveform,info] = nrWaveformGenerator(cfgUL);</span><br><span class="line"></span><br><span class="line">Fs = info.ResourceGrids(1).Info.SampleRate; 								 % Specify the sample rate of the waveform <span class="keyword">in</span> Hz</span><br><span class="line"></span><br><span class="line">%% Visualize</span><br><span class="line">% Spectrum Analyzer</span><br><span class="line">spectrum = spectrumAnalyzer(<span class="string">&#x27;SampleRate&#x27;</span>, Fs);</span><br><span class="line">spectrum(waveform);</span><br><span class="line">release(spectrum);</span><br></pre></td></tr></table></figure>

<p>æƒ³ä½ äº†ï¼Œè€è”¡</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hechenyi.github.io/2025/04/21/5gNRUplink/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/21/5gNRUplink/" class="post-title-link" itemprop="url">5gNRUplink</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-21 20:50:40" itemprop="dateCreated datePublished" datetime="2025-04-21T20:50:40+08:00">2025-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-04-24 18:57:30" itemprop="dateModified" datetime="2025-04-24T18:57:30+08:00">2025-04-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/5G/" itemprop="url" rel="index"><span itemprop="name">5G</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
          <h2 id="Basic-discription"><a href="#Basic-discription" class="headerlink" title="Basic discription"></a>Basic discription</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openExample(<span class="string">&#x27;5g/NRUplinkWaveformGenerationExample&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>This example shows how to configure and generate a 5G NR uplink vector waveform with physical uplink shared channel (PUSCH) and <strong>sounding reference signal</strong>(SRS).</p>
<ul>
<li>PUSCH and its assoicated demodulation reference signal (DM-RS) and phase-tracking reference signal (PT-RS)  </li>
<li>SRS</li>
</ul>
<h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><ul>
<li>åˆå§‹åŒ–nrULCarrierConfigå¹¶é…ç½®åŸºæœ¬å‚æ•°</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">waveconfig = nrULCarrierConfig;</span><br><span class="line">waveconfig.NumSubframes = 10;</span><br><span class="line">waveconfig.FrequencyRange = <span class="string">&#x27;FR1&#x27;</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>é…ç½®scs</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scscarriers = &#123;nrSCSCarrierConfig, nrSCSCarrierConfig&#125;;</span><br><span class="line">scscarriers&#123;1&#125;.SubcarrierSpacing = 15;</span><br><span class="line">scscarriers&#123;1&#125;.NSizeGrid = 216;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>é…ç½®BWP</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bwp&#123;1&#125;.SubcarrierSpacing = 15;</span><br><span class="line">bwp&#123;1&#125;.CyclicPrefix = <span class="string">&#x27;Normal&#x27;</span>;</span><br><span class="line">bwp&#123;1&#125;.NSizeBWP = 25;   % Size of BWP <span class="keyword">in</span> PRBs</span><br><span class="line">bwp&#123;1&#125;.NStartBWP = 10;  % Position of BWP, relateive to point A.</span><br></pre></td></tr></table></figure>
<ul>
<li>é…ç½®PUSCH</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">pusch = &#123;nrWavegenPUSCHConfig&#125;;</span><br><span class="line">pusch&#123;1&#125;.Coding = 1;    % å¯ç”¨UL-SCHçš„ä¿¡é“ç¼–ç (LDPCç¼–ç )</span><br><span class="line">pusch&#123;1&#125;.NID    = 1;    % Scramblingï¼ˆæ‰°ç ï¼‰æ‰€ç”¨çš„NIDï¼Œç¡®ä¿ä¸åŒç”¨æˆ·çš„ä¸Šè¡Œæ•°æ®åœ¨è§£ç æ—¶ä¸ä¼šæ··æ·†</span><br><span class="line">pusch&#123;1&#125;.TransformPrecoding = <span class="literal">false</span>;    % ä½¿ç”¨CP-OFDMï¼ˆDFTåªé€‚ç”¨äºæŸäº›ä½é¢‘åœºæ™¯ï¼‰</span><br><span class="line">pusch&#123;1&#125;.Modulation = <span class="string">&#x27;QPSK&#x27;</span>;</span><br><span class="line">pusch&#123;1&#125;.NumLayers  = 2;</span><br><span class="line">pusch&#123;1&#125;.NumAntennaPorts    = 4;</span><br><span class="line">pusch&#123;1&#125;.DataSource = <span class="string">&#x27;PN9&#x27;</span> % Channel data <span class="built_in">source</span></span><br><span class="line">pusch&#123;1&#125;.SymbolAllocation   = [0 14];   % è¯´æ˜ä¸€ä¸ªslotæœ‰14ä¸ªOFDM symbols</span><br><span class="line">pusch&#123;1&#125;.SlotAllocation = [0 1];        % è¯´æ˜ä¸€ä¸ªpuschå ä¸¤ä¸ªSlot</span><br><span class="line">pusch&#123;1&#125;.period         = 5;            % è¯´æ˜æ¯5ä¸ªslotä¼šé‡å¤ä¸€æ¬¡PUSCHåˆ†é…ï¼Œç¬¬0å‘¨æœŸï¼šslot 0 å’Œ slot 1ï¼Œç¬¬1å‘¨æœŸï¼š slot 5 å’Œ slot 6</span><br><span class="line">pusch&#123;1&#125;.PRBSet         = 0:10          % è¯´æ˜å ç”¨PRBæ•°ç›®ï¼Œä»è€Œè¯´æ˜å¸¦å®½å¤§å°</span><br><span class="line">% DM-RS configuration</span><br><span class="line">pusch&#123;1&#125;.DMRSPower      = 0;</span><br><span class="line">pusch&#123;1&#125;.DMRS.DMRSLength    = 1;</span><br><span class="line">...</span><br><span class="line">pusch&#123;1&#125;.DMRS.NSCID         = 0;</span><br><span class="line">% PT-RS configuration</span><br><span class="line">pusch&#123;1&#125;.EnablePTRS =   0;</span><br><span class="line">pusch&#123;1&#125;.PTRSPower  =   0;</span><br><span class="line">pusch&#123;1&#125;.PTRS.TimeDensity   =   1;</span><br><span class="line">pusch&#123;1&#125;.PTRS.FrequencyDensity   =   2;</span><br><span class="line">pusch&#123;1&#125;.PTRS.NumPTRSSamples =   2;</span><br><span class="line">pusch&#123;1&#125;.PTRS.PTRSPortSet   =   0;</span><br><span class="line">pusch&#123;1&#125;.PTRS.NID   =   0;</span><br><span class="line">% UCI(Uplink Control Information)</span><br><span class="line">pusch&#123;1&#125;.EnableACK  =   <span class="literal">true</span>;   % Enable or <span class="built_in">disable</span> HARQ-ACK</span><br><span class="line">pusch&#123;1&#125;.NumACKBits =   5</span><br><span class="line">pusch&#123;1&#125;.BetaOffsetCSI1 = 2     % Power <span class="built_in">factor</span> of CSI part 1</span><br><span class="line">pusch&#123;1&#125;.DataSourceCSI1 = <span class="string">&#x27;PN9&#x27;</span> % CSI part 1 data <span class="built_in">source</span></span><br><span class="line">pusch&#123;1&#125;.DataSourceACK  = <span class="string">&#x27;PN9&#x27;</span> % HARQ-ACK data <span class="built_in">source</span></span><br></pre></td></tr></table></figure>
<ul>
<li>é…ç½®SRS<br>Specify SRS(sounding reference signal)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">srs&#123;1&#125;.NumSRSPorts  =   1;  % Number of SRS ports</span><br><span class="line">srs&#123;1&#125;.NumSRSSymbols =  4;  % Number of SRS slor</span><br><span class="line">srs&#123;1&#125;.SymbolStart  =   10; % Time-domain positin of the SRS <span class="keyword">in</span> the slot</span><br><span class="line">srs&#123;1&#125;.FrequencyStart=  0;  % Frequency position of the SRS <span class="keyword">in</span> BWP <span class="keyword">in</span> RBs</span><br><span class="line">srs&#123;1&#125;.Period   =   5       % Allocation period <span class="keyword">in</span> slots</span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Waveform Generation<br>Assign all the channel and signal parameters to the main carrier configuration object(nrULCarrierConfig), then generate and plot the waveform.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">waveconfig.SCSCarrier   =   scscarriers;</span><br><span class="line">waveconfig.BandwidthParts   =   bwp;</span><br><span class="line">waveconfig.PUSCH            =   pusch;</span><br><span class="line">waveconfig.SRS              =   srs;</span><br></pre></td></tr></table></figure>

<h2 id="æ¦‚å¿µå­¦ä¹ "><a href="#æ¦‚å¿µå­¦ä¹ " class="headerlink" title="æ¦‚å¿µå­¦ä¹ "></a>æ¦‚å¿µå­¦ä¹ </h2><h3 id="CSI"><a href="#CSI" class="headerlink" title="CSI"></a>CSI</h3><p>CSIä¿¡é“çŠ¶æ€çŸ©é˜µæ˜¯ç”±UEé€šè¿‡Uplinkå‘å°„ç»™Basestationï¼ŒCSIåŒ…å«CSI1å’ŒCSI2</p>
<h4 id="CSI1"><a href="#CSI1" class="headerlink" title="CSI1"></a>CSI1</h4><p>ä¸»è¦ä¼ è¾“çš„æ˜¯é¢„å®šä¹‰çš„ã€ç»“æ„åŒ–çš„CSIä¿¡æ¯ï¼Œç”¨äºåé¦ˆè¯¸å¦‚ï¼š</p>
<ul>
<li>PMIï¼ˆPrecoding Matrix Indicatorï¼‰</li>
<li>RIï¼ˆRank Indicatorï¼‰</li>
<li>LIï¼ˆLayer Indicatorï¼‰</li>
<li>Wideband CQIï¼ˆChannel Quality Indicatorï¼‰</li>
</ul>
<h4 id="CSI2"><a href="#CSI2" class="headerlink" title="CSI2"></a>CSI2</h4><p>ä¼ è¾“çš„æ˜¯æ›´ç²¾ç»†æˆ–æ›´çµæ´»çš„CSIä¿¡æ¯ï¼Œæ¯”å¦‚</p>
<ul>
<li>Subband CQI</li>
<li>CRIsï¼ˆCodebook Reference Indicesï¼‰</li>
<li>æ›´å¤æ‚çš„PMIè¡¨è¾¾</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hechenyi.github.io/2025/04/21/5gNRDownlink/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/21/5gNRDownlink/" class="post-title-link" itemprop="url">5gNRDownLink</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-21 20:49:12" itemprop="dateCreated datePublished" datetime="2025-04-21T20:49:12+08:00">2025-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-04-28 02:50:33" itemprop="dateModified" datetime="2025-04-28T02:50:33+08:00">2025-04-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/5G/" itemprop="url" rel="index"><span itemprop="name">5G</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
          <h2 id="Basic-description"><a href="#Basic-description" class="headerlink" title="Basic description"></a>Basic description</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openExample(<span class="string">&#x27;5g/NRDownlinkWaveformGenerationExample&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>This example shows how to configure and generate a <strong>5G NR downlink</strong> vector.<br>The generated waveform contains these channels and signals</p>
<ul>
<li>PDSCH and its associated DM-RS and PT-RS</li>
<li>PDCCH and its associated DM-RS</li>
<li>PBCH and its associated DM-RS</li>
<li>PSS and SSS</li>
<li>CSI-RS</li>
</ul>
<h3 id="SCS-specific-carriers"><a href="#SCS-specific-carriers" class="headerlink" title="SCS specific carriers"></a>SCS specific carriers</h3><ul>
<li>SubcarrierSpacing</li>
<li>NsizeGrid</li>
<li>StartGrid<br>NsizeGridé»˜è®¤æ˜¯52ï¼Œè¯´æ˜æ•´ä¸ªå¸¦å®½ä¸­æœ‰52ä¸ªresource blocksï¼Œæ¯ä¸ªresource blockæœ‰12ä¸ªå­è½½æ³¢</li>
</ul>
<h3 id="SS-burst"><a href="#SS-burst" class="headerlink" title="SS burst"></a>SS burst</h3><h4 id="è¡¥å……è¯´æ˜"><a href="#è¡¥å……è¯´æ˜" class="headerlink" title="è¡¥å……è¯´æ˜"></a>è¡¥å……è¯´æ˜</h4><p>SSB(SS&#x2F;PBCH Block)æ˜¯ä¸€ä¸ªåŒ…å«PSS+SSS+PBCHçš„å°ç»“æ„ï¼Œå ç”¨240ä¸ªå­è½½æ³¢ï¼ˆ20PRBsï¼‰ã€4ä¸ªOFDMç¬¦å·<br>SS Burstæ˜¯ä¸€ä¸ªæ—¶é—´çª—å£ï¼ˆæœ€å¤š5msï¼‰ï¼Œé‡Œé¢å¯ä»¥å‘å¤šä¸ªSSBï¼ˆæœ€å¤š64ä¸ªï¼Œå–å†³äºé…ç½®ï¼‰</p>
<h4 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h4><ul>
<li>Enable</li>
<li>Power<br>ç”¨æ¥è®¾ç½®SSBçš„ç›¸å¯¹åŠŸç‡ï¼Œä¹Ÿå°±æ˜¯å’Œæ•´ä¸ªæ³¢å½¢ä¸­å…¶ä»–éƒ¨åˆ†çš„åŠŸç‡ä¸€æ ·ï¼Œä¸åšæ”¾å¤§æˆ–è¡°å‡ã€‚</li>
<li>BlockPattern<br>ä¾‹å¦‚Case Bï¼ˆ30KHzï¼‰è¡¨ç¤ºsubcarrier spacing</li>
<li>TransmittedBlocks<br>è¯´æ˜è¿™5mså†…å‘å°„çš„SSBä¸ªæ•°</li>
<li>Period<br>å‘å°„SS Burstçš„å‘¨æœŸ</li>
<li>NCRBSSB</li>
</ul>
<h2 id="BWPs"><a href="#BWPs" class="headerlink" title="BWPs"></a>BWPs</h2><p>A BWP is formed by a set of contiguous resources sharing a numerology on a given SCS carrier.<br>ä¾‹å¦‚å¦‚æœåœ¨å‰é¢å·²ç»å®šä¹‰å¥½äº†SCS carrierï¼Œä¾‹å¦‚RBæ•°é‡ï¼Œé—´è·ï¼Œé‚£ä¹ˆåœ¨æ„å»ºBWPçš„æ—¶å€™å¯ä»¥ç”¨åˆ°ä¹‹å‰æ„å»ºå¥½çš„SCSï¼Œå› æ­¤æ˜¯share numerology</p>
<ul>
<li>BandwidthPartID</li>
<li>Label</li>
<li>SubcarrierSpacing</li>
<li>CyclicPrefix</li>
<li>NSizeBWP<br>è¡¨ç¤ºè¿™ä¸ªBWPå æ®å¤šå°‘ä¸ªRB</li>
<li>NStartBWP</li>
</ul>
<h2 id="PDCCH"><a href="#PDCCH" class="headerlink" title="PDCCH"></a>PDCCH</h2><p>Speicify the set of PDSCH transmission instances in the waveform by using a cell array. </p>
<ul>
<li><p>Enable</p>
</li>
<li><p>Label</p>
</li>
<li><p>BandwidthPartID<br>è¿™ä¸ªä¼šå’Œå‰é¢å®šä¹‰çš„BWPè¿›è¡ŒåŒ¹é…</p>
</li>
<li><p>Power</p>
</li>
<li><p>Coding<br>Enable the DL-SCH transport channel coding</p>
</li>
<li><p>DataSource</p>
</li>
<li><p>Modulation</p>
</li>
<li><p>NumLayers  </p>
<ul>
<li>NumLayers &#x3D; 1,å°±ç›¸å½“äºä¸€ä¸ªæ•°æ®æµï¼ˆå•å±‚MIMOï¼‰ï¼Œä¹Ÿå«SISO</li>
<li>NumLayers &#x3D; 2ï¼ŒåŸºç«™å¯ä»¥åŒæ—¶å‘ä¸¤æ¡ç‹¬ç«‹çš„æ•°æ®æµåˆ°UEï¼ŒUEå¾äºšè‡³å°‘æœ‰å››ä¸ªå¤©çº¿æ¥æ¥æ”¶ï¼Œè¿™å±äº2x2 MIMO</li>
<li>NumLayers &#x3D; 4ï¼Œä¾‹å¦‚4x4åˆ°MIMO</li>
</ul>
</li>
<li><p>VRBToPRBInterleaving</p>
<ul>
<li>disable interleaver</li>
<li>enable intrleaver<br>  äº¤é”™æ˜ å°„çš„ä½œç”¨æ˜¯åœ¨é¢‘åŸŸä¸Šåˆ†æ•£æ•°æ®ï¼Œæé«˜å¯¹é¢‘ç‡é€‰æ‹©æ€§è¡°è½çš„æŠµæŠ—åŠ›ã€‚<br>  VRB index:  0 1 2 3 4 5<br>  Mapped PRB: 0 1 4 5 2 3</li>
</ul>
</li>
<li><p>DM-RS(è§£è°ƒå‚è€ƒä¿¡å·)</p>
<ul>
<li>DMRSConfigurationType</li>
<li>NumCDMGroupsWithoutData</li>
<li>DMRSPortSet</li>
<li>DMRSTypeAPosition</li>
<li>DMRSLength</li>
<li>DMRSAdditionalPositionï¼ˆç”¨æ¥åšscramblingï¼Œä¹Ÿå°±æ˜¯è¯´å°†å‘å°„ç»™ä¸åŒUEçš„ä¿¡å·åŒºåˆ†å¼€ï¼‰</li>
<li>DMRS.NSCID</li>
</ul>
</li>
<li><p>CSI-RS</p>
<ul>
<li>Enable</li>
<li>Label</li>
<li>BandwidthPartID</li>
<li>Power</li>
<li>CSIRSType</li>
<li>RowNumber</li>
<li>CSIRSType</li>
<li>SubcarrierLocation</li>
<li>NumRB</li>
<li>RBOffset</li>
<li>SymbolLocations</li>
<li>CSIPeriod</li>
<li>NID</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hechenyi.github.io/2025/04/21/5gNRSidelink/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/21/5gNRSidelink/" class="post-title-link" itemprop="url">5gNRSidelink</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-21 20:33:19" itemprop="dateCreated datePublished" datetime="2025-04-21T20:33:19+08:00">2025-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-05-19 06:33:54" itemprop="dateModified" datetime="2025-05-19T06:33:54+08:00">2025-05-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/5G/" itemprop="url" rel="index"><span itemprop="name">5G</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
          <h2 id="Basic-discription-â€“-from-MATLAB"><a href="#Basic-discription-â€“-from-MATLAB" class="headerlink" title="Basic discription â€“ from MATLAB"></a>Basic discription â€“ from MATLAB</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openExample(<span class="string">&#x27;5g/NRSidelinkVectorWaveformGenerationExample&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>This example shows how to configure and generate a 5G NR sidelink baseband waveform containing a sequence of physical sidelink control channel (PSCCH) and physical sidelink shared channel (PSSCH) transmission, including sidelink control information (SCI) and SL-SCH transport channel coding.<br>NR sidelink uses the concept of resource pools to configure specific resources for transmission and reception on a sidelink carrier. Each data transmission comprises a PSCCH transmission and an associated PSSCH transmission. </p>
<h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><ul>
<li>set the parameters for the waveform and resource pool configuration<br>The waveform is based on the PSSCH reference measurement channels (RMCs) defined. ä¹Ÿå°±æ˜¯å®ƒæ˜¯æ ¹æ®ä¸€ä¸ªå‚è€ƒchannelè¿›è¡Œæ„é€ çš„ï¼Œä½†å®é™…ä¸Šä½ å¯ä»¥è‡ªå®šä¹‰å‚æ•°ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rmc = R.PSSCH.2-1.2</span><br><span class="line">bwscs = 20MHx @ 30kHz</span><br><span class="line">% Get PSCCH and PSSCH channel and sidelink pool parameters</span><br><span class="line">bw = bwscs(1); </span><br><span class="line">scs = bwscs(2);</span><br><span class="line">[waveconfig.SLTransmission,waveconfig.Pool] = NRSidelinkResourcePool.rmcTestConfiguration(rmc,bw,scs);</span><br></pre></td></tr></table></figure>
<ul>
<li>Waveform Generation (create a baseband IQ waveform that contains a sequence of the previously configured PSCCH and PSSCH transmissions)<ul>
<li>Use a SL-SCH HARQ entity object to control the HARQ process and RV scheduling of the SL-SCH transport encoding, across the series of PSSCH transmissions in the waveform.</li>
<li>Create a set of PN23 data sources to stream the SL-SCH, SCI1, and SCI2 payloads across the sequence of transmisins.</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sci1datasource = createPN23DataSource();</span><br><span class="line">sci2datasource = createPN23DataSource();</span><br></pre></td></tr></table></figure>
<ul>
<li>Create a pair of PSSCH DM-RS position configurations.</li>
<li>Create variable for the basestation waveform and related outputs</li>
<li>é…ç½®å¥½äº†ä¹‹åï¼ˆSlot-wise loop to build the complete waveform from the sequence of individual PSSCH and PSCCH transmissionï¼‰<br>  éœ€è¦æ³¨æ„çš„æ˜¯æ¯ä¸ªsloté‡Œé¢éƒ½æœ‰PSSCHå’ŒPSCCH</li>
</ul>
</li>
</ul>
<h2 id="åŸºäºopenairinterfaceçš„sidelink"><a href="#åŸºäºopenairinterfaceçš„sidelink" class="headerlink" title="åŸºäºopenairinterfaceçš„sidelink"></a>åŸºäºopenairinterfaceçš„sidelink</h2><h3 id="S-SSB"><a href="#S-SSB" class="headerlink" title="S-SSB"></a>S-SSB</h3><img src="/images/S-SSB.png">
ä¸€ä¸ªå®Œæ•´çš„S-SSBåŒ…å«S-PSSã€S-SSSå’ŒPSBCHè¿™å‡ ä¸ªéƒ¨åˆ†

<ul>
<li>S-PSS: symbols 1, 2</li>
<li>S-SSS: symbols 3, 4</li>
<li>PSBCH: symbols 5 - 12<br>S-SSB uses 11 RBs, or 132 subcarriers.<br>The PSBCH provides the system wide configuration and synchronization information required to establish the connection between multiple UEs. Its payload size consists of 56 bits.<br><strong>DMRS</strong> are transmitted in every PSBCH, on every fourth subcarrier, the are used by the receiver to properly decode the PSBCH.</li>
</ul>
<h4 id="procedure"><a href="#procedure" class="headerlink" title="procedure"></a>procedure</h4><p>Create SL PSS<br>  |<br>Create SL SSS<br>  |<br>Fill in DMRS<br>  |<br>Generate PSBCH Payload<br>  |<br>Generate SSB Frame<br>  |<br>Conduct Symbol Rotation<br>  |<br>Encode PSBCH<br>  |<br>Detect SSS         &#x2F;&#x2F;&#x2F;æ¥æ”¶ç«¯<br>  ï½œ<br>Correlated DMRS<br>  |<br>Extract PSBCH</p>
<h3 id="S-SSB-SPSS-and-SSSS-and-PSBCH"><a href="#S-SSB-SPSS-and-SSSS-and-PSBCH" class="headerlink" title="S-SSB (SPSS and SSSS) and PSBCH"></a>S-SSB (SPSS and SSSS) and PSBCH</h3><p><strong>nr_sl_initial_sync</strong>å‡½æ•°å¤„ç†Sidelink S-SSB&#x2F;PSBCH block<br>In 5G sidelink, the first SSB symbol is the PSBCH, so the first thing is to adjust the SSB offset accordingly. The next symbols are PSS and SSS. So we need then to adjust the SSB offset accodingly (subtracting first PSS prefix). </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">uint32_t psbch_plus_prefix_size = fp-&gt;ofdm_symbol_size + fp-&gt;nb_prefix_samples;</span><br><span class="line">uint32_t num_pss_prefix_samples_size = (ue-&gt;common_vars.N2_id + 1) * fp-&gt;nb_prefix_samples;</span><br><span class="line">/// get and extract the corresponding SSB</span><br><span class="line"><span class="keyword">for</span> (int j = 0; j &lt; fp-&gt;slots_per_frame - 1; j++) &#123;</span><br><span class="line">  <span class="keyword">for</span> (int i = 0; i &lt; N_SYMB_SLOT_SL; i++)</span><br><span class="line">nr_slot_fep_init_sync(ue, proc, i ,j ,is * fp-&gt;samples_per_frame + ue-&gt;ssb_offset);</span><br><span class="line">&#125;</span><br><span class="line">/// nr_slot_fep_init_sync ç”¨æ¥æ¥æ”¶æ•°æ®å¹¶åšdftå¤„ç†</span><br><span class="line"></span><br><span class="line">int nr_slot_fep_init_sync(PHY_VARS_NR_UE *ue,</span><br><span class="line">                          UE_nr_rxtx_proc_t *proc,</span><br><span class="line">                          unsigned char symbol,</span><br><span class="line">                          unsigned char Ns,</span><br><span class="line">                          int sample_offset)</span><br><span class="line">&#123; ///è®¡ç®—åç§»å€¼ä»è€Œå®šä½åˆ°å¯¹åº”çš„slotä»¥åŠå¯¹åº”çš„symbol</span><br><span class="line">  unsigned int slot_offset = frame_parms-&gt;get_samples_slot_timestamp(Ns,frame_parms,0);</span><br><span class="line">  unsigned int rx_offset   = sample_offset + slot_offset;</span><br><span class="line">  unsigned int abs_symbol  = Ns * frame_parms-&gt;symbols_per_slot + symbol;</span><br><span class="line">  <span class="keyword">for</span> (int idx_symb = Ns*frame_parms-&gt;symbols_per_slot; idx_symb &lt;= abs_symbol; idx_symb++)</span><br><span class="line">    rx_offset += (abs_symbol%(0x7&lt;&lt;<span class="string">frame_parms-&gt;numerology_index)) ? nb_prefix_samples : nb_prefix_samples0;</span></span><br><span class="line"><span class="string">  rx_offset += frame_parms</span>-&gt;ofdm_symbol_size * symbol;</span><br><span class="line">  /// dft (<span class="keyword">time</span> domain symbols -&gt; frequency domain symbols)</span><br><span class="line">   dft(dftsize,</span><br><span class="line">        rxdata_ptr,</span><br><span class="line">        (int16_t *)&amp;common_vars-&gt;common_vars_rx_data_per_thread[proc-&gt;thread_id].rxdataF[aa][frame_parms-&gt;ofdm_symbol_size*symbol],</span><br><span class="line">        1);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">/// ä¹‹åå¯¹dftåçš„é¢‘åŸŸä¿¡å·è¿›è¡Œfrequency offsetçš„è®¡ç®— ï¼ˆæ ¹æ®SSSæ¥è®¡ç®—ï¼‰</span><br><span class="line">/// DFT -&gt; rxdataF</span><br><span class="line"><span class="keyword">for</span> (Nid1 = 0; Nid1 &lt; N_ID_1_NUMBER; Nid1++) &#123;</span><br><span class="line">  <span class="keyword">for</span> (uint8_t phase = 0; phase &lt; PHASE_HYPOTHESIS_NUMBER; phase++) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">for</span> (int i = 0; i &lt; LENGTH_SSS_NR; i++) &#123;</span><br><span class="line">      metric_re += d[i] * (((phase_re_nr[phase] * sss0[<span class="number">2</span> *i ]) &gt;&gt; SCALING_METRIC_SSS_NR) - ((phase_im_nr[phase] * sss0[<span class="number">2</span> * i + <span class="number">1</span>]) &gt;&gt; SCALING_METRIC_SSS_NR))</span><br><span class="line">                 + d[i] * (((phase_re_nr[phase] * sss1[<span class="number">2</span> *i ]) &gt;&gt; SCALING_METRIC_SSS_NR) - ((phase_im_nr[phase] * sss1[<span class="number">2</span> * i + <span class="number">1</span>]) &gt;&gt; SCALING_METRIC_SSS_NR));</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">int re = 0, im = 0;</span><br><span class="line"><span class="keyword">for</span>(int i = 0; i &lt; LENGTH_SSS_NR; i++) &#123;</span><br><span class="line">  re += d[i] * sss0[2 * i];</span><br><span class="line">  im += d[i] * sss0[2 * i + 1];</span><br><span class="line">  re += d[i] * sss1[2 * i];</span><br><span class="line">  im += d[i] * sss1[2 * i + 1];</span><br><span class="line">&#125;</span><br><span class="line">double ffo_sss = atan2(im, re) / M_PI / 4.3;</span><br><span class="line">*freq_offset_sss = (int)(ffo_sss * frame_parms-&gt;subcarrier_spacing);</span><br><span class="line"></span><br><span class="line">/// compensation</span><br><span class="line"><span class="keyword">for</span> (int n = start; n &lt; end; n++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (int ar = 0; ar &lt; fp-&gt;nb_antennas_rx; ar++) &#123;</span><br><span class="line">              double re = ((double)(((short *)ue-&gt;common_vars.rxdata[ar]))[2 * n]);</span><br><span class="line">              double im = ((double)(((short *)ue-&gt;common_vars.rxdata[ar]))[2 * n + 1]);</span><br><span class="line">              ((short *)ue-&gt;common_vars.rxdata[ar])[<span class="number">2</span> * n] = (short)(round(re * cos(n * off_angle) - im * sin(n * off_angle)));</span><br><span class="line">              ((short *)ue-&gt;common_vars.rxdata[ar])[<span class="number">2</span> * n + <span class="number">1</span>] = (short)(round(re * sin(n * off_angle) + im *cos(n * off_angle)));</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">/// å¤„ç†psbch</span><br><span class="line">...</span><br></pre></td></tr></table></figure>





<h3 id="PSSCH-and-PSCCH"><a href="#PSSCH-and-PSCCH" class="headerlink" title="PSSCH and PSCCH"></a>PSSCH and PSCCH</h3><p>PSSCH contains SCI2 and DM-RS while PSCCH only contains SCI1.<br><img src="/images/PSSCH.png"></p>
<p>The SCI2 payload is <strong>polar</strong> encoded and contains the number of data bits transmitted as well as the multiplexing scheme. So the SCI2 is used by the decoder to properly decode the PSSCH payload, which uses a Low-Density Parity Check(LDPC) encoding mechanism. Besides, the SCI2 is used for the decoding of PSSCH for the HARQ operation.</p>
<h4 id="Procedures"><a href="#Procedures" class="headerlink" title="Procedures"></a>Procedures</h4><p>Generate SCI2           &#x2F;&#x2F;&#x2F;å‘å°„ç«¯<br> |<br>Polar Coding and Rate Matching<br> |<br>LDPC coding and Rate Matching<br> |<br>Data and Control Multiplexing<br> |<br>Scrambling<br> |<br>Constellation Modulation<br> |<br>Layer Mapping<br> |<br>Virtual resource and resource grid mapping<br> |<br>OFDM modulation<br> |<br>Tx&#x2F;Rx<br> |<br>OFDM Demodulation   &#x2F;&#x2F;&#x2F;æ¥æ”¶ç«¯<br> |<br>Resource grid demapping<br> |<br>Channel Estimatin and Equalization<br> |<br>Layer demapping<br> |<br>Constellation demodulation<br> |<br>Descrambling<br> |<br>Data and control demultiplexing<br> |<br>LDPC decoding and polar decoding</p>
<h3 id="HARQ"><a href="#HARQ" class="headerlink" title="HARQ"></a>HARQ</h3><p>HARQ (Hybrid ARQ (Automatic Repeat Request)). It is a feedback transmission and reception 5G uses. It has such functionalities as blow:</p>
<ul>
<li><p>é‡ä¼ æ§åˆ¶<br>ç”¨äºç®¡ç†æ˜¯å¦éœ€è¦é‡ä¼ (é€šè¿‡roundï¼Œ ndiï¼Œ tx_statusç­‰å­—æ®µ)</p>
</li>
<li><p>æ•°æ®å­˜å‚¨<br>å­˜å‚¨å½“å‰HARQè¿‡ç¨‹çš„æ•°æ®ï¼Œæ¯”å¦‚<strong>a_sci2</strong>, <strong>b_sci2</strong><br>å…¶ä¸­a_sci2ç”¨äºpointer to sci2 after crc + polar encoding and rate matching stored in bytes.<br>å…¶ä¸­b_sci2ç”¨äºpointer to output of data-control multiplexer in bits.<br>å…¶ä»–<strong>A_sci2</strong>å’Œ<strong>B_sci2</strong>ç”¨äºè¡¨ç¤ºæ•°æ®å¤§å°in bits<br>B_sci2ï¼šç”¨æ¥è¡¨ç¤ºæ•°æ®çš„å¤§å°ï¼Œä½¿ç”¨ uint32_t ç±»å‹æ¥å­˜å‚¨å¤§å°ï¼ˆå•ä½ï¼šæ¯”ç‰¹ï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªé™æ€çš„æ•°å­—ï¼Œè€Œä¸æ˜¯å®é™…çš„æ•°æ®å†…å®¹ã€‚<br>b_sci2ï¼šæŒ‡å‘å®é™…æ•°æ®çš„æŒ‡é’ˆï¼Œç”¨æ¥è¡¨ç¤ºæ•°æ®çš„å†…å­˜åœ°å€ï¼Œå®é™…çš„æ•°æ®å†…å®¹å­˜å‚¨åœ¨è¯¥åœ°å€æŒ‡å‘çš„å†…å­˜åŒºåŸŸã€‚ä½¿ç”¨æŒ‡é’ˆæ˜¯å› ä¸ºæ•°æ®çš„é•¿åº¦ä¸å›ºå®šæˆ–å¯èƒ½å˜åŒ–ï¼Œå› æ­¤éœ€è¦åŠ¨æ€åœ°åˆ†é…å’Œç®¡ç†å†…å­˜ã€‚</p>
</li>
<li><p>ç¼–ç ç¼“å­˜<br>å­˜å‚¨LDPC&#x2F;Polarç¼–ç è¾“å‡ºåŠä¸­é—´æ­¥éª¤</p>
</li>
<li><p>slotå®šä½<br>æŒ‡æ˜æ­¤HARQå¯¹åº”çš„slot and frame(frame, slot) </p>
</li>
<li><p>è°ƒåº¦ååŠ©<br>è¾…åŠ©scheduleråˆ¤æ–­èµ„æºä½¿ç”¨æƒ…å†µï¼Œæ˜¯å¦æœ‰æœªå®ŒæˆHARQ</p>
</li>
</ul>
<h4 id="NR-UL-UE-HARQ-t"><a href="#NR-UL-UE-HARQ-t" class="headerlink" title="NR_UL_UE_HARQ_t"></a>NR_UL_UE_HARQ_t</h4><p>å…³é”®å­—æ®µ</p>
<ul>
<li>a_sci2<br>pointer to SCI2 payload from MAC interface</li>
<li>b_sci2<br>pointer to sci2 after crc+polar encoding and rate matching stored in bytes</li>
<li>*a<br>pointer to pdu from MAC interface(ä¹Ÿå°±æ˜¯payload)</li>
<li>*b<br>pointers to the payload + CRC</li>
</ul>
<h4 id="NR-DL-UE-HARQ-t"><a href="#NR-DL-UE-HARQ-t" class="headerlink" title="NR_DL_UE_HARQ_t"></a>NR_DL_UE_HARQ_t</h4><p>å…³é”®å­—æ®µ</p>
<ul>
<li>*b<br>pointer to the payload</li>
<li>B<br>the payload + crc size in bits</li>
<li>b_sci2<br>pointer to the sci2 payload</li>
<li>B_sci2<br>the sci2â€™s payload + CRC + channel coder + rate matching size in bits</li>
</ul>
<h3 id="TDD"><a href="#TDD" class="headerlink" title="TDD"></a>TDD</h3><p>The flexible slot feature of 5G SL utilizes each symbol to schedule uplink, downlink, or flexible packets. According to the 3GPP standard, the S-SBB should be periodicity of 160 ms(10ms per system frame number, 0.5 ms per slot). There are other modifiable parameters like interval parameter, offset parameter, number S-SSB per period.<br><img src="/images/SSSB_TDD.png"></p>
<p>So in this test use case, we arbitrarily chose to broadcast 2 S-SSBs per period. The first S-SSB is sent in slot 2 because we set the offset parameter to 2. The interal parameter was set to 20.<br>20+2-10ms&#x2F;0.5ms &#x3D; 2<br>so the next S-SSb will be transmitted twice in a period, and occurs in frame 1 slot 2.</p>
<h4 id="S-SSBåSCH-PSSCH-PSCCH-ä¹‹é—´çš„æ—¶éš”åˆ’åˆ†"><a href="#S-SSBåSCH-PSSCH-PSCCH-ä¹‹é—´çš„æ—¶éš”åˆ’åˆ†" class="headerlink" title="S-SSBåSCH(PSSCH &amp; PSCCH)ä¹‹é—´çš„æ—¶éš”åˆ’åˆ†"></a>S-SSBåSCH(PSSCH &amp; PSCCH)ä¹‹é—´çš„æ—¶éš”åˆ’åˆ†</h4><p>åœ¨SL Mode 2ä¸­ï¼Œæ—¶éš”åˆ’åˆ†æ˜¯ç”±UEè‡ªèº«é…ç½®çš„S-SSBå‘¨æœŸ&#x2F;åç§»&#x2F;é—´éš”å†³å®šï¼ˆä¾‹å¦‚åœ¨æŸä¸ªslotå‘å°„S-SSBåœ¨å¦å¤–çš„slotå†…å‘å°„SCHï¼‰ï¼Œè¿™æ˜¯ç”±UEæœ¬åœ°RRC Layeræ¥é…ç½®çš„ã€‚åœ¨æœ¬æ¬¡å®éªŒä¸­ï¼ŒæŸ¥çœ‹ä»£ç å¯çŸ¥S-SSBæ˜¯æ¯ä¸ª160mså‘å°„ä¸€æ¬¡S-SSBï¼Œä»£ç å¯è§&#x2F;openair1&#x2F;SCHED_NR_UE&#x2F;phy_procedures_nr_ur.c<br>å…ˆä»RRCå±‚è·å–S-SSBçš„å„ç§å‚æ•°é…ç½®ï¼Œä¾‹å¦‚ä¸€ä¸ªå‘¨æœŸ(160ms)å†…æœ‰å¤šå°‘ä¸ªS-SSBï¼Œç¬¬ä¸€ä¸ªS-SSBçš„åç§»é‡è¿˜æœ‰ä¸¤ä¸ªS-SSBä¹‹é—´çš„é—´éš”</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">bool phy_ssb_slot_allocation_sl(PHY_VARS_NR_UE *ue, int frame, int slot)</span><br><span class="line">&#123;</span><br><span class="line">  NR_DL_FRAME_PARMS *fp = &amp;ue-&gt;frame_parms;</span><br><span class="line">  static int sl_numssb_withinperiod_r16, sl_timeoffsetssb_r16, sl_timeoffsetssb_r16_copy;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (sl_numssb_withinperiod_r16 == 0) &#123;</span><br><span class="line">    sl_numssb_withinperiod_r16 = ue-&gt;slss-&gt;sl_numssb_withinperiod_r16;</span><br><span class="line">    sl_timeoffsetssb_r16 = ue-&gt;slss-&gt;sl_timeoffsetssb_r16;</span><br><span class="line">    sl_timeoffsetssb_r16_copy = sl_timeoffsetssb_r16;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ((frame * fp-&gt;slots_per_frame + slot) % (<span class="number">16</span> * fp-&gt;slots_per_frame) == <span class="number">0</span>) &#123;</span><br><span class="line">    ue-&gt;slss-&gt;sl_numssb_withinperiod_r16 = ue-&gt;slss-&gt;sl_numssb_withinperiod_r16_copy;</span><br><span class="line">    sl_timeoffsetssb_r16 = frame * fp-&gt;slots_per_frame + sl_timeoffsetssb_r16_copy;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (ue-&gt;slss-&gt;sl_numssb_withinperiod_r16 &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    if (frame * fp-&gt;slots_per_frame + slot == sl_timeoffsetssb_r16) &#123;</span><br><span class="line">      sl_timeoffsetssb_r16 = sl_timeoffsetssb_r16 + ue-&gt;slss-&gt;sl_timeinterval_r16;</span><br><span class="line">      ue-&gt;slss-&gt;sl_numssb_withinperiod_r16 = ue-&gt;slss-&gt;sl_numssb_withinperiod_r16 - <span class="number">1</span>;</span><br><span class="line">      LOG_I(PHY,&quot;*** SL-SSB slot allocation  %d.%d ***\n&quot;, frame, slot); </span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line">  return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹äºsyncref ueï¼Œä»¥0-15 frames ä¸ºä¾‹ï¼Œframe 0 ï¼Œ frame 1ä¸­çš„slot 1ä¼šå‘å°„SSBï¼Œç„¶ååœ¨å…¶ä»–çš„frameä¸­çš„slot1æˆ–è€…slot0ä¼šå‘å°„PSSCHï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">uint32_t sl_bitmap_tx = 0x00000;</span><br><span class="line"><span class="keyword">if</span>(ue-&gt;sync_ref) &#123;</span><br><span class="line">  sl_bitmap_tx = (ue-&gt;is_synchronized_sl == 0) ? 0x00001 : 0x00002;  // SyncRef UE tx slot 0, Relay UE B tx slot 1.</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((sl_bitmap_tx &gt;&gt; slot_tx) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">  for (uint8_t harq_pid = <span class="number">0</span>; harq_pid &lt; <span class="number">1</span>; harq_pid++) &#123;</span><br><span class="line">    nr_ue_set_slsch(&amp;ue-&gt;frame_parms, harq_pid, ue-&gt;slsch[proc-&gt;thread_id][gNB_id], frame_tx, slot_tx);</span><br><span class="line">    if (ue-&gt;slsch[proc-&gt;thread_id][gNB_id]-&gt;harq_processes[harq_pid]-&gt;status == ACTIVE) &#123;</span><br><span class="line">      nr_ue_slsch_tx_procedures(ue, harq_pid, frame_tx, slot_tx);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹äºnearby ueï¼Œä¹Ÿæ˜¯ä»æ¯ä¸ªframeä¸­çš„ç‰¹å®šslotå»è·å–pssch</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">int phy_procedures_nrUE_SL_RX(PHY_VARS_NR_UE *ue,</span><br><span class="line">                           UE_nr_rxtx_proc_t *proc,</span><br><span class="line">                           uint8_t synchRefUE_id,</span><br><span class="line">                           notifiedFIFO_t *txFifo) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (ue-&gt;is_synchronized_sl == 0)</span><br><span class="line">    <span class="built_in">return</span> (0);</span><br><span class="line"></span><br><span class="line">  // TODO: Need to add rx SSB slot 2 (to Relay UE) and rx SSB slot 4 (Nearby UE) <span class="keyword">for</span> resync</span><br><span class="line">  uint32_t sl_bitmap_rx = ue-&gt;sync_ref ? 0x00001 : 0x00002; // Relay UE B rx slot 0, Nearby UE rx slot 1.</span><br><span class="line">  <span class="keyword">if</span> (((sl_bitmap_rx &gt;&gt; proc-&gt;nr_slot_rx) &amp; <span class="number">1</span>) == <span class="number">0</span>) </span><br><span class="line">    return (<span class="number">0</span>);</span><br><span class="line">  int frame_rx = proc-&gt;frame_rx;</span><br><span class="line">  int slot_rx = proc-&gt;nr_slot_rx;</span><br><span class="line">  uint32_t ret = nr_ue_slsch_rx_procedures(ue, harq_pid, frame_rx, slot_rx, rxdataF, B_mul, Nidx, proc);</span><br><span class="line"></span><br><span class="line">  bool payload_type_string = true;</span><br><span class="line">  bool polar_decoded = (ret &lt; LDPC_MAX_LIMIT) ? true : false;</span><br><span class="line">  uint16_t dest = (*harq-&gt;b_sci2 &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0</span>xFFFF;</span><br><span class="line">  bool dest_matched = (dest == node_id);</span><br><span class="line">  if (polar_decoded)</span><br><span class="line">    LOG_D(PHY, &quot;dest %u vs %u node_id for hex %lx\n&quot;, dest, node_id, *harq-&gt;b_sci2);</span><br><span class="line">  if ((ret != -<span class="number">1</span>) &amp;&amp; dest_matched) &#123;</span><br><span class="line">    if (payload_type_string)</span><br><span class="line">        validate_rx_payload_str(harq, slot_rx, polar_decoded);</span><br><span class="line">        else</span><br><span class="line">        validate_rx_payload(harq, frame_rx, slot_rx, polar_decoded);</span><br><span class="line">              &#125;</span><br></pre></td></tr></table></figure>


<hr>
<blockquote>
<p><strong>Notice</strong><br><br>sl-numSSB-WithinPeriod-r16, sl-timeInterval-r16, sl-SSB-PeriodicityAndOffset-r16è¿™äº›å’ŒS-SSBçš„æ—¶åºç›¸å…³çš„é…ç½®æ ¹æ®<strong>3GPP</strong>è§„èŒƒæ˜ç¡®å‡ºç°åœ¨<strong>RRC</strong>å±‚å®šä¹‰çš„Sidelinké…ç½®ç»“æ„ä¸­ã€‚</p>
</blockquote>
<hr>
<h3 id="Evaluation"><a href="#Evaluation" class="headerlink" title="Evaluation"></a>Evaluation</h3><h4 id="Sidelink-Sequence-Diagram"><a href="#Sidelink-Sequence-Diagram" class="headerlink" title="Sidelink Sequence Diagram"></a>Sidelink Sequence Diagram</h4><p>â€¦<br>è‡ªå·±ç”»(Synchronization ueå’Œnearby ueä¹‹é—´çš„é€šä¿¡)</p>
<h4 id="Sidelink-Block-Diagram"><a href="#Sidelink-Block-Diagram" class="headerlink" title="Sidelink Block Diagram"></a>Sidelink Block Diagram</h4><img src="/images/SidelinkBlockDiagram.png">

<h4 id="RSRP-Reference-signal-received-power"><a href="#RSRP-Reference-signal-received-power" class="headerlink" title="RSRP (Reference signal received power)"></a>RSRP (Reference signal received power)</h4><p>åˆ†åˆ«è®¡ç®—äº†SSB-RSRPå’ŒPSSCH-RSRP<br>ä»¥ä¸‹æ˜¯PSSCH-RSRPçš„è®¡ç®—å…¬å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">\mathrm&#123;RSRP&#125;_&#123;\mathrm&#123;dBm&#125;&#125;</span><br><span class="line">= 10 \log_&#123;10&#125;\Bigl(P_&#123;\mathrm&#123;lin&#125;&#125;\Bigr)</span><br><span class="line">  + 30</span><br><span class="line">  - 10 \log_&#123;10&#125;\bigl(2^&#123;30&#125;\bigr)</span><br><span class="line">  - \bigl(G_&#123;\mathrm&#123;rx&#125;&#125; - G_&#123;\mathrm&#123;off&#125;&#125;\bigr)</span><br><span class="line">  - \mathrm&#123;dB\_fixed&#125;(N_&#123;\mathrm&#123;fft&#125;&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­$P_{lin}$æ˜¯å¯¹æ‰€æœ‰æµ‹é‡åˆ°çš„èµ„æºå…ƒç´ ï¼ˆREï¼‰åŠŸç‡å–å¹³å‡åçš„çº¿æ€§åŠŸç‡ï¼Œå…¶ä¸­$10\log_{10}(2^{30})$æ˜¯å› ä¸ºç³»ç»Ÿç”¨30ä½å®šç‚¹æ•°è¡¨ç¤ºFFTè¾“å‡ºï¼Œæ•°å€¼å®é™…ä¸Šè¢«ä¹˜äº†$2^{30}$,å› æ­¤éœ€è¦å‡å»è¿™ä¸ªç¼©æ”¾å› å­ã€‚é™¤æ­¤ä¹‹å¤–è¿˜éœ€è¦å‡å»è¡¥å¿æ”¾å¤§å™¨å¸¦æ¥çš„åŠŸç‡å¢ç›Šã€‚åŒæ—¶è¿˜è¦å‡å»ä¸åŒFFTå¤§å°ï¼ˆå³OFDMå­è½½æ³¢æ€»æ•°ï¼‰ä¸‹çš„å•ä½å­è½½æ³¢çš„åŠŸç‡å¯†åº¦å˜åŒ–ã€‚</p>
<p>ä»å“ªäº›ä¿¡å·è®¡ç®—rsrpï¼Ÿï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (int k = 0; k &lt; nb_rb * NR_NB_SC_PER_RB; k += 4) &#123;</span><br><span class="line">  <span class="comment">#ifdef DEBUG_MEAS_UE</span></span><br><span class="line">  LOG_I(N_pssch %d %d\n<span class="string">&quot;, __FUNCTION__, rxF_pssch[k * 2], rxF_pssch[k * 2 + 1]);</span></span><br><span class="line"><span class="string">  #endif</span></span><br><span class="line"><span class="string">  rsrp += (((int32_t)rxF_pssch[k * 2] * rxF_pssch[k * 2]) + ((int32_t)rxF_pssch[k * 2 + 1] * rxF_pssch[k * 2 + 1]));</span></span><br><span class="line"><span class="string">  nb_re++;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p>æ¯4ä¸ªå­è½½æ³¢å–ä¸€æ¬¡DMRSä¿¡å·æ¥è¿›è¡Œæµ‹é‡received powerï¼Œå¯¹æ¯ä¸€ä¸ªæŠ½æ ·ç‚¹å…ˆå–å®æ•°å¹³æ–¹åŠ è™šéƒ¨å¹³æ–¹ï¼Œå¾—åˆ°è¿™ä¸ªREåˆ°çº¿æ€§åŠŸç‡ï¼Œç´¯åŠ åˆ°rsrpã€‚</p>
<h4 id="Sync-time"><a href="#Sync-time" class="headerlink" title="Sync time"></a>Sync time</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#796821.854505 [NR_PHY] SyncRef UE found with Nid1 10 and Nid2 1 SS-RSRP -100 dBm/RE</span></span><br><span class="line">  <span class="keyword">if</span> not line.startswith(<span class="string">&#x27;[&#x27;</span>) and <span class="string">&#x27;SyncRef UE found&#x27;</span> <span class="keyword">in</span> line and <span class="string">&#x27;Nid1&#x27;</span> <span class="keyword">in</span> line and <span class="string">&#x27;Nid2&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">      num_split = 13 <span class="keyword">if</span> <span class="string">&#x27;RSRP&#x27;</span> <span class="keyword">in</span> line <span class="keyword">else</span> 10</span><br><span class="line">      fields = line.split(maxsplit=num_split)</span><br><span class="line">      est_nid1 = int(fields[7])</span><br><span class="line">      est_nid2 = int(fields[10])</span><br><span class="line">      <span class="keyword">if</span> <span class="string">&#x27;RSRP&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">            ssb_rsrp = int(fields[12])</span><br><span class="line">      found.add(<span class="string">&#x27;syncref&#x27;</span>)</span><br><span class="line">      time_end_s = <span class="built_in">float</span>(fields[0])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>åŒæ­¥æ—¶é—´å¹³å‡æ˜¯7-8ç§’ï¼Œå¯¹åº”çš„SSBæ•°ç›®æ˜¯é™¤0.16ç§’å†ä¹˜2<br>å› ä¸ºå‘¨æœŸæ˜¯160msï¼Œå¹¶ä¸”ä¸€ä¸ªå‘¨æœŸå†…æœ‰2ä¸ªSSB</p>
<h4 id="Packet-Loss-Rate"><a href="#Packet-Loss-Rate" class="headerlink" title="Packet Loss Rate"></a>Packet Loss Rate</h4><p>Successfully decoded packets</p>
<h4 id="Data-rates"><a href="#Data-rates" class="headerlink" title="Data rates"></a>Data rates</h4><ul>
<li>æ‰€æœ‰æ•°æ®</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">uint32_t B_mul = get_B_multiplexed_value(&amp;ue-&gt;frame_parms, slsch-&gt;harq_processes[0]);</span><br><span class="line">uint32_t get_B_multiplexed_value(NR_DL_FRAME_PARMS* fp, NR_DL_UE_HARQ_t *harq) &#123;</span><br><span class="line"></span><br><span class="line">  uint8_t Nl                = harq-&gt;Nl;</span><br><span class="line">  unsigned int G_slsch_bits = harq-&gt;G;</span><br><span class="line">  uint32_t B_mul = G_slsch_bits + harq-&gt;B_sci2 * Nl;</span><br><span class="line">  <span class="built_in">return</span> B_mul;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­harq-&gt;nlæ˜¯Number of MIMO layers (streams), harq-&gt;Gæ˜¯Number of soft channel bitsï¼Œ<br>æœ€ç»ˆ<strong>B_mul</strong>æ˜¯æ•´ä¸ªSidelink PDUä¸­æ‰€æœ‰å®é™…é€šè¿‡ç©ºå£ä¼ è¾“çš„æ¯”ç‰¹æ•°(æ•°æ®+æ§åˆ¶)ï¼Œå¯ä»¥ç”¨æ¥ä¼°ç®—å®é™…çš„PHYååé‡ã€‚</p>
<p>å…¶ä¸­harq-Gå…·ä½“è®¡ç®—å¦‚ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uint32_t nr_get_G_sl(uint16_t nb_rb, uint16_t nb_re_sci1, uint16_t nb_re_sci2, uint16_t nb_symb_sch, uint8_t nb_re_dmrs, uint16_t length_dmrs, uint8_t Qm, uint8_t Nl) &#123;</span><br><span class="line">    uint32_t G;</span><br><span class="line">    G = (((NR_NB_SC_PER_RB * nb_symb_sch)-(nb_re_dmrs * length_dmrs)) * nb_rb - nb_re_sci1 - nb_re_sci2) * Qm * Nl;</span><br><span class="line">    <span class="built_in">return</span>(G);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­NR_NB_SC_PER_RBæ˜¯æ¯ä¸ªèµ„æºå—åŒ…å«çš„å­è½½æ³¢æ•°ï¼Œä¸€ä¸ªRBåŒ…å«12ä¸ªå­è½½æ³¢<br>nb_symb_sch æ˜¯è¯¥slotå†…çš„ç¬¦å·æ•°é‡ã€‚å…¶ä¸­<strong>nb_rb</strong>æ˜¯èµ„æºå—æ•°é‡ï¼Œåœ¨oaiä¸­é€šå¸¸æ ‡å‡†åŒ–ä¸º50çš„å€æ•°ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨è„šæœ¬ä¸­æŠŠrbslè®¾ä¸ºäº†52ï¼Œä½†åœ¨oaiä¸­ä¼šå˜ä¸º50ã€‚å…¶ä¸­<strong>Qm</strong>è¡¨ç¤ºæ¯ä¸ªREçš„çš„è°ƒåˆ¶æ¯”ç‰¹æ•°ï¼Œä¾‹å¦‚QPSK &#x3D; 2ï¼Œ16QAM &#x3D; 4<br>æœ€ç»ˆnr_get_G_slçš„è¿”å›å€¼æ˜¯12480ï¼Œè¯´æ˜æ•´ä¸ªpsschçš„bitsæ˜¯12480ï¼Œè¿™è¡¨ç¤ºä¸€ä¸ªslotä¸­ä¼ è¾“çš„æ•°æ®æ€»æ¯”ç‰¹æ•°ï¼ŒåŒ…æ‹¬ï¼š PSSCHæ•°æ®éƒ¨åˆ† + SCI2æ§åˆ¶ä¿¡æ¯éƒ¨åˆ†çš„æ¯”ç‰¹æ€»æ•°ã€‚harq-&gt;Gæ˜¯11904bitsï¼Œè¿™è¡¨ç¤ºæ•´ä¸ªPSSCHä¼ è¾“ä¸­å½“å‰slotå¯æ‰¿è½½çš„æ•°æ®æ¯”ç‰¹æ•°ï¼ˆç†è®ºæœ€å¤§ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸åŒ…å«SCI2æ§åˆ¶ä¿¡æ¯<br>ååé‡ &#x3D; 12480&#x2F;0.0005 &#x3D; 24960000 bits&#x2F;s &#x3D; 24.96 Mbps &#x3D; 3.12 MB&#x2F;s<br>è€Œè¿™æ—¶ç†è®ºä¸Šä¸€ä¸ªslotä¸Šçš„ååé‡ï¼Œå¦‚æœæ”¾åˆ°æ•´ä¸€ä¸ªframeä¸­ï¼Œé‚£ä¹ˆååé‡ &#x3D; 24960000 bits&#x2F;s &#x2F; 20 &#x3D; <strong>1248000</strong> bits&#x2F;s<br>ï¼ˆå› ä¸ºä¸€ä¸ªframeåªæœ‰ä¸€ä¸ªslotç”¨äºpsschä¼ è¾“ï¼‰<br>åœ¨å®é™…æµ‹è¯•ä¸­ï¼Œdata rateå¤§çº¦ä¸º<strong>1188000</strong> bis&#x2F;s,ç•¥å°äºç†è®ºé€Ÿç‡ï¼Œå› æ­¤åˆç†ã€‚ï¼ˆå¯èƒ½æ˜¯ç”±äºä¸¢åŒ…å¯¼è‡´çš„ï¼‰<br>overview of parameters:</p>
<ul>
<li>MCS<br>0, so it is QPSK</li>
<li>RB<br>52ä¸ªRBç„¶åè¢«oaiå½’ä¸€åŒ–ä¸º50ï¼Œæ¯ä¸ªRBä¸­æœ‰12ä¸ªå­è½½æ³¢  </li>
<li>SCS<br>å­è½½æ³¢é—´éš”ä¸º30kHzï¼Œè¿™æ ·ç®—ä¸‹æ¥å¸¦å®½ä¸º18MHxï¼ˆ50x12x30ï¼‰ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€äº›guard bandï¼ˆä¿æŠ¤å¸¦ï¼‰ï¼Œå› æ­¤å®é™…å¸¦å®½ä¼šæ›´å¤§ï¼Œå¤§çº¦ä¸ºæ ‡å‡†åŒ–å¸¦å®½20MHz</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">void nr_ue_set_slsch_rx(PHY_VARS_NR_UE *ue, unsigned char harq_pid)</span><br><span class="line">&#123;</span><br><span class="line">  int nb_rb = get_PRB(ue-&gt;frame_parms.N_RB_SL);</span><br><span class="line">  uint16_t nb_symb_sch = 12;</span><br><span class="line">  uint16_t nb_symb_cch = 3; // Assumption there are three SLCCH symbols</span><br><span class="line">  uint8_t dmrsConfigType = 0;</span><br><span class="line">  uint8_t Nl = 1; // number of layer</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="Latency-self-defined"><a href="#Latency-self-defined" class="headerlink" title="Latency(self-defined)"></a>Latency(self-defined)</h4><p>histogram latency<br>å¯¹äºå‘å°„ç«¯<br>åœ¨nr_ue_slsch_tx_procedureså‡½æ•°ä¸­æŸä¸€ä½ç½®åŠ ä¸Šæ—¶é—´æˆ³ï¼Œä¾‹å¦‚åœ¨modulation + layer mapping + resource mappingä¹‹åï¼Œä½†æ˜¯åœ¨nr_ue_pssch_common_procedures()å‡½æ•°ä¹‹å‰ï¼Œå› ä¸ºnr_ue_pssch_common_procedures()æ¶‰åŠå…·ä½“çš„æŠŠä¿¡å·åŠ åˆ°RFç«¯ã€‚<br>å¯¹äºæ¥æ”¶ç«¯<br>åœ¨nr_ue_slsch_rx_procedureså‡½æ•°å†…ï¼Œåœ¨nr_slsch_decodingä¹‹å</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">uint32_t ret = nr_slsch_decoding(rxUE, proc, ulsch_llr[0],</span><br><span class="line">                          &amp;rxUE-&gt;frame_parms, slsch_ue_rx,</span><br><span class="line">                          slsch_ue_rx-&gt;harq_processes[0], frame,</span><br><span class="line">                          nb_symb_sch, slot, harq_pid);</span><br><span class="line">///////////////////////////////////////////////////////</span><br><span class="line">LOG_I(NR_PHY,<span class="string">&quot;Frame: %d, Slot: %d&quot;</span>, frame, slot);</span><br><span class="line"><span class="built_in">return</span> ret;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="Resources-blocks"><a href="#Resources-blocks" class="headerlink" title="Resources blocks"></a>Resources blocks</h4><p>å…·ä½“å¯è§paperï¼ˆåªéœ€è¦è€ƒè™‘PSSCHå’ŒPSCCHï¼‰<br>å› ä¸ºåªéœ€è¦å…³å¿ƒreal data<br>Resource blockså¯ä»¥æ¨å¯¼å‡ºtheoretical data rates</p>
<h3 id="How-would-improve"><a href="#How-would-improve" class="headerlink" title="How would improve"></a>How would improve</h3><p>ä¾‹å¦‚å¦‚ä½•æ”¹è‰¯resource blocks</p>
<h4 id="æ”¹åŠ¨åœ°æ–¹"><a href="#æ”¹åŠ¨åœ°æ–¹" class="headerlink" title="æ”¹åŠ¨åœ°æ–¹"></a>æ”¹åŠ¨åœ°æ–¹</h4><ul>
<li>ue-&gt;sync_ref &#x3D; 0</li>
<li>polar_decoder_int16 failed</li>
<li>validate_rx_str<br>é—®é¢˜ï¼š<br>syncè¿‡å‡ ç§’å°±ä¸å†æ¥æ”¶äº†</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hechenyi.github.io/2025/04/21/C%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/21/C%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" class="post-title-link" itemprop="url">CåŸºæœ¬æ¦‚å¿µ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-21 15:19:37" itemprop="dateCreated datePublished" datetime="2025-04-21T15:19:37+08:00">2025-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-04 12:55:41" itemprop="dateModified" datetime="2025-08-04T12:55:41+08:00">2025-08-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
          <h2 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h2><p>æŒ‡é’ˆå˜é‡æœ¬èº«çš„å€¼æ˜¯åœ°å€ï¼ŒX64æœ‰2çš„64æ¬¡æ–¹ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤æŒ‡é’ˆå 8ä¸ªå­—èŠ‚ã€‚<br>æŒ‡é’ˆå˜é‡é€šå¸¸æ˜¯æ ˆä¸Šçš„å˜é‡ã€‚<br>æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å¯ä»¥æ˜¯æ ˆä¸Šå˜é‡çš„åœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯å †ä¸Šåˆ†é…çš„å†…å­˜åœ°å€ã€‚</p>
<h2 id="malloc-new"><a href="#malloc-new" class="headerlink" title="malloc&amp;new"></a>malloc&amp;new</h2><ul>
<li>malloc ï¼ˆCï¼‰<ul>
<li>mallocä¸ä¼šè°ƒç”¨æ„é€ ææ„å‡½æ•°</li>
<li>mallocè¿”å›æ— ç±»å‹çš„æŒ‡é’ˆï¼ˆå› æ­¤éœ€è¦è½¬æ¢ä¸€ä¸‹ï¼Œchar* p &#x3D; (char*) malloc(100)ï¼‰</li>
</ul>
</li>
<li>new&#x2F;delete ï¼ˆC++ï¼‰<ul>
<li>new è¿”å›æœ‰ç±»å‹çš„æŒ‡é’ˆ</li>
<li>newè°ƒç”¨æ„é€ ææ„å‡½æ•°</li>
</ul>
</li>
</ul>
<p>äºŒè€…éƒ½æ˜¯åœ¨å †ä¸ŠåŠ¨æ€æ€§åœ°å­˜å‚¨å˜é‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"></span><br><span class="line">struct Person &#123;</span><br><span class="line">    char name[50];</span><br><span class="line">    int age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">int <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">    struct Person* p = (struct Person*)malloc(sizeof(struct Person));</span><br><span class="line">    <span class="keyword">if</span> (!p) &#123;</span><br><span class="line">        perror(<span class="string">&quot;malloc failed&quot;</span>);</span><br><span class="line">        <span class="built_in">return</span> 1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    strcpy(p-&gt;name, <span class="string">&quot;Bob&quot;</span>);</span><br><span class="line">    p-&gt;age = 30;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Name: %s, Age: %d\n&quot;</span>, p-&gt;name, p-&gt;age);</span><br><span class="line"></span><br><span class="line">    free(p);  // â—å¿…é¡»é‡Šæ”¾</span><br><span class="line">    <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="STLå…­å¤§ç»„ä»¶"><a href="#STLå…­å¤§ç»„ä»¶" class="headerlink" title="STLå…­å¤§ç»„ä»¶"></a>STLå…­å¤§ç»„ä»¶</h2><ul>
<li>ä»¿å‡½æ•°</li>
<li>ç®—æ³•</li>
<li>è¿­ä»£å™¨</li>
<li>ç©ºé—´é…ç½®å™¨</li>
<li>å®¹å™¨</li>
<li>é…æ¥å™¨</li>
</ul>
<h3 id="ä½¿ç”¨std-unordered-mapæ„å»ºhash-map"><a href="#ä½¿ç”¨std-unordered-mapæ„å»ºhash-map" class="headerlink" title="ä½¿ç”¨std::unordered_mapæ„å»ºhash map"></a>ä½¿ç”¨std::unordered_mapæ„å»ºhash map</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;unordered_map&gt;</span></span><br><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string&gt;</span></span><br><span class="line">std::unordered_map&lt;std::string, int&gt; word_count;</span><br><span class="line">word_count[<span class="string">&quot;apple&quot;</span>] = 3;</span><br><span class="line">word_count.insert(&#123;<span class="string">&quot;orange&quot;</span>, 7&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="çº¿ç¨‹çŠ¶æ€"><a href="#çº¿ç¨‹çŠ¶æ€" class="headerlink" title="çº¿ç¨‹çŠ¶æ€"></a>çº¿ç¨‹çŠ¶æ€</h2><ul>
<li>åˆ›å»º</li>
<li>å°±ç»ª</li>
<li>è¿è¡Œ</li>
<li>å µå¡</li>
<li>æ­»äº¡</li>
</ul>
<h2 id="é™æ€è¿æ¥"><a href="#é™æ€è¿æ¥" class="headerlink" title="é™æ€è¿æ¥"></a>é™æ€è¿æ¥</h2><ul>
<li>åˆ›å»ºä¸€ä¸ªé™æ€åº“ï¼ˆ.aæ–‡ä»¶ï¼‰</li>
<li>ç¼–è¯‘ä¸ºé™æ€åº“</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ -c math_utils.cpp -o math_utils.o</span><br><span class="line">ar rcs libmathutils.a math_utils.o</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨é™æ€åº“çš„ä¸»å‡½æ•°</li>
<li>é™æ€è¿æ¥å¹¶ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ main.cpp -L. -lmathutils -o app</span><br></pre></td></tr></table></figure>

<h2 id="æ„å»ºç»“æ„ä½“"><a href="#æ„å»ºç»“æ„ä½“" class="headerlink" title="æ„å»ºç»“æ„ä½“"></a>æ„å»ºç»“æ„ä½“</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">typedef struct notifiedFIFO_elt_s&#123;</span><br><span class="line">    struct notifiedFIFO_elt_s *next;</span><br><span class="line">    uint64_t key;</span><br><span class="line">    /// æ„å»ºä¸€ä¸ªç©ºçš„å‡½æ•°æŒ‡é’ˆï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥å°†å…¶è¿›è¡Œå¼ºåˆ¶è½¬æ¢</span><br><span class="line">    void (*processingFunc) (void *);</span><br><span class="line">    bool malloced;</span><br><span class="line">    /// oaiçš„ç³»ç»Ÿç»“æ„ä½“ï¼Œå¯ä»¥ç”¨äºæ€§èƒ½æµ‹è¯•</span><br><span class="line">    oai_cputime_t creationTime;</span><br><span class="line">    oai_cputime_t startProcessingTime;</span><br><span class="line">    oai_cputime_t endProcessingTime;</span><br><span class="line">    oai_cputime_t returnTime;</span><br><span class="line">    /// ç©ºçš„æŒ‡é’ˆï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥è¿›è¡Œå¼ºåˆ¶è½¬æ¢</span><br><span class="line">    void *msgData; </span><br><span class="line">&#125;   notifiedFIFO_elt_t;</span><br></pre></td></tr></table></figure>

<h3 id="å¼ºè¡Œè½¬æ¢å¹¶ä½¿ç”¨msgDataæŒ‡é’ˆ"><a href="#å¼ºè¡Œè½¬æ¢å¹¶ä½¿ç”¨msgDataæŒ‡é’ˆ" class="headerlink" title="å¼ºè¡Œè½¬æ¢å¹¶ä½¿ç”¨msgDataæŒ‡é’ˆ"></a>å¼ºè¡Œè½¬æ¢å¹¶ä½¿ç”¨msgDataæŒ‡é’ˆ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">notifiedFIFO_elt_t *Msg = newNotifiedFIFO_elt(sizeof(syncData_t), 0, &amp;nf, UE_synch);</span><br><span class="line">syncData_t *syncMsg = (syncData_t *) NotifiedFifoData(Msg));</span><br><span class="line">syncMsg-&gt;UE = UE;</span><br><span class="line">memset(&amp;syncMsg-&gt;proc, 0, sizeof(syncMsg-&gt;proc));</span><br><span class="line">pushTpool(&amp;(get_nrUE_params()-&gt;Tpool), Msg);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>pushTpool</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">static inline void pushTpool(tpool_t *t, notifiedFIFO_elt_t *msg) &#123;</span><br><span class="line">  <span class="keyword">if</span> (t-&gt;measurePerf) msg-&gt;creationTime=rdtsc_oai();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( t-&gt;activated)</span><br><span class="line">    pushNotifiedFIFO(&amp;t-&gt;incomingFifo, msg);</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (t-&gt;measurePerf)</span><br><span class="line">      msg-&gt;startProcessingTime=rdtsc_oai();</span><br><span class="line"></span><br><span class="line">    msg-&gt;processingFunc(NotifiedFifoData(msg));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (t-&gt;measurePerf)</span><br><span class="line">      msg-&gt;endProcessingTime=rdtsc_oai();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (msg-&gt;reponseFifo)</span><br><span class="line">      pushNotifiedFIFO(msg-&gt;reponseFifo, msg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ğŸ“˜-C-æŒ‡é’ˆå’Œå­—ç¬¦ä¸²å­—é¢é‡ç¤ºä¾‹"><a href="#ğŸ“˜-C-æŒ‡é’ˆå’Œå­—ç¬¦ä¸²å­—é¢é‡ç¤ºä¾‹" class="headerlink" title="ğŸ“˜ C æŒ‡é’ˆå’Œå­—ç¬¦ä¸²å­—é¢é‡ç¤ºä¾‹"></a>ğŸ“˜ C æŒ‡é’ˆå’Œå­—ç¬¦ä¸²å­—é¢é‡ç¤ºä¾‹</h2><h3 id="ğŸ“Œ-1-åŸºç¡€ç¤ºä¾‹ï¼šæŒ‡é’ˆåˆå§‹åŒ–"><a href="#ğŸ“Œ-1-åŸºç¡€ç¤ºä¾‹ï¼šæŒ‡é’ˆåˆå§‹åŒ–" class="headerlink" title="ğŸ“Œ 1. åŸºç¡€ç¤ºä¾‹ï¼šæŒ‡é’ˆåˆå§‹åŒ–"></a>ğŸ“Œ 1. åŸºç¡€ç¤ºä¾‹ï¼šæŒ‡é’ˆåˆå§‹åŒ–</h3><p>âœ… æ­£ç¡®ç”¨æ³•ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> *a = &amp;x;  <span class="comment">// a æŒ‡å‘ x çš„åœ°å€</span></span><br><span class="line">    *a = <span class="number">2</span>;       <span class="comment">// ä¿®æ”¹ x çš„å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x = %d\n&quot;</span>, x);  <span class="comment">// è¾“å‡ºï¼š2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ğŸš« é”™è¯¯ç”¨æ³•ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> *a = <span class="number">1</span>;   <span class="comment">// é”™è¯¯ï¼a æŒ‡å‘åœ°å€ 0x1ï¼Œå‡ ä¹è‚¯å®šæ— æ•ˆ</span></span><br><span class="line">    *a = <span class="number">2</span>;       <span class="comment">// æœªå®šä¹‰è¡Œä¸ºï¼Œå¯èƒ½æ®µé”™è¯¯</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="ğŸ“Œ-2-å­—ç¬¦ä¸²å­—é¢é‡æ˜¯åªè¯»çš„"><a href="#ğŸ“Œ-2-å­—ç¬¦ä¸²å­—é¢é‡æ˜¯åªè¯»çš„" class="headerlink" title="ğŸ“Œ 2. å­—ç¬¦ä¸²å­—é¢é‡æ˜¯åªè¯»çš„"></a>ğŸ“Œ 2. å­—ç¬¦ä¸²å­—é¢é‡æ˜¯åªè¯»çš„</h3><p>âœ… æ­£ç¡®ç¤ºä¾‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> *a = <span class="string">&quot;a&quot;</span>;  <span class="comment">// a æŒ‡å‘å­—ç¬¦ä¸²å­—é¢é‡ &quot;a&quot;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, a);  <span class="comment">// è¾“å‡ºï¼ša</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸš« ä¸è¦å°è¯•ä¿®æ”¹åªè¯»å­—ç¬¦ä¸²ï¼š</span></span><br><span class="line">    <span class="comment">// a[0] = &#x27;b&#x27;; // å¯èƒ½æ®µé”™è¯¯</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="ğŸ“Œ-3-å¯ä¿®æ”¹å­—ç¬¦ä¸²ï¼šä½¿ç”¨æ•°ç»„"><a href="#ğŸ“Œ-3-å¯ä¿®æ”¹å­—ç¬¦ä¸²ï¼šä½¿ç”¨æ•°ç»„" class="headerlink" title="ğŸ“Œ 3. å¯ä¿®æ”¹å­—ç¬¦ä¸²ï¼šä½¿ç”¨æ•°ç»„"></a>ğŸ“Œ 3. å¯ä¿®æ”¹å­—ç¬¦ä¸²ï¼šä½¿ç”¨æ•°ç»„</h3><p>âœ… æ­£ç¡®ç¤ºä¾‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> a[] = <span class="string">&quot;a&quot;</span>; <span class="comment">// åˆ›å»ºä¸€ä¸ªå¯ä¿®æ”¹çš„æ•°ç»„</span></span><br><span class="line">    a[<span class="number">0</span>] = <span class="string">&#x27;b&#x27;</span>;     <span class="comment">// ä¿®æ”¹æˆåŠŸ</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, a);  <span class="comment">// è¾“å‡ºï¼šb</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="ğŸ“Œ-4-å†…å­˜ç¤ºæ„"><a href="#ğŸ“Œ-4-å†…å­˜ç¤ºæ„" class="headerlink" title="ğŸ“Œ 4. å†…å­˜ç¤ºæ„"></a>ğŸ“Œ 4. å†…å­˜ç¤ºæ„</h3><table>
<thead>
<tr>
<th>è¡¨è¾¾å¼</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>a</code></td>
<td>æŒ‡é’ˆå˜é‡ï¼Œä¿å­˜ä¸€ä¸ªåœ°å€</td>
</tr>
<tr>
<td><code>*a</code></td>
<td>è®¿é—®æŒ‡é’ˆæŒ‡å‘åœ°å€ä¸­çš„å€¼</td>
</tr>
<tr>
<td><code>&amp;x</code></td>
<td>å–å˜é‡ x çš„åœ°å€</td>
</tr>
<tr>
<td><code>&quot;abc&quot;</code></td>
<td>å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆåªè¯»ï¼‰</td>
</tr>
</tbody></table>
<hr>
<h3 id="ğŸ“Œ-5-char-a-vs-char-a"><a href="#ğŸ“Œ-5-char-a-vs-char-a" class="headerlink" title="ğŸ“Œ 5. char *a vs char a[]"></a>ğŸ“Œ 5. <code>char *a</code> vs <code>char a[]</code></h3><table>
<thead>
<tr>
<th>å£°æ˜</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>char *a = &quot;abc&quot;;</code></td>
<td>a æ˜¯æŒ‡é’ˆï¼ŒæŒ‡å‘åªè¯»å­—ç¬¦ä¸²å­—é¢é‡</td>
</tr>
<tr>
<td><code>char a[] = &quot;abc&quot;;</code></td>
<td>a æ˜¯æ•°ç»„ï¼Œå†…å®¹æ‹·è´åˆ°æ ˆä¸Šï¼Œå¯ä¿®æ”¹</td>
</tr>
</tbody></table>
<hr>
<h3 id="âœ…-æ€»ç»“"><a href="#âœ…-æ€»ç»“" class="headerlink" title="âœ… æ€»ç»“"></a>âœ… æ€»ç»“</h3><ol>
<li><strong>æŒ‡é’ˆå˜é‡ä¿å­˜çš„æ˜¯åœ°å€ï¼Œè§£å¼•ç”¨ï¼ˆ<code>*a</code>ï¼‰è®¿é—®è¯¥åœ°å€ä¸­çš„å€¼ã€‚</strong></li>
<li><strong>å­—ç¬¦ä¸²å­—é¢é‡é€šå¸¸æ˜¯åªè¯»å†…å­˜ï¼Œæƒ³è¦å¯ä¿®æ”¹å­—ç¬¦ä¸²å°±è¦ç”¨æ•°ç»„æ‹·è´å‡ºæ¥ã€‚</strong></li>
<li><strong>å¯¹æ— æ•ˆåœ°å€è§£å¼•ç”¨ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼ˆæ®µé”™è¯¯ã€ç¨‹åºå´©æºƒï¼‰ã€‚</strong></li>
</ol>
<hr>
<h3 id="âœ¨-å®Œæ•´ç¤ºä¾‹ï¼šå¯å¤åˆ¶è¿è¡Œ"><a href="#âœ¨-å®Œæ•´ç¤ºä¾‹ï¼šå¯å¤åˆ¶è¿è¡Œ" class="headerlink" title="âœ¨ å®Œæ•´ç¤ºä¾‹ï¼šå¯å¤åˆ¶è¿è¡Œ"></a>âœ¨ å®Œæ•´ç¤ºä¾‹ï¼šå¯å¤åˆ¶è¿è¡Œ</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// æŒ‡é’ˆæ“ä½œ</span></span><br><span class="line">    <span class="type">int</span> x = <span class="number">10</span>;</span><br><span class="line">    <span class="type">int</span> *p = &amp;x;</span><br><span class="line">    *p = <span class="number">20</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x = %d\n&quot;</span>, x);  <span class="comment">// è¾“å‡ºï¼š20</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆåªè¯»ï¼‰</span></span><br><span class="line">    <span class="type">char</span> *s1 = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, s1);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä¿®æ”¹å­—ç¬¦ä¸²ï¼ˆæ•°ç»„ï¼‰</span></span><br><span class="line">    <span class="type">char</span> s2[] = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    s2[<span class="number">0</span>] = <span class="string">&#x27;H&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, s2);  <span class="comment">// è¾“å‡ºï¼šHello</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="defineå’Œconstçš„åŒºåˆ«"><a href="#defineå’Œconstçš„åŒºåˆ«" class="headerlink" title="defineå’Œconstçš„åŒºåˆ«"></a>defineå’Œconstçš„åŒºåˆ«</h2><p><strong>ç¼–è¯‘é˜¶æ®µ</strong>ï¼š defineæ˜¯ç¼–è¯‘é¢„å¤„ç†é˜¶æ®µè¿›è¡Œç®€å•çš„æ–‡æœ¬æ›¿æ¢ï¼Œconstæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µç¡®å®šå…¶å€¼<br><strong>å®‰å…¨æ€§</strong>ï¼š defineå®šä¹‰çš„å®å¸¸é‡æ²¡æœ‰æ•°æ®ç±»å‹ï¼Œåªæ˜¯è¿›è¡Œç®€å•çš„æ›¿æ¢ï¼Œä¸ä¼šè¿›è¡Œç±»å‹å®‰å…¨æ£€æŸ¥ï¼›constå®šä¹‰çš„å¸¸é‡æ˜¯æœ‰ç±»å‹çš„ï¼Œæ˜¯è¦è¿›è¡Œç±»å‹åˆ¤æ–­çš„<br><strong>å†…å­˜å ç”¨</strong>ï¼š defineå®šä¹‰çš„å®å¸¸é‡ï¼Œåœ¨ç¨‹åºä¸­ä½¿ç”¨å¤šå°‘æ¬¡å°±ä¼šè¿›è¡Œå¤šå°‘æ¬¡æ›¿æ¢ï¼Œå†…å­˜ä¸­æœ‰å¤šä¸ªå¤‡ä»½ï¼Œå ç”¨çš„æ˜¯ä»£ç æ®µçš„å†…å­˜ï¼›constå®šä¹‰å¸¸é‡å ç”¨é™æ€å­˜å‚¨åŒºåŸŸçš„ç©ºé—´ï¼Œç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åªæœ‰ä¸€ä»½<br><strong>è°ƒè¯•</strong>ï¼š defineå®šä¹‰çš„å®å¸¸é‡ä¸èƒ½è°ƒè¯•ï¼Œå› ä¸ºåœ¨é¢„ç¼–è¯‘é˜¶æ®µå°±å·²ç»è¿›è¡Œæ›¿æ¢äº†ï¼›constå®šä¹‰çš„å¸¸é‡æ˜¯å¯ä»¥è¿›è¡Œè°ƒè¯•çš„ã€‚</p>
<h2 id="ç¨‹åºè¿åŠ¨çš„æ­¥éª¤æ˜¯ä»€ä¹ˆ"><a href="#ç¨‹åºè¿åŠ¨çš„æ­¥éª¤æ˜¯ä»€ä¹ˆ" class="headerlink" title="ç¨‹åºè¿åŠ¨çš„æ­¥éª¤æ˜¯ä»€ä¹ˆ"></a>ç¨‹åºè¿åŠ¨çš„æ­¥éª¤æ˜¯ä»€ä¹ˆ</h2><ul>
<li>é¢„ç¼–è¯‘ã€‚<br>å°†å¤´æ–‡ä»¶ç¼–è¯‘ï¼Œè¿›è¡Œå®æ›¿æ¢ï¼Œè¾“å‡º.iæ–‡ä»¶</li>
<li>ç¼–è¯‘ã€‚<br>å°†å…¶è½¬æ¢ä¸ºæ±‡ç¼–è¯­è¨€æ–‡ä»¶ï¼Œä¸»è¦åšè¯­æ³•åˆ†æï¼Œè¯­ä¹‰åˆ†æä»¥åŠæ£€æŸ¥é”™è¯¯ï¼Œæ£€æŸ¥æ— è¯¯åå°†ä»£ç æ›¿æ¢æˆæ±‡ç¼–è¯­è¨€ï¼Œç”Ÿæˆ.sæ–‡ä»¶</li>
<li>æ±‡ç¼–ã€‚<br>æ±‡ç¼–å™¨å°†æ±‡ç¼–è¯­è¨€æ–‡ä»¶ç¿»è¯‘æˆæœºå™¨è¯­è¨€ï¼Œç”Ÿæˆ.oæ–‡ä»¶</li>
<li>é“¾æ¥ã€‚<br>å°†ç›®æ ‡æ–‡ä»¶å’Œåº“é“¾æ¥åˆ°ä¸€èµ·ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶.exe</li>
</ul>
<h2 id="è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ–¹å¼"><a href="#è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ–¹å¼" class="headerlink" title="è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ–¹å¼"></a>è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ–¹å¼</h2><ul>
<li>ç®¡é“</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>å…±äº«å†…å­˜</li>
<li>ä¿¡å·é‡</li>
<li>ä¿¡å·</li>
<li>å¥—æ¥å­—</li>
</ul>
<h2 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h2><h3 id="å»ºç«‹è¿æ¥"><a href="#å»ºç«‹è¿æ¥" class="headerlink" title="å»ºç«‹è¿æ¥"></a>å»ºç«‹è¿æ¥</h3><ul>
<li>ç¬¬ä¸€æ¬¡æ¡æ‰‹</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ·ç«¯ --&gt; æœåŠ¡ç«¯ ï¼š SYN = 1ï¼Œ seq = x</span><br></pre></td></tr></table></figure>
<ul>
<li>ç¬¬äºŒæ¬¡æ¡æ‰‹</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœåŠ¡ç«¯ --&gt; å®¢æˆ·ç«¯ ï¼š SYN=1, ACK=1, seq=y, ack=x+1</span><br></pre></td></tr></table></figure>
<ul>
<li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ·ç«¯ --&gt; æœåŠ¡ç«¯ ï¼š ACK=1, seq=x+1, ack=y+1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æ–­å¼€è¿æ¥"><a href="#æ–­å¼€è¿æ¥" class="headerlink" title="æ–­å¼€è¿æ¥"></a>æ–­å¼€è¿æ¥</h3><ul>
<li>ç¬¬ä¸€æ¬¡æ¡æ‰‹<br>å®¢æˆ·ç«¯å‘é€<strong>FIN</strong>åŒ…,è¡¨ç¤ºè‡ªå·±æ²¡æœ‰æ•°æ®è¦å‘äº†ï¼Œä½†è¿˜èƒ½æ¥å—æ•°æ®</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ·ç«¯ --&gt; æœåŠ¡ç«¯ ï¼š FIN=1, seq=u</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>ç¬¬äºŒæ¡æ‰‹<br>æœåŠ¡ç«¯æ”¶åˆ° FIN åï¼Œå‘é€ ACK ç¡®è®¤åŒ…ï¼Œè¡¨ç¤ºâ€œæˆ‘çŸ¥é“ä½ è¦æ–­äº†â€ã€‚</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æœåŠ¡ç«¯ --&gt; å®¢æˆ·ç«¯ ï¼š ACK=1, ack=u+1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹<br>æœåŠ¡ç«¯å‘å®Œå‰©ä½™æ•°æ®åï¼Œå‘é€è‡ªå·±çš„ FIN åŒ…ï¼Œè¡¨ç¤ºä¹Ÿæ²¡æ•°æ®äº†ã€‚</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœåŠ¡ç«¯ --&gt; å®¢æˆ·ç«¯ ï¼š FIN=1, seq=v</span><br></pre></td></tr></table></figure>

<ul>
<li>ç¬¬å››æ¬¡æ¡æ‰‹ï¼ˆå®¢æˆ·ç«¯ç¡®è®¤ï¼‰<br>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„ FIN åï¼Œå‘é€ ACK ç¡®è®¤ï¼Œè¡¨ç¤ºâ€œå¥½ï¼Œæˆ‘çŸ¥é“ä½ ä¹Ÿæ–­äº†â€ã€‚</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ·ç«¯ --&gt; æœåŠ¡ç«¯ ï¼š ACK=1, ack=v+1</span><br></pre></td></tr></table></figure>


<h2 id="åŠ¨æ€è¿æ¥å’Œé™æ€è¿æ¥"><a href="#åŠ¨æ€è¿æ¥å’Œé™æ€è¿æ¥" class="headerlink" title="åŠ¨æ€è¿æ¥å’Œé™æ€è¿æ¥"></a>åŠ¨æ€è¿æ¥å’Œé™æ€è¿æ¥</h2><p>åŒºåˆ«ï¼šä»–ä»¬çš„æœ€å¤§åŒºåˆ«å°±æ˜¯åœ¨äºé“¾æ¥çš„æ—¶æœºä¸åŒï¼Œé™æ€é“¾æ¥æ˜¯åœ¨å½¢æˆå¯æ‰§è¡Œç¨‹åºå‰ï¼Œè€ŒåŠ¨æ€é“¾æ¥çš„è¿›è¡Œåˆ™æ˜¯ç¨‹åºæ‰§è¡Œæ—¶ã€‚</p>
<p>é™æ€åº“ï¼šå°±æ˜¯å°†åº“ä¸­çš„ä»£ç åŒ…å«åˆ°è‡ªå·±çš„ç¨‹åºä¹‹ä¸­ï¼Œæ¯ä¸ªç¨‹åºé“¾æ¥é™æ€åº“åï¼Œéƒ½ä¼šåŒ…å«ä¸€ä»½ç‹¬ç«‹çš„ä»£ç ï¼Œå½“ç¨‹åºè¿è¡Œèµ·æ¥æ—¶ï¼Œæ‰€æœ‰è¿™äº›é‡å¤çš„ä»£ç éƒ½éœ€è¦å ç”¨ç‹¬ç«‹çš„å­˜å‚¨ç©ºé—´ï¼Œæ˜¾ç„¶å¾ˆæµªè´¹è®¡ç®—æœºèµ„æºã€‚</p>
<p>åŠ¨æ€åº“ï¼šä¸ä¼šå°†ä»£ç ç›´æ¥å¤åˆ¶åˆ°è‡ªå·±ç¨‹åºä¸­ï¼Œåªä¼šç•™ä¸‹è°ƒç”¨æ¥å£ï¼Œç¨‹åºè¿è¡Œæ—¶å†å»å°†åŠ¨æ€åº“åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ‰€æœ‰ç¨‹åºåªä¼šå…±äº«è¿™ä¸€ä»½åŠ¨æ€åº“ï¼Œå› æ­¤åŠ¨æ€åº“ä¹Ÿè¢«ç§°ä¸ºå…±äº«åº“ã€‚</p>
<p>åŠ¨æ€é“¾æ¥åŸç†ï¼šæ˜¯æŠŠç¨‹åºæŒ‰ç…§æ¨¡å—æ‹†åˆ†æˆå„ä¸ªç›¸å¯¹ç‹¬ç«‹éƒ¨åˆ†ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶æ‰å°†å®ƒä»¬é“¾æ¥åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå®Œæ•´çš„ç¨‹åºï¼Œè€Œä¸æ˜¯åƒé™</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hechenyi.github.io/2025/04/21/OFDM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/21/OFDM/" class="post-title-link" itemprop="url">OFDM</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-21 14:50:57" itemprop="dateCreated datePublished" datetime="2025-04-21T14:50:57+08:00">2025-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-20 13:58:56" itemprop="dateModified" datetime="2025-08-20T13:58:56+08:00">2025-08-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/5G/" itemprop="url" rel="index"><span itemprop="name">5G</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
          <h2 id="Basic-Concept"><a href="#Basic-Concept" class="headerlink" title="Basic Concept"></a>Basic Concept</h2><hr>
<blockquote>
<p><strong>Notice</strong><br><br>ä¸€ä¸ªOFDMç¬¦å·åœ¨æ—¶åŸŸä¸Šçš„é•¿åº¦ç­‰äºFFTLength + CyclicPrefixLength<br><br>ä¸€ä¸ªOFDMç¬¦å·åœ¨é¢‘åŸŸä¸Šçš„é•¿åº¦ç­‰äºæœ‰æ•ˆå­è½½æ³¢é•¿åº¦,ä¹Ÿå°±æ˜¯FFTLength - NullCarrierIndices(ç©ºè½½æ³¢(ç›´æµã€ä¿æŠ¤å¸¦))</p>
</blockquote>
<hr>
<p>åœ¨OFDMä¸­ï¼Œä¸€ä¸ªOFDMç¬¦å·å°±æ˜¯å¤šä¸ªå­è½½æ³¢çš„ç»“åˆï¼Œæ¯ä¸ªå­è½½æ³¢æ‰¿è½½ä¸€ä¸ªè°ƒåˆ¶ç¬¦å·ï¼ˆå¦‚QPSKã€ 16QAMã€ 64QAMç­‰ï¼‰<br>æ‰€ä»¥ä¸€ä¸ªOFDMç¬¦å·åœ¨é¢‘åŸŸä¸­ä¼šæœ‰å¤šä¸ªè°ƒåˆ¶ç¬¦å·ï¼ŒIFFTå°±æ˜¯æŠŠè¿™äº›è°ƒåˆ¶ç¬¦å·è½¬æ¢æˆæ—¶åŸŸçš„è¿ç»­ç¬¦å·ï¼Œå˜æˆä¸€ä¸ªOFDMç¬¦å·ã€‚<br>æ•´ä½“çš„è¿‡ç¨‹æ˜¯modData -&gt; æ’å…¥pilot -&gt; æ’å…¥nullï¼ˆæ¸…é›¶æ— æ•ˆå­è½½æ³¢ï¼‰-&gt; å­è½½æ³¢åˆ†é…ä¸æ˜ å°„ -&gt; IFFT -&gt; åŠ CP -&gt; ofdmDataOut</p>
<p>å…¶ä¸­å­è½½æ³¢åˆ†é…æ˜¯æŒ‡OFDMå°†æ•´ä¸ªé¢‘è°±åˆ†æˆè‹¥å¹²ä¸ªæ­£äº¤çš„å­è½½æ³¢ï¼Œæ¯ä¸ªè°ƒåˆ¶ç¬¦å·ä¼šè¢«æ˜ å°„åˆ°ä¸€ä¸ªå­è½½æ³¢ä¸Šã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s(t_m) = \sum_&#123;n=0&#125;^&#123;N-1&#125;[I_ncosw_nt_m - Q_n sinw_nt_m] = Re \sum_&#123;n=0&#125;^&#123;N-1&#125;[(I_n + jQ_n)e^&#123;jw_nt_m&#125;]</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­$\sum_{n&#x3D;0}^{N-1}[(I_n + jQ_n)e^{jw_nt_m}]$æ˜¯IDFTçš„å½¢å¼ï¼Œå†ç»“åˆIFFTå› æ­¤å¯å°†ä¸Šå¼å­è½¬å˜ä¸ºï¼š  </p>
<p>$Re[IFFT(I_n + jQ_n)]$  </p>
<p>å› æ­¤å¯å°†$Z_n &#x3D; I_n + jQ_n$ç†è§£ä¸ºOFDMä¿¡å·åœ¨DFTçš„é¢‘è°±ä¸Šçš„ç¦»æ•£ç‚¹ã€‚ä»ä¸Šè¿°è¡¨è¾¾å¼å®ç°äº†æ¯ä¸ªç¬¦å·ä¹˜ä»¥ä¸€ä¸ªå¤æŒ‡æ•°ä¿¡å·ï¼ˆé¢‘ç‡ä¸ºè¯¥å­è½½æ³¢çš„é¢‘ç‡ï¼‰è¿›è¡Œæ˜ å°„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªç¬¦å·éƒ½ä¼šä¸ä¸€ä¸ªæ­£å¼¦æˆ–ä½™å¼¦æ³¢ç›¸ä¹˜ï¼Œå¹¶æ ¹æ®å­è½½æ³¢çš„é¢‘ç‡è¿›è¡Œåç§»ã€‚</p>
<p>IFFT: å¯¹è°ƒåˆ¶åçš„ç¬¦å·è¿›è¡Œ é€†ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆIFFTï¼‰ï¼Œå°†é¢‘åŸŸä¿¡å·è½¬æ¢ä¸ºæ—¶åŸŸä¿¡å·ã€‚IFFT æ˜¯å°†å„ä¸ªå­è½½æ³¢çš„ä¿¡å·åˆæˆåœ¨ä¸€èµ·çš„æ­¥éª¤ï¼Œåœ¨è¿™ä¸ªæ­¥éª¤ä¹‹åï¼Œä¿¡å·ç”±é¢‘åŸŸè½¬ä¸ºæ—¶åŸŸã€‚<br>åœ¨matlabä»¿çœŸä¸­ï¼Œdataä¸ºåŸå§‹å¤æ•°å¯¹ï¼ŒX_freqä¸ºé¢‘åŸŸä¿¡å·ï¼Œzeros(FFT_size,1),è£…æœ‰dataï¼Œè¿™æ ·å°±å®ç°äº†å°†åŸå§‹æ•°æ®åŠ è½½åˆ°å­è½½æ³¢ä¸Šï¼Œç„¶å$X_{time} &#x3D; ifft(ifftshift(X_{freq}), N)$</p>
<h2 id="OFDM-å­è½½æ³¢æ—¶åŸŸä¸é¢‘åŸŸç‰¹æ€§è¯´æ˜"><a href="#OFDM-å­è½½æ³¢æ—¶åŸŸä¸é¢‘åŸŸç‰¹æ€§è¯´æ˜" class="headerlink" title="OFDM å­è½½æ³¢æ—¶åŸŸä¸é¢‘åŸŸç‰¹æ€§è¯´æ˜"></a>OFDM å­è½½æ³¢æ—¶åŸŸä¸é¢‘åŸŸç‰¹æ€§è¯´æ˜</h2><h3 id="OFDM-å­è½½æ³¢çš„é¢‘åŸŸè¡¨ç¤º"><a href="#OFDM-å­è½½æ³¢çš„é¢‘åŸŸè¡¨ç¤º" class="headerlink" title="OFDM å­è½½æ³¢çš„é¢‘åŸŸè¡¨ç¤º"></a>OFDM å­è½½æ³¢çš„é¢‘åŸŸè¡¨ç¤º</h3><p>åœ¨ OFDM ç³»ç»Ÿä¸­ï¼Œä¿¡å·åœ¨é¢‘åŸŸç”±å¤šä¸ªå­è½½æ³¢ç»„æˆï¼Œæ¯ä¸ªå­è½½æ³¢å¯¹åº”ä¸€ä¸ªç‰¹å®šçš„é¢‘ç‡åˆ†é‡ã€‚å‡è®¾æœ‰ (N) ä¸ªå­è½½æ³¢ï¼Œæ€»é¢‘åŸŸä¿¡å·ä¸ºï¼š</p>
<p>$$<br>X[k], \quad k &#x3D; 0, 1, \ldots, N-1<br>$$</p>
<p>å…¶ä¸­ï¼Œ$X[k]$ æ˜¯ç¬¬ $k$ ä¸ªå­è½½æ³¢çš„å¤æ•°è°ƒåˆ¶ç¬¦å·ï¼ˆä¾‹å¦‚ QAM ç¬¦å·ï¼‰ã€‚</p>
<hr>
<h3 id="å•ä¸ªå­è½½æ³¢çš„æ—¶åŸŸä¿¡å·"><a href="#å•ä¸ªå­è½½æ³¢çš„æ—¶åŸŸä¿¡å·" class="headerlink" title="å•ä¸ªå­è½½æ³¢çš„æ—¶åŸŸä¿¡å·"></a>å•ä¸ªå­è½½æ³¢çš„æ—¶åŸŸä¿¡å·</h3><p>å¦‚æœé¢‘åŸŸä¿¡å·åªæœ‰ç¬¬ $k_0$ ä¸ªå­è½½æ³¢ä¸ºéé›¶ï¼ˆä¾‹å¦‚ä¸º1ï¼‰ï¼Œå…¶ä½™å‡ä¸ºé›¶ï¼š</p>
<p>$$<br>X[k] &#x3D; \begin{cases}<br>1, &amp; k &#x3D; k_0 \<br>0, &amp; k \neq k_0<br>\end{cases}<br>$$</p>
<p>åˆ™æ—¶åŸŸä¿¡å·é€šè¿‡é€†ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆIFFTï¼‰å¾—åˆ°ï¼š</p>
<p>$$<br>x[n] &#x3D; \frac{1}{N} \sum_{k&#x3D;0}^{N-1} X[k] e^{j 2\pi \frac{k n}{N}} &#x3D; \frac{1}{N} e^{j 2\pi \frac{k_0}{N} n}, \quad n&#x3D;0, 1, \ldots, N-1<br>$$</p>
<p>è¿™è¡¨ç¤ºæ—¶åŸŸæ˜¯ä¸€ä¸ªé¢‘ç‡ä¸º $\frac{k_0}{N}$ çš„å¤æŒ‡æ•°åºåˆ—ï¼ˆæ­£å¼¦æ³¢ï¼‰ï¼Œä¸”é•¿åº¦ä¸º $N$ã€‚</p>
<hr>
<h3 id="ä¸ºä»€ä¹ˆå­è½½æ³¢æ—¶åŸŸæ˜¯å¸¦é¢‘ç§»çš„-sinc-å‡½æ•°ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå­è½½æ³¢æ—¶åŸŸæ˜¯å¸¦é¢‘ç§»çš„-sinc-å‡½æ•°ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå­è½½æ³¢æ—¶åŸŸæ˜¯å¸¦é¢‘ç§»çš„ sinc å‡½æ•°ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå­è½½æ³¢æ—¶åŸŸæ˜¯å¸¦é¢‘ç§»çš„ sinc å‡½æ•°ï¼Ÿ</h3><ul>
<li><strong>ç†æƒ³æƒ…å†µ</strong>ï¼šæ— é™é•¿çš„å•é¢‘æ­£å¼¦æ³¢å¯¹åº”é¢‘åŸŸå•ç‚¹ï¼ˆDirac Î´å‡½æ•°ï¼‰ã€‚</li>
<li><strong>å®é™…æƒ…å†µ</strong>ï¼šæ—¶åŸŸä¿¡å·æœ‰é™é•¿ï¼ˆé•¿åº¦ä¸º$N$ï¼‰ï¼Œç­‰ä»·äºå°†æ— é™é•¿æ­£å¼¦æ³¢ä¹˜ä»¥ä¸€ä¸ªçŸ©å½¢çª—ï¼š</li>
</ul>
<p>$$<br>x_{\text{windowed}}[n] &#x3D; \frac{1}{N} e^{j 2\pi \frac{k_0}{N} n} \cdot w[n]<br>$$</p>
<p>å…¶ä¸­ï¼š</p>
<p>$$<br>w[n] &#x3D; \begin{cases}<br>1, &amp; 0 \leq n &lt; N \<br>0, &amp; \text{otherwise}<br>\end{cases}<br>$$</p>
<ul>
<li><p><strong>çŸ©å½¢çª—çš„é¢‘åŸŸå¯¹åº”ä¸€ä¸ª sinc å‡½æ•°</strong>ï¼Œå› æ­¤é¢‘åŸŸä¸å†æ˜¯å•ä¸€ç‚¹ï¼Œè€Œæ˜¯ä¸€ä¸ªå¸¦ä¸»ç“£å’Œæ—ç“£çš„ sinc å‡½æ•°å½¢çŠ¶ã€‚</p>
</li>
<li><p>åè¿‡æ¥ï¼Œé¢‘åŸŸä¸­æŸä¸ªé¢‘ç‡ç‚¹å®é™…ä»£è¡¨ä¸€ä¸ª<strong>å¸¦é¢‘ç§»çš„ sinc å‡½æ•°</strong>åœ¨æ—¶åŸŸçš„è¡¨ç°ã€‚</p>
</li>
</ul>
<hr>
<h3 id="å¯¹-frac-1-N-e-j-2-pi-frac-k-0-N-n-è¿›è¡Œæ±‚DTFT"><a href="#å¯¹-frac-1-N-e-j-2-pi-frac-k-0-N-n-è¿›è¡Œæ±‚DTFT" class="headerlink" title="å¯¹$\frac{1}{N} e^{j 2\pi \frac{k_0}{N} n}$è¿›è¡Œæ±‚DTFT"></a>å¯¹$\frac{1}{N} e^{j 2\pi \frac{k_0}{N} n}$è¿›è¡Œæ±‚DTFT</h3><p>å¯¹è¯¥ä¿¡å·è¿›è¡Œç¦»æ•£æ—¶é—´å‚…é‡Œå¶å˜æ¢ï¼ˆDTFTï¼‰ï¼š</p>
<p>$$<br>X(e^{j\Omega}) &#x3D; \sum_{n&#x3D;-\infty}^{\infty} x[n] \cdot e^{-j\Omega n}<br>$$</p>
<p>ä»£å…¥ (x[n])ï¼š</p>
<p>$$<br>X(e^{j\Omega}) &#x3D; \frac{1}{N} \sum_{n&#x3D;-\infty}^{\infty} e^{-j n \left( \Omega - \frac{2\pi k_0}{N} \right)}<br>$$</p>
<p>è§’é¢‘ç‡ $\Omega$ å’Œå®é™…é¢‘ç‡ $f$ ä¹‹é—´çš„å…³ç³»ä¸ºï¼š</p>
<p>$$<br>\Omega &#x3D; 2\pi \frac{f}{f_s} \quad \Rightarrow \quad f &#x3D; \frac{\Omega}{2\pi} f_s<br>$$</p>
<p>æ‰€ä»¥ä¸»å†²å‡»çš„ä½ç½®é¢‘ç‡ä¸ºï¼š<br>$$<br>\Delta f &#x3D; \Delta \Omega \cdot \frac{f_s}{2\pi}<br>$$</p>
<p>æ‰€ä»¥é¢‘ç§»ä¸º<br>$$<br>f_{k_0} &#x3D; \frac{2\pi \cdot \frac{k_0}{N} f_s}{2\pi} &#x3D; \frac{k_0}{N} f_s<br>$$</p>
<p>è¿™æ­£æ˜¯æˆ‘ä»¬è®¾å®šçš„ç¬¬ $k_0$ä¸ªå­è½½æ³¢çš„é¢‘ç§»ï¼<br>å› æ­¤ç›¸é‚»å­è½½æ³¢é—´è·ç­‰äº $\frac{1}{N}  f_s$</p>
<hr>
<h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><table>
<thead>
<tr>
<th>é¢‘åŸŸç‰¹å¾</th>
<th>æ—¶åŸŸå¯¹åº”ä¿¡å·</th>
</tr>
</thead>
<tbody><tr>
<td>å•ä¸ªé¢‘ç‡ç‚¹ï¼ˆç†æƒ³ Dirac Î´ï¼‰</td>
<td>æ— é™é•¿æ­£å¼¦æ³¢ï¼ˆå¤æŒ‡æ•°ï¼‰</td>
</tr>
<tr>
<td>æœ‰é™é•¿åº¦æ—¶åŸŸï¼ˆä¹˜çŸ©å½¢çª—ï¼‰</td>
<td>å¸¦é¢‘ç§»çš„ sinc å‡½æ•°ï¼ˆçŸ©å½¢çª—ä¹˜æ­£å¼¦æ³¢ï¼‰</td>
</tr>
</tbody></table>
<p>å› æ­¤ï¼ŒOFDM ä¸­æ¯ä¸ªå­è½½æ³¢åœ¨æ—¶åŸŸè¡¨ç°ä¸ºä¸€ä¸ªå¸¦é¢‘ç§»çš„ sinc å‡½æ•°ï¼Œè€Œæ•´ä¸ª OFDM ä¿¡å·æ˜¯å¤šä¸ªå¸¦é¢‘ç§» sinc å‡½æ•°çš„å åŠ ã€‚</p>
<hr>
<h3 id="OFDM-æ—¶åŸŸä¿¡å·ä¸é¢‘åè¡¥å¿è¯´æ˜"><a href="#OFDM-æ—¶åŸŸä¿¡å·ä¸é¢‘åè¡¥å¿è¯´æ˜" class="headerlink" title="OFDM æ—¶åŸŸä¿¡å·ä¸é¢‘åè¡¥å¿è¯´æ˜"></a>OFDM æ—¶åŸŸä¿¡å·ä¸é¢‘åè¡¥å¿è¯´æ˜</h3><p>å…ˆéœ€è¦ç†è§£Carrier Frequency Offsetï¼ˆCFOï¼‰çš„æ¦‚å¿µï¼ŒCFOä¼šä¸¥é‡ç ´åå­è½½æ³¢æ­£äº¤æ€§ï¼Œå¿…é¡»åœ¨æ¥æ”¶ç«¯ä¼°è®¡å¹¶è¡¥å¿å®ƒ</p>
<ul>
<li><p>ä½¿ç”¨å‰å¯¼ç¬¦å·ï¼ˆpreambleï¼‰&#x2F;åŒæ­¥ç¬¦å·ä¼°è®¡</p>
</li>
<li><p>ä½¿ç”¨CPï¼ˆå¾ªç¯å‰ç¼€ï¼‰é‡å¤ç‰¹å¾</p>
</li>
<li><p>æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆMLEï¼‰</p>
</li>
<li><p>åŸºäºåŒæ­¥ä¿¡å·å—ï¼ˆPSS&#x2F;SSSï¼‰<br>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨PSS&#x2F;SSSæ¥è®¡ç®—é¢‘åè¡¥å¿<br>æ ¹æ®ä¸Šé¢åˆ†æå¯çŸ¥OFDMç³»ç»Ÿä¸­ï¼Œå‘é€çš„æ—¶åŸŸä¿¡å·$r(t)$æ˜¯ç”±æ‰€æœ‰å­è½½æ³¢çš„å¤æŒ‡æ•°è°ƒæ•´ä¿¡å·å åŠ è€Œæˆï¼š<br>$$<br>r(t) &#x3D; \sum_{k&#x3D;0}^{N-1} X_k \cdot e^{j 2\pi k \Delta f t}<br>$$</p>
</li>
<li><p><code>N</code>: å­è½½æ³¢æ•°é‡  </p>
</li>
<li><p><code>Xâ‚–</code>: ç¬¬ <code>k</code> ä¸ªå­è½½æ³¢çš„è°ƒåˆ¶ç¬¦å·ï¼ˆå¦‚ QAMï¼‰  </p>
</li>
<li><p><code>Î”f</code>: å­è½½æ³¢é—´éš”  </p>
</li>
<li><p><code>t</code>: æ—¶é—´  </p>
</li>
<li><p><code>r(t)</code>: å‘é€çš„æ—¶åŸŸå¤æ•°ä¿¡å·ï¼ˆOFDM ç¬¦å·ï¼‰</p>
</li>
</ul>
<p>ç¦»æ•£å½¢å¼(IFFTè¿ç®—(IDFT)):<br>$$<br>r[n] &#x3D; \sum_{k&#x3D;0}^{N-1} X_k \cdot e^{j2\pi k n &#x2F; N}<br>$$</p>
<p>é¢‘å$\Delta f$æ˜¯æŒ‡å‘é€ç«¯å’Œæ¥æ”¶ç«¯æœ¬åœ°è½½æ³¢æŒ¯è¡å™¨ä¹‹é—´å­˜åœ¨çš„é¢‘ç‡å·®å¼‚  </p>
<p>æ ¹æ®ä»¥ä¸‹å…¬å¼æ¥è¿›è¡Œè°ƒæ•´<br>$$<br>\hat{r}[n] &#x3D; r[n] \cdot e^{j 2 \pi f_{\text{off}} n T_s}<br>$$</p>
<h3 id="MATLAB-ä»£ç ç¤ºä¾‹"><a href="#MATLAB-ä»£ç ç¤ºä¾‹" class="headerlink" title="MATLAB ä»£ç ç¤ºä¾‹"></a>MATLAB ä»£ç ç¤ºä¾‹</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">1024</span>;              <span class="comment">% å­è½½æ³¢æ€»æ•°ï¼ˆIFFTå¤§å°ï¼‰</span></span><br><span class="line">k0 = <span class="number">300</span>;              <span class="comment">% é€‰æ‹©ä¸€ä¸ªå­è½½æ³¢ç´¢å¼•</span></span><br><span class="line">X = <span class="built_in">zeros</span>(N,<span class="number">1</span>);</span><br><span class="line">X(k0) = <span class="number">1</span>;             <span class="comment">% é¢‘åŸŸå•ç‚¹æ¿€æ´»</span></span><br><span class="line">x = ifft(ifftshift(X), N); <span class="comment">% å¾—åˆ°æ—¶åŸŸä¿¡å·</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span>:N<span class="number">-1</span>;</span><br><span class="line"><span class="built_in">plot</span>(n, <span class="built_in">real</span>(x));</span><br><span class="line">title(<span class="string">&#x27;å•ä¸ªå­è½½æ³¢æ—¶åŸŸæ³¢å½¢ï¼ˆå¸¦é¢‘ç§»çš„ sinc å‡½æ•°å½¢æ€ï¼‰&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;é‡‡æ ·ç‚¹ n&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;å¹…åº¦&#x27;</span>);</span><br><span class="line">grid on;</span><br></pre></td></tr></table></figure>




<h3 id="payloadå¤„ç†"><a href="#payloadå¤„ç†" class="headerlink" title="payloadå¤„ç†"></a>payloadå¤„ç†</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">dataBits = txParamConfig.txDataBits;</span><br><span class="line">% Append CRC bits to data bits</span><br><span class="line">crcData = crcGenerate(dataBits, txObj.crcDataGen);</span><br><span class="line">% Additively scramble using scramble polynomial</span><br><span class="line">scrOut = xor(crcData, txObj.pnSeq(sysParam.initState));</span><br><span class="line">% Perform convolutional coding</span><br><span class="line">dataEnc = convenc([scrOut;zeros(dataConvK-1,1)], ...</span><br><span class="line">    poly2trellis(dataConvK,dataConvCode),puncVec); % Terminated mode</span><br><span class="line">dataEnc = [dataEnc; zeros(sysParam.trBlkPadSize,1)]; % append pad to factorize payload length</span><br><span class="line">dataEnc = reshape(dataEnc,[],numDataOFDMSymbols); % form columns of symbols</span><br><span class="line">% Perform interleaving and symbol</span><br><span class="line">modData = zeros(numel(dataEnc)/(numDataOFDMSymbols*bitsPerModSym),numDataOFDMSymbols);</span><br><span class="line"><span class="keyword">for</span> i = 1:numDataOFDMSymbols</span><br><span class="line">    % Interleave each symbol</span><br><span class="line">    intrlvOut = OFDMInterleave(dataEnc(:,i),sysParam.dataIntrlvNcolumns);</span><br><span class="line">    % Modulate the symbol</span><br><span class="line">    modData(:,i) = qammod(intrlvOut, txParamConfig.modOrder, UnitAveragePower=<span class="literal">true</span>, InputType=<span class="string">&quot;bit&quot;</span>);</span><br><span class="line">end</span><br><span class="line">modDataInt = 1</span><br><span class="line">% Remove the pilot indices from modData indices</span><br><span class="line">modDataInd(pilotInd) = [];</span><br><span class="line">% Load data and pilots on the grid</span><br><span class="line">grid(pilotInd, (headerIdx+1:numSymPerFrame)) = pilot;</span><br><span class="line">grid(modDataInd, (headerIdx+1:numSymPerFrame)) = modData;</span><br></pre></td></tr></table></figure>
<p>åˆ†æä»£ç ï¼Œå¯çŸ¥modDataçš„ç»´åº¦çš„å®½æ˜¯numel(dataEnc)&#x2F;(numDataOFDMSymbols<em>bitsPerModSym)ï¼Œ<br>å…¶ä¸­numel(dataEnc)æ‰€æœ‰çš„bits numberï¼Œ numDataOFDMSymbols</em>bitsPerModSymè¡¨ç¤ºæ¯ä¸€ä¸ªFrameçš„OFDMç¬¦å·æ•°<strong>ä¹˜ä¸Š</strong>æ¯ä¸ªè°ƒåˆ¶åçš„ç¬¦å·çš„bitsæ•°ï¼ˆä¾‹å¦‚4QAMæœ‰ä¸¤ä¸ªbitsï¼‰ï¼Œè¿™æ ·æ—¢å¯ä»¥è®¡ç®—å‡ºæ¯ä¸ªOFDMç¬¦å·å¯¹åº”çš„å­è½½æ³¢æ•°ï¼Œä¹Ÿå°±æ˜¯è°ƒåˆ¶ç¬¦å·æ•°ï¼Œè¿™æ˜¯å¯¹äºpayloadè€Œè¨€<br>æ¥ä¸‹æ¥æ˜¯OFDMè°ƒåˆ¶</p>
<h3 id="OFDM-Modulation"><a href="#OFDM-Modulation" class="headerlink" title="OFDM Modulation"></a>OFDM Modulation</h3><p>æˆ‘ä»¬ä»¥payloadä¸ºä¾‹ï¼Œä¹Ÿå°±æ˜¯å¯¹moddataè¿›è¡Œè°ƒåˆ¶<br>ofdmDataOut &#x3D; ofdmmod(modData, fftLen, cpLen, nullInd, sysParam.pilotIdx,pilot)<br>è¾“å…¥äº†æ¯ä¸ªOFDMç¬¦å·çš„IFFTç‚¹æ•°ï¼Œæ¯ä¸ªOFDMç¬¦å·å‰é¢åŠ çš„å¾ªç¯å‰ç¼€é•¿åº¦ï¼Œè¦æ¸…é›¶çš„å­è½½æ³¢ä½ç½®ï¼Œå¯¼é¢‘å­è½½æ³¢ä½ç½®å’Œå¯¼é¢‘ç¬¦å·ã€‚<br>åœ¨modDataé‡Œæ ¹æ®pilotIdxï¼ŒæŠŠpilotç¬¦å·æ’åˆ°æŒ‡å®šä½ç½®ï¼ŒIFFTè¿ç®—åˆ™æ˜¯æŠŠé¢‘åŸŸä¸Šçš„å¤æ•°ç¬¦å˜æˆæ—¶åŸŸä¿¡å·ã€‚<br>è¾“å‡ºçš„ç»´åº¦æ˜¯(fftLen+cpLen) x numDataOFDMSymbols, 1<br>ä¹Ÿå°±æ˜¯ä¸€ä¸ªåˆ—å‘é‡ï¼Œè¡¨ç¤ºå¤šä¸ªOFDMç¬¦å·åœ¨æ—¶åŸŸä¸Šä¸²è”åœ¨ä¸€èµ·çš„ç»“æ„ï¼Œå› ä¸ºæ¯ä¸ªOFDMç¬¦å·å˜æˆfftLen+cpLenä¸ªæ—¶åŸŸé‡‡æ ·ç‚¹</p>
<h3 id="é‡‡æ ·é¢‘ç‡"><a href="#é‡‡æ ·é¢‘ç‡" class="headerlink" title="é‡‡æ ·é¢‘ç‡"></a>é‡‡æ ·é¢‘ç‡</h3><p>é‡‡æ ·ç‡ &#x3D; å­è½½æ³¢æ•°é‡ x å­è½½æ³¢é—´éš”<br>è¿™æ˜¯5G NRçš„ç‰¹æ€§<br>æ•°å­¦è¯æ˜:<br>$f_{sampling} &#x3D; \frac{n_{subcarrier} * n_{OFDMSymbolsPerSlot}}{T_{slot}} &#x3D; \frac{n_{subcarrier}}{T_{TimePerSymbol}} &#x3D; n_{subcarrier} * \Delta f$  </p>
<hr>
<blockquote>
<p><strong>Notice</strong><br><br>éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œçš„å­è½½æ³¢æ•°é‡åŒ…å«ä½¿ç”¨å’Œæœªä½¿ç”¨çš„å­è½½æ³¢ï¼Œä¹Ÿå°±æ˜¯ç­‰äºFFT size (é’ˆå¯¹ä¸€ä¸ªOFDMç¬¦å·è€Œè¨€ï¼Œä¹Ÿå°±æ˜¯å¯¹x[n]çš„ä¸€ä¸ªOFDMç¬¦å·é‡‡æ ·åçš„ç¦»æ•£ä¿¡å·è¿›è¡Œifftå˜æ¢)ï¼Œæ‰€ä»¥ä¸å®Œå…¨ç­‰äºå¸¦å®½ï¼ˆå¸¦å®½åªç”±ä½¿ç”¨çš„å­è½½æ³¢æ•°é‡å†³å®šï¼Œ CPåªå æ®æ—¶é—´èµ„æºè€Œä¸å æ®é¢‘åŸŸèµ„æºï¼‰, FFT size ï¼ˆNï¼‰æœ¬è´¨ä¸Šæ˜¯å¯¹é•¿åº¦ä¸ºNçš„æ—¶åŸŸä¿¡å·è¿›è¡Œå˜æ¢ï¼Œé»˜è®¤æŠŠè¿™æ®µä¿¡å·çœ‹æˆæ˜¯å‘¨æœŸæ€§é‡å¤çš„ã€‚ä¸€ä¸ªOFDMç¬¦å·çš„é‡‡æ ·ç‚¹æ•°ç›®é€šå¸¸ç­‰äºFFT sizeã€‚å¦‚æœé‡‡æ ·ç‚¹æ•°ç›®è¦å¤§äºFFT sizeï¼Œé‚£ä¹ˆå¯ä»¥é€å—åšFFTï¼Œå¦‚æœé‡‡æ ·ç‚¹æ•°ç›®è¦å°ï¼Œé‚£ä¹ˆåšFFTæ—¶ä¸€èˆ¬ä¼šè¡¥é›¶ï¼ˆzero-paddingï¼‰ã€‚</p>
</blockquote>
<hr>
<h2 id="MATLAB-example"><a href="#MATLAB-example" class="headerlink" title="MATLAB example"></a>MATLAB example</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openExample(<span class="string">&#x27;comm/OFDMEndToEndExample&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="basic-description"><a href="#basic-description" class="headerlink" title="basic description"></a>basic description</h2><img src="/images/dataflow.png">  

<p>This example shows how to run a complete end-to-end OFDM transimission for a single-input single-output (SISO) channel. The physical-layer transmission protocol mimics typical <strong>synchonization signals</strong>, <strong>reference symbols</strong>, <strong>control channels</strong>, and <strong>data channels</strong> popular across standardized transmission schemes such as LTE, 5G NR, and WLAN.</p>
<h2 id="Channel-Parameters"><a href="#Channel-Parameters" class="headerlink" title="Channel Parameters"></a>Channel Parameters</h2><ul>
<li>SNR<br>20dB</li>
<li>foff</li>
<li>doppler</li>
<li>pathDelay</li>
<li>pathGain</li>
</ul>
<h2 id="System-Parameters"><a href="#System-Parameters" class="headerlink" title="System Parameters"></a>System Parameters</h2><ul>
<li>FFTLen<br>1024</li>
<li>numFrames<br>100</li>
<li>numSymbolsPerFrame<br>15</li>
<li>CPLen<br>256</li>
<li>txDatabits<br>[â€¦]</li>
<li>usedSubCarr<br>600</li>
<li>modulationOrder<br>64&#x3D;64-QAM</li>
<li>codeRate<br>0&#x3D;1&#x2F;2</li>
<li>BW<br>10MHz</li>
<li>fc(carrier frequency)<br>1.9GHz</li>
<li>enableFading<br>True</li>
</ul>
<h2 id="å…·ä½“è¿‡ç¨‹"><a href="#å…·ä½“è¿‡ç¨‹" class="headerlink" title="å…·ä½“è¿‡ç¨‹"></a>å…·ä½“è¿‡ç¨‹</h2><h3 id="Populate-Parameter-Structure"><a href="#Populate-Parameter-Structure" class="headerlink" title="Populate Parameter Structure"></a>Populate Parameter Structure</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">///helperOFDMSetParameters <span class="keyword">function</span></span><br><span class="line">[sysParam, txParam] = helperOFDMSetParameters(userParam);</span><br><span class="line">///é€šè¿‡æŸ¥è¡¨æ¥è¿›ä¸€æ­¥è·å–FFTLen, CPLen, numSubCarr, BWç­‰æ•°æ®</span><br><span class="line">[~,codeParam] = helperOFDMGetTables(userParam.BWIndex,userParam.codeRateIndex);</span><br></pre></td></tr></table></figure>
<h3 id="Initialize-states-and-process-data-frames"><a href="#Initialize-states-and-process-data-frames" class="headerlink" title="Initialize states and process data frames"></a>Initialize states and process data frames</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/// Initialize transmitter and receiver</span><br><span class="line">txObj = helperOFDMTxInit(sysParam);</span><br><span class="line">rxObj = helperOFDMRxInit(sysParam);</span><br><span class="line">/// å¾ªç¯å‘é€ï¼Œå¤§å¾ªç¯æ˜¯ä¿¡å™ªæ¯”ï¼Œç”¨æ¥æ¨¡æ‹Ÿä¸åŒç¯å¢ƒï¼Œå°å¾ªç¯æ˜¯framesçš„æ•°é‡ï¼Œç”¨æ¥ä¸€ä¸ªframeä¸€ä¸ªframeçš„å‘é€</span><br><span class="line"><span class="keyword">for</span> simLoopIdx = 1:length(SNRdB)</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">for</span> frameNum = 1 : sysParam.numFrames+1</span><br><span class="line">        sysParam.frameNum = frameNum;</span><br><span class="line">        /// Generate Payload data</span><br><span class="line">        txParam.txDatabits = randi([0 1], sysParam.trBlkSize, 1);</span><br><span class="line">        /// Store data bits <span class="keyword">for</span> BER calculation</span><br><span class="line">        sysParam.txDatabits = [sysParam.txDatabits; txParam.txDataBits];</span><br><span class="line">        /// Transmit data</span><br><span class="line">        [txOut, txGrid, txDiagnostics] = helperOFDMTx(txParam, sysParam, txObj);</span><br><span class="line">        /// ç»è¿‡æ¨¡æ‹Ÿçš„channelè¿›è¡Œä¼ é€</span><br><span class="line">        chanOut = helperOFDMChannel(txOut, chanParam, sysParam);</span><br><span class="line">        /// Run the receiver front-end</span><br><span class="line">        rxIn = helperOFDMRxFrontEnd(chanOut, sysParam, rxObj);</span><br><span class="line">        /// Run the receiver processing</span><br><span class="line">        [rxDataBits, isConnected, toff, rxDiagnostics] = helperOFDMRx(rxIn, sysParam, rxObj);</span><br><span class="line">        /// Collect bit and frame error statistics</span><br><span class="line">        <span class="keyword">if</span> is Connected</span><br><span class="line">            BER = errorRate(...</span><br><span class="line">                sysParam.txDataBits(end-(2*sysParam.trBlkSize)+(1:sysParam.trBlkSize)), ...</span><br><span class="line">                rxDataBits);</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/blog/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/3/">3</a><span class="page-number current">4</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">40</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
